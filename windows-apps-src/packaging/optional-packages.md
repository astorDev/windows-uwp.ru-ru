---
ms.assetid: 3a59ff5e-f491-491c-81b1-6aff15886aad
title: Разработка дополнительных пакетов и связанных наборов
description: Дополнительные пакеты включают содержимое, которое можно интегрировать с главным пакетом. Они полезны для загружаемого контента (DLC), так как позволяют поделить большое приложение при наличии ограничений на размер или доставить любое дополнительное содержимое отдельно от исходного приложения.
ms.date: 09/30/2018
ms.topic: article
keywords: windows 10, uwp, дополнительные пакеты, связанные наборы, расширение пакета, visual studio
ms.localizationpriority: medium
ms.openlocfilehash: f62d6c99acc75033403fac7a498308cea6f7d3f8
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57594029"
---
# <a name="optional-packages-and-related-set-authoring"></a>Разработка дополнительных пакетов и связанных наборов
Дополнительные пакеты включают содержимое, которое можно интегрировать с главным пакетом. Они полезны для загружаемого контента (DLC), так как позволяют поделить большое приложение при наличии ограничений на размер или доставить любое дополнительное содержимое отдельно от исходного приложения.

Связанные наборы представляют собой расширение дополнительных пакетов. Они позволяют принудительно применять строгий набор версий для главного и дополнительных пакетов. Кроме того, они позволяют загружать из дополнительных пакетов машинный код (C++). 

## <a name="prerequisites"></a>Предварительные условия

- Visual Studio 2017 версии 15.1;
- Windows 10 версии 1703
- Windows 10 версии 1703 SDK.

Чтобы скачать все самые последние средства для разработки, см. раздел [Загружаемые файлы и инструменты для Windows 10](https://developer.microsoft.com/windows/downloads).

> [!NOTE]
> Чтобы отправить приложение, которое использует дополнительные пакеты и/или связанные наборы для Microsoft Store, вам потребуется разрешение. Можно использовать дополнительные пакеты и связанные наборы для строки Business (LOB) или корпоративных приложений без разрешения центра партнеров, если они отправляются в Store. Для получения разрешения на отправку приложений, использующих дополнительные пакеты и связанные наборы, см. раздел [Поддержка разработчиков для Windows](https://developer.microsoft.com/windows/support).

### <a name="code-sample"></a>Пример кода
Во время чтения этой статьи рекомендуется следить за [примером кода для дополнительного пакета](https://github.com/AppInstaller/OptionalPackageSample) на GitHub, чтобы получить практическое понимание работы дополнительных пакетов и связанных наборов в Visual Studio.

## <a name="optional-packages"></a>Дополнительные пакеты
Чтобы создать дополнительный пакет в Visual Studio, необходимо выполнить следующее:
1. Убедитесь, что ваше приложение **Минимальная версия целевой платформы** имеет значение: 10.0.15063.0 или более поздней версии.
2. Из проекта вашего **главного пакета** откройте файл `Package.appxmanifest`. Перейдите на вкладку "Упаковка" и обратите внимание на **имя семейства пакета**, в которое входят все символы до символа "_".
3. Из проекта вашего **дополнительного пакета** щелкните правой кнопкой мыши файл `Package.appxmanifest` и выберите пункты **Открыть с помощью > Редактор (текстовый) XML**.
4. Найдите в этом файле элемент `<Dependencies>`. Добавьте следующую строку:

```XML
<uap3:MainPackageDependency Name="[MainPackageDependency]"/>
```

Замените `[MainPackageDependency]` на ваше **имя семейства пакета** из шага 2. Эта строка будет указывать, что ваш **дополнительный пакет** зависит от **главного пакета**.

После установки зависимостей для вашего пакета (шаги с 1 по 4) можно продолжить разработку как обычно. Если вы хотите загрузить код в главный пакет из дополнительного пакета, необходимо создать связанный набор. Более подробные сведения см. в разделе [Связанные наборы](#related_sets).

Visual Studio можно настроить для повторного развертывания главного пакета при каждом развертывании дополнительного пакета. Чтобы задать зависимости сборки в Visual Studio, выполните следующее:

- Щелкните правой кнопкой мыши проект дополнительного пакета и выберите пункты **Зависимости сборки > Зависимости проекта...**
- Выберите проект главного пакета и нажмите кнопку "ОК". 

Теперь каждый раз при нажатии клавиши F5 или сборке проекта дополнительного пакета программа Visual Studio будет создавать сначала проект главного пакета. Это гарантирует синхронизацию главного и дополнительного проектов.

## Связанные наборы<a name="related_sets"></a>

Если вы хотите загрузить код в главный пакет из дополнительного, необходимо создать связанный набор. Для сборки связанного набора главный и дополнительный пакеты должны быть тесно связаны. Метаданные для связанных наборов указывается в файле appxbundle или .msixbundle главного пакета. Visual Studio помогает вам получить правильные метаданные в ваших файлах. Чтобы настроить решение для связанных наборов для вашего приложения, выполните следующие действия:

1. Щелкните правой кнопкой мыши проект главного пакета и выберите пункты **Добавить > Новый элемент...**
2. Из этого окна выполните поиск установленных шаблонов для ".txt" и добавьте новый текстовый файл.
> [!IMPORTANT]
> Новый текстовый файл должен называться `Bundle.Mapping.txt`.

3. В файле `Bundle.Mapping.txt` укажите относительные пути к любым проектам дополнительных пакетов или внешним пакетам. Образец файла `Bundle.Mapping.txt` должен выглядеть примерно так:

```syntax
[OptionalProjects]
"..\ActivatableOptionalPackage1\ActivatableOptionalPackage1.vcxproj"
"..\ActivatableOptionalPackage2\ActivatableOptionalPackage2.vcxproj"

[ExternalPackages]
"..\ActivatableOptionalPackage1\x86\Release\ActivatableOptionalPackage3_1.1.1.0\ ActivatableOptionalPackage3_1.1.1.0.appx"
```

После такой настройки вашего решения программа Visual Studio создаст манифест набора для главного пакета со всеми необходимыми метаданными для связанных наборов. 

Обратите внимание, что дополнительные пакеты, такие как `Bundle.Mapping.txt` файл для связанных наборов будет работать только на Windows 10 версии 1703 или более поздней версии. Кроме того приложения целевой платформы минимальной версии задается 10.0.15063.0 или выше.

## Известные проблемы<a name="known_issues"></a>

В настоящее время в Visual Studio не поддерживается отладка дополнительного проекта связанного набора. Чтобы обойти эту проблему, можно развернуть и запустить активацию (Ctrl+F5) и вручную подключить отладчик к процессу. Чтобы подключить отладчик, перейдите в Visual Studio в меню "Отладка", выберите пункт "Присоединиться к процессу..." и подключите отладчик к **процессу основного приложения**.