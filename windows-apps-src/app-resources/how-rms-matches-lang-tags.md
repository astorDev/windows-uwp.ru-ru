---
author: stevewhims
Description: The previous topic (How the Resource Management System matches and chooses resources) looks at qualifier-matching in general. This topic focuses on language-tag-matching in more detail.
title: Как система управления ресурсами сопоставляет языковые теги
template: detail.hbs
ms.author: stwhi
ms.date: 11/02/2017
ms.topic: article
keywords: Windows 10, uwp, ресурс, изображение, средство, MRT, квалификатор
ms.localizationpriority: medium
ms.openlocfilehash: f64072f2f04b5cd45b3b75ccad908ef6906c00f5
ms.sourcegitcommit: ed0304b8a214c03b8aab74b8ef12c9f82b8e3c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2018
ms.locfileid: "7299593"
---
# <a name="how-the-resource-management-system-matches-language-tags"></a>Как Система управления ресурсами сопоставляет языковые теги

В предыдущем разделе ([О сопоставлении и выборе ресурсов Системой управления ресурсами](how-rms-matches-and-chooses-resources.md)) приводится общий обзор сопоставления квалификаторов. В этом разделе основное внимание уделяется сопоставлению языковых тегов.

## <a name="introduction"></a>Введение

Ресурсы с квалификаторами в виде языковых тегов сравниваются и оцениваются на основе списка языков среды выполнения приложений. Определение других списков языков см. в разделе [Обзор языков профиля пользователя и языков манифеста приложения](../design/globalizing/manage-language-and-region.md). Сопоставление с первым языком в списке выполняется до сопоставления со вторым языком даже для других региональных вариантов. Например, ресурс для en-GB выбирается прежде, чем ресурс для fr-CA, если язык среды выполнения приложения— en-US. Только если ресурсы для формы не существует, en является ресурсом для fr-CA (обратите внимание, что в этом случае язык приложения по умолчанию не может быть установлен как любая форма en).

Механизм оценки использует данные, содержащиеся в реестре подтегов [BCP-47](http://go.microsoft.com/fwlink/p/?linkid=227302), а также дополнительные источники данных. Он принимает во внимание градиент оценок с различными значениями качества соответствия и из нескольких допустимых вариантов выбирает вариант с наилучшей оценкой соответствия.

Соответственно, это позволяет разработчикам задавать общие теги для языкового содержимого, но при этом указывать специальное содержимое, если это необходимо. Например, приложение может содержать множество строк на английском языке, которые употребляются как в Соединенных Штатах, так и в Великобритании. Если отметить эти строки просто как en (английский), это сэкономит место и снизит расходы на локализацию. Если необходимо различать строки, например если они содержат такие слова, как color и colour, версии для Соединенных Штатов и Великобритании можно отметить с использованием языковых и региональных тегов, соответственно, как en-US и en-GB.

## <a name="language-tags"></a>Языковые теги

Языки распознаются с помощью нормализованных языковых тегов BCP-47 с правильным форматом. Компоненты подтегов определяются в реестре подтегов BCP-47. Обычная структура языкового тега BCP-47 состоит из одного или нескольких следующих элементов подтегов.

- Языковый подтег (требуется).
- Подтег набора символов (который может указываться по умолчанию в реестре подтегов).
- Подтег региона (необязательно).
- Подтег варианта языка (необязательно).

Можно использовать дополнительные элементы подтегов, но это не даст ощутимого эффекта для определения языкового соответствия. Языковые диапазоны не определяются с помощью подстановочных знаков (*), например en-*.

## <a name="matching-two-languages"></a>Сопоставление двух языков

Как правило, в Windows сравнение двух языков выполняется в контексте какого-либо большого процесса. Оно может происходить в контексте оценки нескольких языков, например при создании в Windows списка языков приложения (см. раздел [Обзор языков профиля пользователя и языков манифеста приложения](../design/globalizing/manage-language-and-region.md)). Windows делает это, сравнивая несколько языков из предпочтений пользователя с языками, указанными в манифесте приложения. Сравнение также может выполняться в контексте оценки языка наряду с другими условиями для определенного ресурса. В качестве примера может служить ситуация, когда Windows сопоставляет определенный файловый ресурс с определенным контекстом ресурса и в качестве факторов, влияющих на выбор ресурса, помимо языка используются, например расположение домашнего каталога пользователя или текущий масштаб или разрешение устройства.

Когда производится сопоставление двух языковых тегов, ему назначается оценка в зависимости от точности соответствия.

| Соответствие | Оценка | Пример |
| ----- | ----- | ------- |
| Точное соответствие | Высокое | en-AU : en-AU |
| Соответствие варианту языка (язык, набор символов, регион, вариант) |  | en-AU-variant1 : en-AU-variant1-t-ja |
| Соответствие региона (язык, набор символов, регион) |  | en-AU : en-AU-variant1 |
| Частичное соответствие (язык, набор символов) |  |  |
| - Соответствие макрорегиону |  | en-AU : en-053 |
| - Соответствие безотносительно региона |  | en-AU : en |
| - Соответствие орфографического сходства (ограниченная поддержка) |  | en-AU : en-GB |
| - Соответствие предпочитаемого региона |  | en-AU : en-US |
| - Соответствие любому региону |  | en-AU : en-CA |
| Неопределенный язык (соответствует любому языку) |  | en-AU : und |
| Соответствие отсутствует (несоответствие набора символов или языкового тега основного языка) | Низкое | en-AU : fr-FR |

### <a name="exact-match"></a>Точно соответствует

Теги абсолютно одинаковы (все подтеги совпадают). Сравнение для этого типа соответствия может быть инициализировано из соответствия региона или варианта языка. Например, en-US соответствует en.

### <a name="variant-match"></a>Соответствие варианта языка

Теги соответствуют по подтегам языка, набору символов, региону и варианту языка, но отличаются по остальным аспектам.

### <a name="region-match"></a>Соответствие региона

Теги соответствуют по подтегам языка, набору символов и региону, но отличаются по остальным аспектам. Например, de-DE-1996 соответствует de-DE, а en-US-x-Pirate соответствует en-US.

### <a name="partial-matches"></a>Частичные соответствия

Теги соответствуют по подтегам языка и набора символов, но отличаются по региону или другому подтегу. Например, en-US соответствует en или en-US соответствует en-\*.

#### <a name="macro-region-match"></a>Соответствие макрорегиону

Теги совпадают по подтегам языка и набору символов. Два тега имеют подтеги региона, один из которых обозначает макрорегион, включающий в себя другой регион. Подтеги макрорегионов всегда являются числами и соответствуют стандарту M.49 для кодов стран и территорий Статистического отдела ООН. Подробную схему взаимоотношений можно посмотреть на [схеме географических (континентальных) макрорегионов, географических субрегионов, отдельных экономик и других группировок](http://go.microsoft.com/fwlink/p/?LinkId=247929).

**Примечание**. Номера ООН для экономических или других группировок не поддерживаются в BCP-47.
 
**Примечание**. Тег с подтегом макрорегиона 001 считается эквивалентным тегу, нейтральному относительно региона. Например, es-001 и es считаются синонимами.

#### <a name="region-neutral-match"></a>Соответствие безотносительно региона

Теги совпадают по подтегам языка и набору символов, и только один тег имеет тег региона. Родительское соответствие предпочтительнее по сравнению с другими частичными соответствиями.

#### <a name="orthographic-affinity-match"></a>Соответствие орфографического сходства

Теги совпадают по подтегам языка и набору символов, подтеги региона имеют орфографическое сходство. Сходство основывается на данных операционной системы, определяющих регионы, сходные по языку, например en-IE и en-GB.

#### <a name="preferred-region-match"></a>Соответствие предпочитаемого региона

Теги совпадают по подтегам языка и набору символов, и один из подтегов региона является подтегом региона по умолчанию для этого языка. Например, fr-FR— это регион по умолчанию для подтега fr. Итак, fr-FR лучше, чем fr-CA, подходит к fr-BE. Это основано на данных Windows, определяющих регион по умолчанию для каждого языка локализации Windows.

#### <a name="sibling-match"></a>Соответствие элементам одного уровня

Теги совпадают по подтегам языка и набору символов, и оба содержат подтеги региона, но между ними обнаруживается другое отношение. При соответствии множеству элементов одного и того же уровня последний перечисляемый элемент попадет под соответствие при отсутствии более точного соответствия.

### <a name="undetermined-language"></a>Неопределенный язык

Ресурс может быть отмечен как und, чтобы показать его соответствие любому языку. Этот тег также используется с тегом набора символов, чтобы выделить соответствия на основе сценария. Например, und-Latn будет соответствовать любому языковому тегу, который использует набор символов Latin. Ниже приведены дополнительные сведения.

### <a name="script-mismatch"></a>Несоответствие набора символов

Если в тегах совпадает только тег основного языка, но не набор символов, эта пара не будет иметь соответствие и оценивается ниже уровня допустимого соответствия.

### <a name="no-match"></a>Соответствие отсутствует

Несоответствие подтегов основного языка оценивается ниже уровня допустимого соответствия. Например, zh-Hant не соответствует zh-Hans.

## <a name="examples"></a>Примеры

Язык пользователя zh-Hans-CN (китайский (упрощенное письмо) [Китай]) соответствует следующим ресурсам в показанном порядке приоритета. Х показывает несоответствие.

![Совпадение для китайского, упрощенное письмо (Китай)](images/language_matching_1.png)

1. Точно соответствует; 2. и 3. Соответствие региона; 4. Родительское соответствие; 5. Совпадение элементов одного уровня.

Если языковой подтег содержит значение Suppress-Script, определенное в реестре подтегов BCP-47, то возникнет соответствие, принимающее значение кода скрытого сценария. Например, en-Latn-US соответствует en-US. В следующем примере языком пользователя является en-AU (английский [Австралия]):

![Совпадение для английского (Австралия)](images/language_matching_2.png)

1. Точно соответствует; 2. Соответствие макрорегиону. 3. Соответствие безотносительно региона; 4. Орфографическое сходство. 5. Соответствие предпочитаемому региону. 6. Совпадение элементов одного уровня.

## <a name="matching-a-language-to-a-language-list"></a>Добавление языка в список языков

Иногда соответствие устанавливается в рамках более широкого процесса сопоставления одного языка нескольким. Например, может определяться соответствие ресурса, основанного на одном языке, списку языков приложения.  Оценка такого соответствия определяется положением первого совпадающего языка в списке. Чем ниже язык в списке, тем ниже будет оценка.

Если список языков содержит два и более региональных вариантов языка с одинаковыми подтегами языка и набора символов, то сравнения с первым тегом языка оцениваются только на следующие соответствия: точное, варианта языка и региона. Оценка частичных соответствий откладывается до следующего регионального варианта языка. Это позволяет пользователям более точно управлять процессом соответствия для их списка языков. При этом допускается предпочтение точного совпадения дополнительного элемента в списке по сравнению с частичным совпадением первого элемента в списке, если существует третий элемент, соответствующий тегу языка и набору символов первого элемента. Вот пример.

- Список языков (по порядку): pt-PT (португальский (Португалия)), en-US (английский (США)), pt-BR (португальский (Бразилия)).
- Ресурсы: en-US, pt-BR.
- Ресурсы с более высокой оценкой: en-US.
- Описание: сравнение начинается с pt-PT, но точного соответствия не обнаруживается. Благодаря наличию pt-BR в списке языков пользователя частичное соответствие откладывается до сравнения с pt-BR. Следующее языковое сравнение: en-US, при котором обнаруживается точное соответствие. Поэтому окончательно выбранным ресурсом является en-US.

ИЛИ

- Список языков (по порядку): es-MX (испанский (Мексика)), es-HO (испанский (Гондурас)).
- Ресурсы: en-ES, es-HO.
- Ресурсы с высокой оценкой: es-HO.

## <a name="undetermined-language-und"></a>Неопределенный язык (und)

Языковый тег und может использоваться для определения ресурса, который будет соответствовать любому языку при отсутствии более точного совпадения. Этот тег можно рассматривать подобно языковому диапазону BCP-47 "*" или "*-&lt;-script&gt;". Вот пример.

- Список языков: en-US, zh-Hans-CN.
- Ресурсы: zh-Hans-CN, und.
- Ресурс с более высокой оценкой: und.
- Описание: сравнение начинается с en-US, но соответствие en (частичное или лучшее) не найдено. Так как имеется ресурс, отмеченный как und, алгоритм определения соответствия использует именно его.

Тег und позволяет для множества языков указать один ресурс и разрешает отдельные языки обрабатывать как исключения. Пример:

- Список языков: zh-Hans-CN, en-US.
- Ресурсы: zh-Hans-CN, und.
- Ресурсы с более высокой оценкой: zh-Hans-CN.
- Описание: при сравнении обнаруживается точное соответствие для первого элемента, поэтому ресурс, отмеченный как und, уже не проверяется.

Тег und используется с тегом набора символов, чтобы отфильтровать ресурсы по наборам символов. Пример:

- Список языков: ru.
- Ресурсы: und-Latn, und-Cyrl, und-Arab.
- Ресурсы с более высокой оценкой: und-Cyrl.
- Описание: при сравнении не обнаруживается точное соответствие для ru (частичное или лучше), поэтому выбирается языковый тег und. Значение подавленного набора символов Cyrl, связанное с языковым тегом ru, соответствует ресурсу und-Cyrl.

## <a name="orthographic-regional-affinity"></a>Орфографическое региональное сходство

Если два языковых тега с различными подтегами региона соответствуют друг другу, определенные пары регионов могут иметь большее сходство между собой, чем с остальными. Родственные группы поддерживаются только для английского языка (en). Подтеги региона PH (Филиппины) и LR (Либерия) имеют орфографическое сходство с подтегом региона US. Все остальные подтеги региона сходны с подтегом региона GB (Соединенное Королевство). Поэтому, если доступны ресурсы en-US и en-GB, список языков en-HK (английский (Гонконг, САР)) получит более высокую оценку с ресурсами en-GB, чем с en-US.

## <a name="handling-languages-with-many-regional-variants"></a>Обработка языков, имеющих несколько региональных вариантов

Для некоторых языков в различных регионах существуют различные разновидности этих языков, на которых говорит большое количество людей,&mdash; например, это такие языки как английский, французский, испанский, поддержка которых чаще всего встречается в многоязычных приложениях. Региональные варианты языков могут иметь орфографические различия (например, color и colour— американское и британское написание слова "цвет"), диалектные или словарные различия (например, truck и lorry— американский и британский вариант слова "грузовик").

Эти языки с различающимися региональными вариантами создают определенные сложности при разработке приложения для международного рынка: сколько различных региональных вариантов следует поддерживать, какие именно, какой способ будет наиболее эффективным для управления ресурсами с этими региональными вариантами ресурсы в приложении. Ответы на все эти вопросы выходят за рамки этого раздела. Однако механизмы сопоставления языков в Windows предоставляют возможности обработки различных региональных вариантов языков.

Приложения часто поддерживают только одну разновидность какого-либо языка. Предположим, приложение имеет ресурсы только для одной разновидности английского языка и предназначено для англоязычных пользователей из любых регионов. Такой ситуации будет соответствовать использование тега en без подтега региона. Но исторически могло сложиться так, что приложение использует тег с подтегом региона, например en-US. Этот вариант тоже будет работать— приложение использует только одну разновидность английского языка, но Windows должным образом выполняет сопоставление ресурса для одного регионального варианта с предпочитаемым языком пользователя для другого регионального варианта.

Однако если предполагается использовать два и более региональных варианта, то разница между ними (например, между en и en-US) может существенно повлиять на взаимодействие с пользователем, поэтому важно решить, какие подтеги регионов следует использовать.

Предположим, вы хотите использовать разные варианты французской локализации для Канады и для европейских франкоязычных стран. Для канадского французского можно использовать тег fr-CA. Для европейских франкоязычных стран локализация использует вариант "Французский (Франция)" и, соответственно, тег fr-FR. Но как быть, если пользователь из Бельгии, с предпочитаемым языком fr-BE? Регион BE отличается от FR и CA, и можно предположить, что любой регион подходит для каждого из вариантов. Но для французского языка предпочитаемым регионом является Франция, поэтому в данном случае наилучшим соответствием будет считаться fr-FR.

Допустим, сначала вы локализовали приложение только для одной разновидности французского— "французский (Франция)", но определили язык строк как fr (то есть для общего случая). И теперь вы хотите добавить поддержку для канадского французского. Скорее всего, на канадский французский вам нужно будет перевести только отдельные ресурсы. Вы можете продолжать использовать все оригинальные ресурсы, определяя их как fr, а для добавленной небольшой части новых ресурсов задать язык fr-CA. Если предпочитаемый язык пользователя— fr-CA, ресурсы fr-CA будут иметь более высокую оценку соответствия, чем ресурсы fr. Но если предпочитаемый язык пользователя— любая другая разновидность французского, то ресурс для нейтрального региона (fr) будет иметь лучшее соответствие, чем ресурс fr-CA.

В качестве другого примера можно представить ситуацию, когда необходимо создать разные локализации на испанский язык для пользователей из Испании и Латинской Америки. Предположим далее, что локализация для Латинской Америки была предоставлена мексиканской компанией. Должны ли вы использовать языки es-ES (Испания) и es-MX (Мексика) для двух наборов ресурсов? Если вы так сделаете, у пользователей из других латиноамериканских регионов (например, Аргентины или Колумбии) могут возникнуть проблемы, так как для них будут использоваться ресурсы es-ES. Для этого случая наилучшим вариантом будет использование подтега макрорегиона— es-419. Это будет означать, что вы намереваетесь использовать ресурсы для пользователей из любой части Латинской Америки или Карибского бассейна.

Использование языковых тегов для нейтральных регионов и подтегов макрорегионов может быть весьма эффективным, если вы хотите обеспечить поддержку нескольких региональных разновидностей языка. Чтобы минимизировать число требуемых отдельных ресурсов, вы можете подготовить ресурс таким образом, чтобы реализовать максимальный охват области его применения. Затем при необходимости дополните ресурс широкого применения более специфическим вариантом. Для пользователей, говорящих на любой из региональных разновидностей языка, можно использовать ресурсы с квалификатором языка для нейтрального региона, если для этих пользователей не применимы другие ресурсы с квалификатором, в большей степени соответствующим их региону. Например, ресурс en можно использовать для англоязычного пользователя из Австралии. В то же время ресурс en-053 (английский, используемый в Австралии и Новой Зеландии) лучше подойдет для этого пользователя, а ресурс en-AU будет самым подходящим для него вариантом.

Английский язык требует особого рассмотрения. Если в приложение добавляется локализация для двух разновидностей английского, скорее всего, это будет американский английский и британский английский (международный). Как было сказано ранее, некоторые регионы за пределами США придерживаются американских правил правописания, и это учитывается при сопоставлении языков в Windows. В этом случае для указанных вариантов языка не рекомендуется использовать тег нейтрального региона en. Вместо него следует использовать теги en-GB и en-US. (Однако если конкретный ресурс не требует отдельных вариантов, можно использовать en.) Если вместо тегов en-GB или en-US использовать тег en, то он будет конфликтовать с соответствием орфографического сходства для региона в Windows. Если в приложение добавляется третья английская локализация, используйте соответствующий специальный подтег или подтег макрорегиона (например, en-CA, en-AU или en-053). При этом продолжайте использовать теги en-GB и en-US.

## <a name="related-topics"></a>Статьи по теме

* [Как система управления ресурсами сопоставляет и выбирает ресурсы](how-rms-matches-and-chooses-resources.md)
* [BCP-47](http://go.microsoft.com/fwlink/p/?linkid=227302)
* [Обзор языков профиля пользователя и языков манифеста приложения](../design/globalizing/manage-language-and-region.md)
* [Схема географических (континентальных) макрорегионов, географических субрегионов, отдельных экономик и других группировок.](http://go.microsoft.com/fwlink/p/?LinkId=247929)
