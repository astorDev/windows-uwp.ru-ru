---
title: Планирование переноса приложений на DirectX
description: Спланируйте свой проект переноса игры с DirectX 9 на DirectX 11 и универсальную платформу Windows (UWP) - обновление кода графики и помещение игры в среду выполнения Windows.
ms.assetid: 3c0c33ca-5d15-ae12-33f8-9b5d8da08155
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp, directx, перенос
ms.localizationpriority: medium
ms.openlocfilehash: 247c7cb05027520cb7a39e04ff65579297b66dc9
ms.sourcegitcommit: ac7f3422f8d83618f9b6b5615a37f8e5c115b3c4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "66368300"
---
# <a name="plan-your-directx-port"></a>Планирование переноса приложений на DirectX



**Сводка**

-   Планирование переноса приложений на DirectX
-   [Важные изменения с Direct3D 9 в Direct3D 11](understand-direct3d-11-1-concepts.md)
-   [Функция сопоставления](feature-mapping.md)


Спланируйте свой проект переноса игры с DirectX 9 на DirectX 11 и универсальную платформу Windows (UWP): обновление кода графики и помещение игры в среду выполнения Windows.

## <a name="plan-to-port-graphics-code"></a>Планирование переноса кода графики


Перед переносом игры на платформу UWP важно убедиться, что в игре нет остатков кода Direct3D 8. Убедитесь, что из игры полностью удален фиксированный конвейер функций. Полный список устаревших возможностей, включая функции фиксированного конвейера, можно найти в разделе [Устаревшие возможности](https://docs.microsoft.com/windows/desktop/direct3d10/d3d10-graphics-programming-guide-api-features-deprecated).

Обновление с Direct3D 9 до Direct3D 11 не сводится к рутинным поиску и замене. Вам необходимо быть знакомыми с различиями в устройствах, контексте устройств и графической инфраструктуре Direct3D, а также знать о прочих важных изменениях со времен Direct3D 9. Этот процесс можно начать, прочтя другие статьи в данном разделе.

Вспомогательные библиотеки D3DX и DXUT необходимо заменить на собственные вспомогательные библиотеки или средства от сообщества. Подробнее см. в разделе [о сопоставлении компонентов](feature-mapping.md).

> **Примечание**    можно использовать [набор инструментов DirectX](https://go.microsoft.com/fwlink/p/?LinkID=248929) или [DirectXTex](https://go.microsoft.com/fwlink/p/?LinkID=248926) заменить некоторые функциональные возможности, которые раньше реализовывались D3DX и DXUT.

 

Шейдеров, написанных на языке сборки необходимо обновить до HLSL, используя шейдера модели 4 уровень 9\_1 или 9\_3 функциональные возможности и шейдеров, написанные для библиотеку эффектов будет необходимо обновить до более новой версии синтаксиса HLSL. Подробнее см. в разделе [о сопоставлении компонентов](feature-mapping.md).

Познакомьтесь с различными [уровнями возможностей Direct3D](https://docs.microsoft.com/windows/desktop/direct3d11/overviews-direct3d-11-devices-downlevel-intro). Уровни возможностей классифицируют широкий спектр видеооборудования за счет определения наборов известных функций. Каждый из наборов примерно соответствует версии Direct3D, от 9.1 до 11.2. Все уровни возможностей используют API DirectX 11.

## <a name="plan-to-port-win32-ui-code-to-corewindow"></a>Планирование портирования кода пользовательского интерфейса Win32 в CoreWindow


Приложения UWP работают в окне, созданном для контейнера приложения и именуемом [**CoreWindow**](https://docs.microsoft.com/uwp/api/Windows.UI.Core.CoreWindow). Ваша игра контролирует окно, наследуя от [**IFrameworkView**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Core.IFrameworkView), что требует меньших подробностей реализации, чем окно рабочего стола. Основной цикл вашей игры будет находиться в методе [**IFrameworkView::Run**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.core.iframeworkview.run).

Жизненный цикл приложения UWP сильно отличается от такового классического приложения. Игру необходимо часто сохранять, поскольку при наступлении события приостановки у вашего приложения есть лишь ограниченное время на прекращение исполнения кода. В то же время необходимо гарантировать, что, когда ваше приложение возобновит работу, игрок сможет продолжить игру с того же места. Игры должны сохраняться достаточно часто, чтобы обеспечить непрерывность игрового процесса при возобновлении, но не настолько часто, чтобы сохранения повлияли на частоту кадров или привели к перебоям. Игре будет потенциально необходимо загружать свое состояние при возобновлении после прерывания.

[DirectXMath](https://docs.microsoft.com/windows/desktop/dxmath/ovw-xnamath-progguide) можно использовать в качестве замены для D3DXMath и XNAMath, и это может быть удобно, если необходима математическая библиотека. У DirectXMath имеются быстрые, переносимые типы данных и типы, которые сориентированы и упакованы для использования с шейдерами.

Собственные библиотеки, такие как [API Interlocked](https://docs.microsoft.com/windows/desktop/Sync/what-s-new-in-synchronization), были расширены для поддержки встроенных макроопределений ARM. Игры, которые используют API непрерываемых операций (Interlocked), могут продолжать использовать их в DirectX 11 и UWP.

Наши шаблоны и примеры кода используют новые возможности C++, с которыми вы пока, возможно, не знакомы. Например, асинхронные методы используются с [**лямбда-выражениями**](https://docs.microsoft.com/cpp/cpp/lambda-expressions-in-cpp) для загрузки ресурсов Direct3D без блокирования потока пользовательского интерфейса.

Есть две концепции, которые придется использовать часто.

-   Управляемые ссылки ([**оператор ^** ](https://docs.microsoft.com/cpp/windows/handle-to-object-operator-hat-cpp-component-extensions)) и [**управляемые классы**](https://docs.microsoft.com/cpp/windows/classes-and-structs-cpp-component-extensions) (классы ссылок) являются фундаментальной частью среды выполнения Windows. Классы управляемых ссылок будет необходимо использовать для взаимодействия с компонентами среды выполнения Windows, например [**IFrameworkView**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Core.IFrameworkView) (подробнее см. в пошаговом руководстве).
-   При работе с интерфейсами COM Direct3D 11 используйте тип шаблона [**Microsoft::WRL::ComPtr**](https://docs.microsoft.com/cpp/windows/comptr-class), чтобы упростить применение указателей СОМ.

 

 




