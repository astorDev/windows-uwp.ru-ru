---
author: mtoepke
title: Планирование переноса DirectX
description: Спланируйте свой проект переноса игры с DirectX 9 на DirectX 11 и универсальную платформу Windows (UWP) - обновление кода графики и помещение игры в среду выполнения Windows.
ms.assetid: 3c0c33ca-5d15-ae12-33f8-9b5d8da08155
ms.author: mtoepke
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp, directx, перенос
ms.localizationpriority: medium
ms.openlocfilehash: dea6455b4e9aaef2a4239ef70d0919a4b8841bc5
ms.sourcegitcommit: 3257416aebb5a7b1515e107866806f8bd57845a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2018
ms.locfileid: "7147499"
---
# <a name="plan-your-directx-port"></a>Планирование переноса DirectX



**Краткий обзор**

-   Планирование переноса приложений на DirectX
-   [Важные изменения в Direct3D11 по сравнению с Direct3D9](understand-direct3d-11-1-concepts.md)
-   [Сопоставление компонентов](feature-mapping.md)


Спланируйте свой проект переноса игры с DirectX 9 на DirectX 11 и универсальную платформу Windows (UWP): обновление кода графики и помещение игры в среду выполнения Windows.

## <a name="plan-to-port-graphics-code"></a>Планирование переноса кода графики


Перед переносом игры на платформу UWP важно убедиться, что в игре нет остатков кода Direct3D 8. Убедитесь, что из игры полностью удален фиксированный конвейер функций. Полный список устаревших возможностей, включая функции фиксированного конвейера, можно найти в разделе [Устаревшие возможности](https://msdn.microsoft.com/library/windows/desktop/cc308047).

Обновление с Direct3D 9 до Direct3D 11 не сводится к рутинным поиску и замене. Вам необходимо быть знакомыми с различиями в устройствах, контексте устройств и графической инфраструктуре Direct3D, а также знать о прочих важных изменениях со времен Direct3D 9. Этот процесс можно начать, прочтя другие статьи в данном разделе.

Вспомогательные библиотеки D3DX и DXUT необходимо заменить на собственные вспомогательные библиотеки или средства от сообщества. Подробнее см. в разделе [о сопоставлении компонентов](feature-mapping.md).

> **Примечание**  [Набор инструментов DirectX](http://go.microsoft.com/fwlink/p/?LinkID=248929) или [DirectXTex](http://go.microsoft.com/fwlink/p/?LinkID=248926) можно использовать для замены некоторых функций, ранее предоставляемых D3DX и DXUT.

 

Шейдеры, написанные на языке ассемблера, следует обновить до HLSL с использованием модели шейдеров 4, обладающей функциональными возможностями уровня 9\_1 или 9\_3, а шейдеры, написанные для библиотеки Effects, необходимо обновить до последней версии синтаксиса HLSL. Подробнее см. в разделе [о сопоставлении компонентов](feature-mapping.md).

Познакомьтесь с различными [уровнями возможностей Direct3D](https://msdn.microsoft.com/library/windows/desktop/ff476876). Уровни возможностей классифицируют широкий спектр видеооборудования за счет определения наборов известных функций. Каждый из наборов примерно соответствует версии Direct3D, от 9.1 до 11.2. Все уровни возможностей используют API DirectX 11.

## <a name="plan-to-port-win32-ui-code-to-corewindow"></a>Планирование портирования кода пользовательского интерфейса Win32 в CoreWindow


Приложения UWP работают в окне, созданном для контейнера приложения и именуемом [**CoreWindow**](https://msdn.microsoft.com/library/windows/apps/br208225). Ваша игра контролирует окно, наследуя от [**IFrameworkView**](https://msdn.microsoft.com/library/windows/apps/hh700478), что требует меньших подробностей реализации, чем окно рабочего стола. Основной цикл вашей игры будет находиться в методе [**IFrameworkView::Run**](https://msdn.microsoft.com/library/windows/apps/hh700505).

Жизненный цикл приложения UWP сильно отличается от такового классического приложения. Игру необходимо часто сохранять, поскольку при наступлении события приостановки у вашего приложения есть лишь ограниченное время на прекращение исполнения кода. В то же время необходимо гарантировать, что, когда ваше приложение возобновит работу, игрок сможет продолжить игру с того же места. Игры должны сохраняться достаточно часто, чтобы обеспечить непрерывность игрового процесса при возобновлении, но не настолько часто, чтобы сохранения повлияли на частоту кадров или привели к перебоям. Игре будет потенциально необходимо загружать свое состояние при возобновлении после прерывания.

[DirectXMath](https://msdn.microsoft.com/library/windows/desktop/ee415571) можно использовать в качестве замены для D3DXMath и XNAMath, и это может быть удобно, если необходима математическая библиотека. У DirectXMath имеются быстрые, переносимые типы данных и типы, которые сориентированы и упакованы для использования с шейдерами.

Собственные библиотеки, такие как [API Interlocked](https://msdn.microsoft.com/library/windows/desktop/dd405529), были расширены для поддержки встроенных макроопределений ARM. Игры, которые используют API непрерываемых операций (Interlocked), могут продолжать использовать их в DirectX 11 и UWP.

Наши шаблоны и примеры кода используют новые возможности C++, с которыми вы пока, возможно, не знакомы. Например, асинхронные методы используются с [**лямбда-выражениями**](https://msdn.microsoft.com/library/windows/apps/dd293608.aspx) для загрузки ресурсов Direct3D без блокирования потока пользовательского интерфейса.

Есть две концепции, которые придется использовать часто.

-   Управляемые ссылки ([**оператор ^**](https://msdn.microsoft.com/library/windows/apps/yk97tc08.aspx)) и [**управляемые классы**](https://msdn.microsoft.com/library/windows/apps/6w96b5h7.aspx) (классы ссылок) являются фундаментальной частью среды выполнения Windows. Классы управляемых ссылок будет необходимо использовать для взаимодействия с компонентами среды выполнения Windows, например [**IFrameworkView**](https://msdn.microsoft.com/library/windows/apps/hh700478) (подробнее см. в пошаговом руководстве).
-   При работе с интерфейсами COM Direct3D 11 используйте тип шаблона [**Microsoft::WRL::ComPtr**](https://msdn.microsoft.com/library/windows/apps/br244983.aspx), чтобы упростить применение указателей СОМ.

 

 




