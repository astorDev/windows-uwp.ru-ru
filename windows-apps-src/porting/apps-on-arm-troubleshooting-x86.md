---
title: Устранение неполадок в классических приложениях x86
description: Распространенные проблемы с приложениями x86 при работе в ARM и способы их устранения.
ms.date: 05/09/2018
ms.topic: article
keywords: windows 10 s, постоянно подключенный, эмуляция x86 в ARM, устранение неполадок
ms.localizationpriority: medium
ms.openlocfilehash: a71f33438a336aba67afbb30b19987b0e0aef83b
ms.sourcegitcommit: 26bb75084b9d2d2b4a76d4aa131066e8da716679
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2020
ms.locfileid: "75683937"
---
# <a name="troubleshooting-x86-desktop-apps"></a>Устранение неполадок в классических приложениях x86
>[!IMPORTANT]
> Пакет SDK для ARM64 теперь доступен как часть Visual Studio 15.8 Preview 1. Мы рекомендуем перекомпилировать приложение в формат для ARM64, чтобы ваше приложение работало на полной скорости в базовом режиме. Дополнительные сведения см. в записи блога [Early preview of Visual Studio support for Windows 10 on ARM development](https://blogs.windows.com/buildingapps/2018/05/08/visual-studio-support-for-windows-10-on-arm-development/).

Если классическое приложение x86 не работает так, как на компьютере x86, вот несколько советов по диагностике неполадок.

|Проблема|Решение|
|-----|--------|
| Приложение использует драйвер, который не предназначен для ARM. | Перекомпилируйте свой драйвер x86 в ARM64. См. раздел [Создание драйверов ARM64 с помощью WDK](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers). |
| Ваше приложение доступно только для версии x64. | Если выполняется разработка для Microsoft Store, отправьте ARM-версию вашего приложения. Дополнительные сведения см. в разделе [Архитектуры пакета приложения](/windows/msix/package/device-architecture). Если вы являетесь разработчиком для Win32, мы рекомендуем перекомпилировать приложение для ARM64. Дополнительные сведения см. в разделе [Early preview of Visual Studio support for Windows 10 on ARM development](https://blogs.windows.com/buildingapps/2018/05/08/visual-studio-support-for-windows-10-on-arm-development/). |
| Ваше приложение использует версию OpenGL выше 1.1 или требует OpenGL с аппаратным ускорением. | Используйте режим приложения DirectX, если доступно. Приложения x86, использующие DirectX 9, DirectX 10, DirectX 11 и DirectX 12, будут работать в ARM. Дополнительные сведения см. в разделе [Графика и игры DirectX](https://docs.microsoft.com/windows/desktop/directx). |
| Приложение x86 не работает должным образом. | Попробуйте использовать средство устранения проблем с совместимостью, выполнив следующие инструкции из раздела [Средство устранения проблем с совместимостью программ в ARM](apps-on-arm-program-compat-troubleshooter.md). Некоторые другие действия для устранения неполадок изложены в статье [Устранение неполадок с приложениями x86 в ARM](apps-on-arm-troubleshooting-x86.md). |

## <a name="best-practices-for-wow"></a>Рекомендации по WOW
Распространенная проблема возникает, когда приложение обнаруживает, что работает в WOW, а затем предполагает, что находится в системе x64. Сделав это предположение, приложение может сделать следующее:

- Попытаться установить версию x64 самого себя (а эта версия в ARM не поддерживается).
- Проверить наличие другого ПО в собственном представлении реестра.
- Предположить, что доступна 64-разрядная платформа .NET Framework.

Как правило, приложение не должно делать никаких предположений о системе, в которой оно размещено, если оно предназначено для работы в WOW. Старайтесь не взаимодействовать со встроенными компонентами ОС.

Приложение может поместить разделы реестра в собственное представление реестра или выполнить функции, исходя из присутствия WOW. Исходный параметр **IsWow64Process** указывает, работает ли приложение на компьютере x64. Теперь приложения должны использовать параметр [IsWow64Process2](https://docs.microsoft.com/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process2), чтобы определить, работают ли они в системе с поддержкой WOW. 

## <a name="drivers"></a>Драйверы 
Все работающие в режиме ядра драйверы, драйверы [среды выполнения платформы драйвера режима пользователя (UMDF)](https://docs.microsoft.com/windows-hardware/drivers/wdf/overview-of-the-umdf) и драйверы печати необходимо скомпилировать в соответствии с особенностью архитектуры ОС. Если приложение x86 имеет драйвер, необходимо перекомпилировать его для ARM64. Приложение x86 может нормально выполняться в эмуляции, однако его драйвер потребуется перекомпилировать для ARM64, и любые взаимодействия в этом приложении, которые зависят от этого драйвера, будут недоступны. Дополнительные сведения о компиляции драйвера для ARM64 см. в разделе [Создание драйверов ARM64 с помощью WDK](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers).

## <a name="shell-extensions"></a>Расширения оболочки 
Приложения, которые пытаются перехватить компоненты Windows или загрузить их DLL-файлы в процессы Windows, должны будут перекомпилировать эти DLL, чтобы они соответствовали архитектуре системы, например ARM64. Обычно они используются редакторами методов ввода (IME), вспомогательными технологиями и приложениями расширения оболочки (например, для отображения значков облачного хранилища в обозревателе или в контекстном меню щелчка правой кнопкой мыши). Чтобы узнать, как перекомпилировать приложения или библиотеки DLL для ARM64, см. запись блога [Early preview of Visual Studio support for Windows 10 on ARM development](https://blogs.windows.com/buildingapps/2018/05/08/visual-studio-support-for-windows-10-on-arm-development/). 

## <a name="debugging"></a>Отладка
Чтобы более тщательно проанализировать поведение вашего приложения, см. раздел [Отладка в ARM](https://docs.microsoft.com/windows-hardware/drivers/debugger/debugging-arm64) — это позволит узнать больше об инструментах и стратегиях отладки в ARM.

## <a name="virtual-machines"></a>Виртуальные машины
Платформа гипервизора Windows не поддерживается на платформе мобильных ПК Qualcomm Snapdragon 835. Следовательно, запуск виртуальных машин с помощью Hyper-V не сработает. Мы продолжим развивать эти технологии в будущих микросхемах Qualcomm. 

## <a name="dynamic-code-generation"></a>Динамическое создание кода
Классическое приложение x86 эмулируется на ARM64 системой, создающей инструкции ARM64 во время выполнения. Это означает, что если классическое приложение x86 не предотвращает создание или изменение динамического кода в процессе, это приложение не может выполняться как x86 в ARM64. 

Это позволяет снизить безопасность, так как некоторые приложения разрабатываются с помощью [сетпроцессмитигатионполици](https://docs.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-setprocessmitigationpolicy) API с флагом `ProcessDynamicCodePolicy`. Чтобы успешно запуститься в ARM64 как процесс x86, необходимо отключить эту политику защиты. 
