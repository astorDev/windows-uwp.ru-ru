---
author: normesta
Description: This article contains known issues with the Desktop Bridge.
Search.Product: eADQiWindows 10XVcnh
title: Известные проблемы (мост для классических приложений)
ms.author: normesta
ms.date: 06/20/2018
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10, uwp
ms.assetid: 71f8ffcb-8a99-4214-ae83-2d4b718a750e
ms.localizationpriority: medium
ms.openlocfilehash: 50a455dc43007a433bfabd995af7968e93fe1900
ms.sourcegitcommit: 5c9a47b135c5f587214675e39c1ac058c0380f4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "4354382"
---
# <a name="known-issues-with-packaged-desktop-applications"></a>Известные проблемы с упакованных классических приложений

В этой статье описываются известные проблемы, которые могут возникнуть при создании пакета приложения для Windows для классического приложения.

<a id="app-converter" />

## <a name="known-issues-with-the-desktop-app-converter"></a>Известные проблемы с Desktop App Converter

### <a name="ecreatingisolatedenvfailed-an-estartingisolatedenvfailed-errors"></a>Ошибки E_CREATING_ISOLATED_ENV_FAILED и E_STARTING_ISOLATED_ENV_FAILED    

Если вы получили какую-либо из этих ошибок, убедитесь, что вы используете правильный базовый образ из [центра загрузки](https://aka.ms/converterimages).
Если вы используете правильный базовый образ, попробуйте выполнить команду ``-Cleanup All``.
Если это не поможет устранить проблему, отправьте ваши журналы по адресу converter@microsoft.com, чтобы мы могли их изучить.

### <a name="new-containernetwork-the-object-already-exists-error"></a>Ошибка "New-ContainerNetwork: объект уже существует"

Эта ошибка может возникнуть при установке нового базового образа. Это происходит, если на вашем компьютере для разработки, на котором ранее был установлен Desktop App Converter, есть тестируемая возможность, предназначенная для участников программы предварительной оценки Windows.

Чтобы решить эту проблему, попробуйте выполнить команду `Netsh int ipv4 reset` из командной строки с повышенными привилегиями, а затем перезагрузите компьютер.

### <a name="your-net-application-is-compiled-with-the-anycpu-build-option-and-fails-to-install"></a>Приложение .NET скомпилировано с использованием параметра сборки «AnyCPU» и не удается установить

Это может произойти, если главный исполняемый файл или некая зависимость были размещены где-то в иерархии папок **Program Files** или **Windows\System32**.

Чтобы решить эту проблему, попробуйте использовать установщик рабочего стола определенной архитектуры (32-разрядный или 64-разрядный), чтобы создать пакет приложения для Windows.

### <a name="publishing-public-side-by-side-fusion-assemblies-wont-work"></a>Публикация общедоступных параллельных сборок Fusion будет невозможна.

 В ходе процесса установки приложение может публиковать параллельные общедоступные сборки Fusion, которые являются доступными для любого другого процесса. Во время создания контекста активации процесса эти сборки извлекаются системным процессом с именем CSRSS.exe. Когда эта процедура выполняется для преобразованного процесса, будет происходить сбой процессов создания контекста активации и загрузки модулей этих сборок. Параллельные сборки Fusion регистрируются в следующих местах:
  + Реестр: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SideBySide\Winners`
  + Файловая система: %windir%\\SideBySide

Это известное ограничение, и в настоящее время решения этой проблемы не существует. Несмотря на сказанное, входящие сборки, такие как ComCtl, поставляются вместе с операционной системой, поэтому указание зависимости от них является безопасным.

### <a name="error-found-in-xml-the-executable-attribute-is-invalid---the-value-myappexe-is-invalid-according-to-its-datatype"></a>В XML обнаружена ошибка. Атрибут "Executable" недействителен: значение "MyApp.EXE" недействительно с точки зрения его типа данных

Эта проблема может произойти, если исполняемые файлы в вашем приложении имеют расширение **. EXE**, написанное прописными буквами. Хотя регистр расширения не должен влиять на ваше приложение работает, это может привести к возникновению этой ошибки DAC.

Чтобы решить эту проблему, попробуйте во время упаковки указать флаг **-AppExecutable** и использовать расширение основного исполняемого файла, записанное в нижнем регистре (например, MYAPP.exe).    Либо вы можете изменить регистр всех исполняемых файлов в вашем приложении с нижнего на верхний (например: из. EXE .exe).

### <a name="corrupted-or-malformed-authenticode-signatures"></a>Поврежденные или деформированные подписи Authenticode

Этот раздел содержит инструкции по выявлению проблем с переносными исполняемыми файлами (PE) в пакете приложения для Windows, который может содержать поврежденные или деформированные подписи Authenticode. Наличие недействительных подписей Authenticode в файлах PE, которые могут иметь любой двоичный формат (например, .exe, .dll, .chm и т.д.), приведет к тому, что вы не сможете правильно подписать пакет и, таким образом, не сможете развернуть его из пакета приложения для Windows.

Расположение подписи Authenticode файла PE определяется записью в таблице сертификатов в каталогах данных необязательных заголовков и соответствующей таблице сертификатов атрибутов. Во время проверки подписи сведения, указанные в этих местах, используются для поиска подписи на файле PE. При повреждении этих значений процесс подписывания файла может быть выполнен некорректно.

Чтобы подпись Authenticode была правильной, применительно к ней должны быть выполнены следующие условия:

- Начало записи **WIN_CERTIFICATE** в файле PE не должно выходить за границу исполняемого файла.
- Запись **WIN_CERTIFCATE** должна размещаться в конце образа.
- Размер записи **WIN_CERTIFICATE** должен быть положительным.
- Запись **WIN_CERTIFICATE** должна начинаться после структуры **IMAGE_NT_HEADERS32** для 32-разрядных исполняемых файлов и после структуры IMAGE_NT_HEADERS64 для 64-разрядных исполняемых файлов.

Дополнительные сведения см. в спецификациях [Формат подписи Authenticode Portal Executable](http://download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/Authenticode_PE.docx) и [Формат файла PE](https://msdn.microsoft.com/windows/hardware/gg463119.aspx).

Обратите внимание, что при попытке подписывания пакета приложения для Windows средство SignTool.exe может выводить информацию о поврежденных или деформированных двоичных файлах. Чтобы это сделать, включите регистрацию подробных сведений в журнале, задав переменной среды APPXSIP_LOG значение 1 (например, ```set APPXSIP_LOG=1``` ) и перезапустите средство SignTool.exe.

Чтобы исправить эти деформированные двоичные файлы, убедитесь, что они соответствуют описанным выше требованиям.

## <a name="you-receive-the-error----msb4018-the-generateresource-task-failed-unexpectedly"></a>Сообщение об ошибке MSB4018, неожиданный сбой задачи GenerateResource

Это может произойти при попытке преобразования вспомогательных сборок в файлы индекса ресурсов пакетов (PRI).

Мы осведомлены об этой проблеме и работаем над ее окончательным решением. В качестве временного решения можно отключить генератор ресурсов, добавив следующую строку XML в первый элемент PropertyGroup в файле вышестоящего проекта:

``<AppxGeneratePrisForPortableLibrariesEnabled>false</AppxGeneratePrisForPortableLibrariesEnabled>``

## <a name="blue-screen-with-error-code-0x139-kernelsecuritycheckfailure"></a>Синий экран с кодом ошибки 0x139 (KERNEL_SECURITY_CHECK_FAILURE)

После установки или запуска некоторых приложений из Microsoft Store компьютер может неожиданно перезагрузиться с ошибкой **0x139 (KERNEL\_SECURITY\_CHECK\_ FAILURE)**.

Известно, что эта проблема затрагивает приложения Kodi, JT2Go, Ear Trumpet, Teslagrad и др.

27.10.2016г. было выпущено [обновление Windows (версия 14393.351— KB3197954)](https://support.microsoft.com/kb/3197954), в которое вошли важные исправления, направленные на решение этой проблемы. Если вы столкнулись с этой проблемой, обновите свой компьютер. Если вам не удается обновить компьютер, потому что он перезапускается до того, как вам удается войти в систему, восстановите систему до точки более ранней, чем установка одного из затрагиваемых проблемой приложений. О том, как восстановить систему, см. в статье [Параметры восстановления в Windows 10](https://support.microsoft.com/help/12415/windows-10-recovery-options).

Если обновление не устраняет проблему или вы не знаете, как восстановить компьютер, обратитесь в [службу поддержки Microsoft](https://support.microsoft.com/contactus/).

Если вы разработчик, вы можете запретить установку своих упакованных приложений в версиях Windows, в которых нет этого обновления. Обратите внимание, что при этом ваше приложение не будет доступно пользователям, которые еще не установили обновление. Чтобы ограничить доступность приложения для пользователей, которые установили обновления, внесите в файл AppxManifest.xml следующим образом:

```<TargetDeviceFamily Name="Windows.Desktop" MinVersion="10.0.14393.351" MaxVersionTested="10.0.14393.351"/>```

Подробнее о Центре обновления Windows можно прочитать по следующим ссылкам:
* https://support.microsoft.com/kb/3197954
* https://support.microsoft.com/help/12387/windows-10-update-history

## <a name="common-errors-that-can-appear-when-you-sign-your-app"></a>Распространенные ошибки, которые могут появиться при входе в приложение

### <a name="publisher-and-cert-mismatch-causes-signtool-error-error-signersign-failed--21470248850x8007000b"></a>Несоответствие издателя и сертификата приводит к ошибке Signtool "Error: SignerSign() Failed" (-2147024885/0x8007000b)

Запись издателя в манифесте пакета приложения для Windows должна соответствовать субъекту сертификата, с помощью которого выполняется подписывание.  Вы можете использовать любой из следующих методов для просмотра субъекта сертификата.

**Вариант 1: Powershell**

Выполните следующую команду PowerShell: В качестве файла сертификата можно использовать как .cer, так и .pfx, так как они содержат идентичные сведения об издателе.

```ps
(Get-PfxCertificate <cert_file>).Subject
```

**Вариант 2: проводник**

Дважды щелкните сертификат в проводнике, выберите вкладку *Сведения*, а затем выберите поле *Субъект* в списке. Скопируйте его содержимое.

**Вариант 3: CertUtil**

Запустите **certutil** через командную строку в файле PFX и скопируйте поле *Субъект* в выходных данных.

```cmd
certutil -dump <cert_file.pfx>
```

<a id="bad-pe-cert" />

### <a name="bad-pe-certificate-0x800700c1"></a>Поврежденных PE сертификата (0x800700C1)

Это может произойти, если пакет содержит двоичный файл, который имеет поврежденные сертификат. Вот некоторые из причин, почему это может произойти.

* Меню "Пуск" сертификата не в конце изображения.  

* Размер сертификата не положительным.

* Меню "Пуск" сертификат не является после `IMAGE_NT_HEADERS32` структуру для 32-разрядных исполняемого файла или после `IMAGE_NT_HEADERS64` структуру для 64-разрядных исполняемого файла.

* Указатель сертификат не является правильно выровнены WIN_CERTIFICATE структуры.

Чтобы найти файлы, содержащие поврежденных PE сертификат, откройте **командную**строку и задать переменную среды с именем `APPXSIP_LOG` значение 1.

```
set APPXSIP_LOG=1
```

Затем из **командной строки**, подпишите приложение еще раз. Пример.

```
signtool.exe sign /a /v /fd SHA256 /f APPX_TEST_0.pfx C:\Users\Contoso\Desktop\pe\VLC.appx
```

Сведения о том, файлы, содержащие поврежденных PE сертификат будет отображаться в **Окне консоли**. Пример.

```
...

ERROR: [AppxSipCustomLoggerCallback] File has malformed certificate: uninstall.exe

...   
```
## <a name="next-steps"></a>Дальнейшие действия

**Поиск ответов на вопросы**

Есть вопросы? Задайте их на Stack Overflow. Наша команда следит за этими [тегами](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge). Вы также можете задать нам вопросы [здесь](https://social.msdn.microsoft.com/Forums/en-US/home?filter=alltypes&sort=relevancedesc&searchTerm=%5BDesktop%20Converter%5D).

**Оставьте отзыв или предложите новые возможности для реализации**

См. раздел [UserVoice](https://wpdev.uservoice.com/forums/110705-universal-windows-platform/category/161895-desktop-bridge-centennial)
