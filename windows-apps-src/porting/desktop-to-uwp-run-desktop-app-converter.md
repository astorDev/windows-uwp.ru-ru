---
author: normesta
Description: "Запуск Desktop App Converter для упаковки классического приложения для Windows (например, Win32, WPF и Windows Forms)."
Search.Product: eADQiWindows 10XVcnh
title: "Упаковка приложения с помощью Desktop App Converter (мост для классических приложений)"
ms.author: normesta
ms.date: 05/25/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10, uwp
ms.assetid: 74c84eb6-4714-4e12-a658-09cb92b576e3
ms.openlocfilehash: 6aa469d0080412f48de511315684d365d4e90c99
ms.sourcegitcommit: 6c6f3c265498d7651fcc4081c04c41fafcbaa5e7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2017
---
# <a name="package-an-app-using-the-desktop-app-converter-desktop-bridge"></a>Упаковка приложения с помощью Desktop App Converter (мост для классических приложений)

[Получение Desktop App Converter](https://aka.ms/converter)

Вы можете использовать Desktop App Converter (DAC) для переноса ваших классических приложений на универсальную платформу Windows (UWP). Сюда входят приложения Win32 и приложения, созданные с помощью .NET 4.6.1.

<div style="float: left; padding: 10px">
    ![Значок DAC](images/desktop-to-uwp/dac.png)
</div>

Хотя в названии этого средства содержится термин «Преобразователь», на самом деле оно не преобразует ваше приложение. Приложение останется неизменным. Однако это средство создает пакет приложения для Windows с идентификатором пакета. Также преобразователь обеспечивает возможность осуществлять вызов разнообразных API WinRT.

Чтобы установить этот пакет на компьютер, на котором ведется разработка, можно использовать командлет Add-AppxPackage для PowerShell.

Преобразователь запустит классическую программу установки в изолированной среде Windows, используя чистый базовый образ, предоставляемый в составе скачиваемых файлов преобразователя. Он захватывает любые операции ввода-вывода реестра и файловой системы, инициализируемые классической программой установки, и упаковывает их в виде части выходных данных.

> [!NOTE]
> Ознакомьтесь с <a href="https://mva.microsoft.com/en-US/training-courses/developers-guide-to-the-desktop-bridge-17373?l=oZG0B1WhD_8406218965/">этой серией</a> коротких видеозаписей, опубликованных академией Microsoft Virtual Academy. В них рассматриваются некоторые распространенные способы использования преобразователя Desktop App Converter.

## <a name="the-dac-does-more-than-just-generate-a-package-for-you"></a>DAC не просто создает для вас пакет.

Вот несколько дополнительных возможностей, предоставляемых DAC.

**Windows 10 Creators Update**

<div style="float: left; ">
    ![Галочка](images/desktop-to-uwp/check.png)
</div>

Автоматическая регистрация ваших обработчиков просмотра, эскизов, обработчиков свойств, правил брандмауэра, флагов URL.

<div style="float: left; ">
    ![Галочка](images/desktop-to-uwp/check.png)
</div>

Автоматическая регистрация сопоставлений типов файлов, которые позволяют пользователям группировать файлы с помощью столбца **Вид** в проводнике.

<div style="float: left; ">
    ![Галочка](images/desktop-to-uwp/check.png)
</div>

Регистрация ваших общедоступных COM-серверов.

**Юбилейное обновление Windows10 или более поздних версий**

<div style="float: left; ">
    ![Галочка](images/desktop-to-uwp/check.png)
</div>

Автоматическое подписывание пакета, чтобы вы могли протестировать ваше приложение.

<div style="float: left; ">
    ![Галочка](images/desktop-to-uwp/check.png)
</div>

Проверка вашего приложения на соответствие требованиям моста для классических приложений и Магазина Windows.

Полный список параметров см. в разделе [Параметры](#command-reference) данного руководства.

Если вы готовы приступить к созданию пакета, давайте начнем.

## <a name="first-consider-how-youll-distribute-your-app"></a>Выбор способа распространения приложения
Если вы планируете опубликовать свое приложение в [Магазине Windows](https://www.microsoft.com/store/apps), начните с заполнения [этой формы](https://developer.microsoft.com/windows/projects/campaigns/desktop-bridge). После этого Майкрософт свяжется с вами, чтобы начать процесс публикации. В рамках этого процесса вы зарезервируете имя в Магазине и получите информацию, необходимую для упаковки приложения.

## <a name="make-sure-that-your-system-can-run-the-converter"></a>Системные требования для преобразователя

Убедитесь, что ваша система соответствует следующим требованиям:

* Юбилейное обновление Windows 10 Pro или Корпоративная (10.0.14393.0 и более поздней версии).
* 64-разрядный процессор (x64).
* Аппаратная виртуализация
* Преобразование адресов второго уровня (SLAT).
* [Пакет средств разработки программного обеспечения (SDK) для Windows10](https://go.microsoft.com/fwlink/?linkid=821375).


## <a name="start-the-desktop-app-converter"></a>Запуск Desktop App Converter

1. Скачайте и установите [Desktop App Converter](https://aka.ms/converter).

2. Запустите Desktop App Converter от имени администратора.

    ![запуск DAC от имени администратора](images/desktop-to-uwp/run-converter.png)

   Откроется окно консоли. Оно будет использоваться для выполнения команд.

## <a name="set-a-few-things-up-apps-with-installers-only"></a>Настройка нескольких параметров (только для приложений с установщиками)

Вы можете пропустить этот раздел, если ваше приложение не имеет установщика.

1. Определите номер версии вашей операционной системы.

   Для этого откройте на вашем компьютере **приложение "Сведения о системе"** и найдите номер версии операционной системы.

    ![версия операционной системы в приложении "Сведения о системе"](images/desktop-to-uwp/os-version.png)

2. Скачайте подходящий [базовый образ Desktop app Converter](https://aka.ms/converterimages).

   Убедитесь, что номер версии, указанный в имени файла, соответствует номеру версии вашей сборки Windows.

   ![соответствующая версия базового образа](images/desktop-to-uwp/base-image-version.png)

   Поместите скачанный файл в любое расположение на вашем компьютере, где вы сможете найти его в дальнейшем.

3. В окне консоли, которое появилось при запуске Desktop App Converter, выполните следующую команду: ```Set-ExecutionPolicy bypass```.
4.  Настройте преобразователь, выполнив следующую команду: ```DesktopAppConverter.exe -Setup -BaseImage .\BaseImage-1XXXX.wim -Verbose```.
5.  Перезапустите компьютер при появлении соответствующего запроса.

    По мере развертывания базового образа в окне консоли будут появляться сообщения о состоянии. Если вы не видите эти сообщения, нажмите любую клавишу. Это может привести к обновлению содержимого в окне консоли.

    ![сообщения о состоянии в окне консоли](images/desktop-to-uwp/bas-image-setup.png)

    Когда базовый образ будет полностью развернут, перейдите к следующему разделу.

## <a name="package-an-app"></a>Упаковка приложения

Для упаковки вашего приложения выполните команду ``DesktopAppConverter.exe`` в окне консоли, открываемой при запуске Desktop App Converter.  

С помощью параметров укажите имя пакета, издателя и номер версии приложения.

> [!NOTE]
> Если вы зарезервировали имя приложения в Магазине Windows, вы можете получить имена пакета и издателя с помощью информационной панели Центра разработки для Windows. Если планируется, что приложение будет загружено на другие системы в неопубликованном виде, вы можете указать для этих атрибутов собственные имена при условии, что имя издателя совпадает с именем, указанным в сертификате, который используется для подписания приложения.

### <a name="a-quick-look-at-command-parameters"></a>Краткий обзор параметров команды

Вот список необходимых параметров:

```CMD
DesktopAppConverter.exe
-Installer <String>
-Destination <String>
-PackageName <String>
-Publisher <String>
-Version <Version>
```
Вы можете прочитать о каждом из них [здесь](#command-reference).

### <a name="examples"></a>Примеры

Вот несколько распространенных способов упаковки приложения.

* [Упаковка приложения, имеющего файл установщика (.msi)](#installer-conversion)
* [Упаковка приложения, имеющего исполняемый файл установки](#setup-conversion)
* [Упаковка приложения, не имеющего установщика](#no-installer-conversion)
* [Упаковка, подписание и подготовка приложения для отправки в Магазин](#optional-parameters)

<span id="installer-conversion" />
#### <a name="package-an-app-that-has-an-installer-msi-file"></a>Упаковка приложения, имеющего файл установщика (.msi)

Укажите файл установщика с помощью параметра ``Installer``.

```cmd
DesktopAppConverter.exe -Installer C:\Installer\MyAppSetup.msi -Destination C:\Output\MyApp -PackageName "MyApp" -Publisher "CN=MyPublisher" -Version 0.0.0.1
```

> [!NOTE]
> Убедитесь, что ваш установщик находится в независимой папке и что в ней размещаются только файлы, связанные с этим установщиком. Преобразователь копирует все содержимое этой папки в изолированную среду Windows.

**Видео**

<iframe src="https://mva.microsoft.com/en-US/training-courses-embed/developers-guide-to-the-desktop-bridge-17373/Demo-Convert-an-Application-That-Has-an-MSI-Installer-Kh1UU2WhD_7106218965" width="636" height="480" allowFullScreen frameBorder="0"></iframe>

<span id="setup-conversion" />
#### Упаковка приложения, имеющего исполняемый файл установки

Укажите исполняемый файл установки с помощью параметра ``Installer``.

```cmd
DesktopAppConverter.exe -Installer C:\Installer\MyAppSetup.exe -InstallerArguments "/S" -Destination C:\Output\MyApp -PackageName "MyApp" -Publisher "CN=MyPublisher" -Version 0.0.0.1
```

Параметр ``InstallerArguments`` является необязательным. Однако так как преобразователю Desktop App Converter необходимо, чтобы ваш установщик работал в автоматическом режиме, этот параметр может потребоваться, чтобы указать флаги для тихой работы вашего приложения, если таковые ему нужны. Флаг ``/S`` — очень распространенный флаг автоматического режима, однако ваш флаг может отличаться в зависимости от того, какие технологии вы использовали для создания файла установки.

**Видео**

<iframe src="https://mva.microsoft.com/en-US/training-courses-embed/developers-guide-to-the-desktop-bridge-17373/Demo-Convert-an-Application-That-Has-a-Setup-exe-Installer-amWit2WhD_5306218965" width="636" height="480" allowFullScreen frameBorder="0"></iframe>

<span id="no-installer-conversion" />
#### Упаковка приложения, не имеющего установщика

В этом примере используйте параметр ``Installer``, чтобы указать корневую папку ваших файлов приложения.

Используйте параметр `AppExecutable`, чтобы указать исполняемый файл приложения.

```cmd
DesktopAppConverter.exe -Installer C:\Installer\MyApp\ -AppExecutable MyApp.exe -Destination C:\Output\MyApp -PackageName "MyApp" -Publisher "CN=MyPublisher" -Version 0.0.0.1
```

**Видео**

<iframe src="https://mva.microsoft.com/en-US/training-courses-embed/developers-guide-to-the-desktop-bridge-17373/Demo-Convert-a-No-Installer-Application-agAXF2WhD_3506218965" width="636" height="480" allowFullScreen frameBorder="0"></iframe>

<span id="optional-parameters" />
#### Упаковка и подписание приложения, а также запуск проверочных тестов для пакета

Этот пример похож на первый за одним исключением: здесь описывается, как можно подписать приложение для локального тестирования, а затем проверить его на соответствие требованиям Магазина Windows и моста для классических приложений.

```cmd
DesktopAppConverter.exe -Installer C:\Installer\MyAppSetup.exe -InstallerArguments "/S" -Destination C:\Output\MyApp -PackageName "MyApp" -Publisher "CN=MyPublisher" -Version 0.0.0.1 -MakeAppx -Sign -Verbose -Verify
```

Параметр ``Sign`` создает сертификат, а затем подписывает с его помощью ваше приложение. Для запуска приложения вам придется установить этот сертификат. Дополнительные сведения см. в разделе [Запуск упакованного приложения](#run-app) данного руководства.

Проверить приложение можно с помощью параметра ``Verify``.

### <a name="a-quick-look-at-optional-parameters"></a>Краткий обзор необязательных параметров

Параметры ``Sign`` и ``Verify`` являются необязательными. Существуют и другие необязательные параметры.  Вот некоторые из наиболее часто используемых:

```CMD
[-ExpandedBaseImage <String>]
[-AppExecutable <String>]
[-AppFileTypes <String>]
[-AppId <String>]
[-AppDisplayName <String>]
[-AppDescription <String>]
[-PackageDisplayName <String>]
[-PackagePublisherDisplayName <String>]
[-MakeAppx]
[-LogFile <String>]
[<CommonParameters>]
```
Вы можете прочитать о них в следующем разделе.

<span id="command-reference" />
### <a name="parameter-reference"></a>Справка по параметрам

Ниже приведен полный список параметров (упорядоченных по категориям), которые можно использовать при запуске Desktop App Converter.

* [Настройка](#setup-params)
* [Преобразование](#conversion-params)
* [Идентификатор пакета](#identity-params)
* [Манифест пакета](#manifest-params)
* [Очистка](#cleanup-params)
* [Архитектура](#architecture-params)
* [Прочее](#other-params)

Чтобы просмотреть весь список, можно также выполнить в окне консоли команду ``Get-Help``.   

||||
|-------------|-----------|-------------|
|<span id="setup-params" /> <strong>Параметры установки</strong>  ||
|-Setup [&lt;параметр-переключатель&gt;] |Обязательный |Запускает DesktopAppConverter в режиме установки. Режим установки поддерживает развертывание предоставляемого базового образа.|
|-BaseImage &lt;String&gt; | Обязательный |Полный путь к неразвернутому базовому образу. Этот параметр необходим, если указан параметр -Setup.|
| -LogFile &lt;String&gt; |Необязательный |Определяет файл журнала. Если этот параметр пропущен, для файла журнала будет создано временное расположение.|
|-NatSubnetPrefix &lt;String&gt; |Необязательный |Значение префикса, которое необходимо использовать для экземпляра Nat. Как правило, это значение будет необходимо изменить, только если ваш хост-компьютер подключен к тому же диапазону адресов подсети, что и NetNat преобразователя. Вы можете запросить текущую NetNat-конфигурацию преобразователя, используя командлет **Get-NetNat**. |
|-NoRestart [&lt;параметр-переключатель&gt;] |Обязательный |Подавляет вывод запроса на перезагрузку при выполнении программы установки (перезагрузка необходима для включения функции контейнеров). |
|<span id="conversion-params" /> <strong>Параметры преобразования</strong>|||
|-AppInstallPath &lt;String&gt;  |Необязательный |Полный путь к корневой папке вашего приложения для установленных файлов, если они были установлены (например, "C:\Program Files (x86)\MyApp").|
|-Destination &lt;String&gt; |Обязательный |Желаемое расположение выходного файла AppX, создаваемого преобразователем. DesktopAppConverter может создать это расположение, если оно еще не существует.|
|-Installer &lt;String&gt; |Обязательный |Путь к программе установки вашего приложения, которая должна поддерживать выполнение в автоматическом (тихом) режиме. Если выполняется преобразование для приложения без установщика, указывается путь к корневому каталогу файлов приложения. |
|-InstallerArguments &lt;String&gt; |Необязательный |Список с разделителями-запятыми или строка аргументов, чтобы перевести выполнение программы установки в автоматический (тихий) режим. Этот параметр необязателен, если вы используете программу установки msi. Для получения журнала из программы установки укажите в этом месте аргумент журнала для программы установки и используйте путь &lt;папка_журнала&gt;, являющийся маркером, который преобразователь заменит соответствующим путем. <br><br>**ПРИМЕЧАНИЕ.** Типы флага автоматического (тихого) режима и аргументов журнала зависят от технологий, использующихся в программе установки. <br><br>Пример использования этого параметра: -InstallerArguments "/silent /log &lt;папка_журнала&gt;\install.log" Другой пример, в котором не выполняется создание файла журнала, может выглядеть так: ```-InstallerArguments "/quiet", "/norestart"``` Опять же, если вы хотите, чтобы преобразователь осуществлял захват пути маркера и помещал его в папку с конечным журналом, вы должны в буквальном смысле направлять все журналы по пути маркера &lt;папка_журнала&gt;.|
|-InstallerValidExitCodes &lt;Int32&gt; |Необязательный |Разделенный запятыми список кодов завершения, указывающих на то, что программа установки была выполнена успешно (например: 0, 1234, 5678).  По умолчанию для программ установки, отличных от MSI, используется значение 0, а для программ установки MSI— 0, 1641, 3010.|
|<span id="identity-params" /><strong>Параметры идентификатора пакета</strong>||
|-PackageName &lt;String&gt; |Обязательный |Имя пакета вашего универсального приложения для Windows. |
|-Publisher &lt;String&gt; |Обязательный |Издатель вашего пакета универсального приложения для Windows |
|-Version &lt;Version&gt; |Обязательный |Номер версии вашего пакета универсального приложения для Windows |
|<span id="manifest-params" /><strong>Параметры манифеста пакета</strong>||
|-AppExecutable &lt;String&gt; |Необязательный |Имя основного исполняемого файла вашего приложения (например, "MyApp.exe"). Этот параметр является обязательным для преобразования приложений, не имеющих установщика. |
|-AppFileTypes &lt;String&gt;|Необязательный |Список типов файлов, с которыми будет связано приложение. Типы файлов должны отделяться друг от друга запятыми. Пример использования: -AppFileTypes "'.md', '.markdown'".|
|-AppId &lt;String&gt; |Необязательный |Указывает значение, которое нужно задать идентификатору приложения в манифесте пакета приложения для Windows. Если параметр не указан, ему будет задано значение, передаваемое для *PackageName*.|
|-AppDisplayName &lt;String&gt;  |Необязательный |Указывает значение, которое нужно задать отображаемому имени приложения в манифесте пакета приложения для Windows. Если параметр не указан, ему будет задано значение, передаваемое для *PackageName*. |
|-AppDescription &lt;String&gt; |Необязательный |Указывает значение, которое нужно задать описанию приложения в манифесте пакета приложения для Windows. Если параметр не указан, ему будет задано значение, передаваемое для *PackageName*.|
|-PackageDisplayName &lt;String&gt; |Необязательный |Указывает значение, которое нужно задать отображаемому имени пакета в манифесте пакета приложения для Windows. Если параметр не указан, ему будет задано значение, передаваемое для *PackageName*. |
|-PackagePublisherDisplayName &lt;String&gt; |Необязательный |Указывает значение, которое нужно задать отображаемому имени издателя пакета в манифесте пакета приложения для Windows. Если параметр не указан, ему будет задано значение, передаваемое для *Publisher*. |
|<span id="cleanup-params" /><strong>Параметры очистки</strong>|||
|-Cleanup [&lt;опция&gt;] |Обязательный |Запускает очистку артефактов DesktopAppConverter. Существует 3допустимых варианта режима отчистки. |
|-Cleanup All | |Удаляет все развернутые базовые образы, временные файлы преобразователя и контейнерную сеть, а также отключает необязательную функцию Windows— "Контейнеры". |
|-Cleanup WorkDirectory |Обязательный |Удаляет все временные файлы преобразователя. |
|-Cleanup ExpandedImage |Обязательный |Удаляет все развернутые базовые образы, установленные на вашем хост-компьютере. |
|<span id="architecture-params" /><strong>Параметры архитектуры пакета</strong>|||
|-PackageArch &lt;String&gt; |Обязательный |Создает пакет с указанной архитектурой. Допустимые типы архитектуры: "x86" или "x64"; например — PackageArch x86. Это необязательный параметр. Если не выбрать тип архитектуры пакета, DesktopAppConverter попытается определить ее автоматически. Если автоматически определить архитектуру не удается, будет использоваться архитектура пакета по умолчанию— x64. |
|<span id="other-params" /><strong>Прочие параметры</strong>|||
|-ExpandedBaseImage &lt;String&gt;  |Необязательный |Полный путь к уже развернутому базовому образу.|
|-MakeAppx [&lt;параметр-переключатель&gt;]  |Необязательный |Если этот переключатель указан, то он сообщает сценарию, что MakeAppx должен вызвать выходные данные. |
|-LogFile &lt;String&gt;  |Необязательный |Определяет файл журнала. Если этот параметр пропущен, для файла журнала будет создано временное расположение. |
| -Sign [&lt;параметр-переключатель&gt;] |Необязательный |Сообщает этому сценарию, что требуется подписать выходной пакет приложения для Windows, используя созданный сертификат, для тестирования. Этот параметр следует использовать вместе с параметром ```-MakeAppx```. |
|&lt;Общие параметры&gt; |Обязательный |Данный командлет поддерживает общие параметры: *Verbose*, *Debug*, *ErrorAction*, *ErrorVariable*, *WarningAction*, *WarningVariable*, *OutBuffer*, *PipelineVariable* и *OutVariable*. Дополнительные сведения см. в разделе [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216). |
| -Verify [&lt;параметр-переключатель&gt;] |Необязательный |Если указан этот переключатель, он передает DAC команду проверить пакет приложения на соответствие требованиям моста для классических приложений и Магазина Windows. Результат — отчет о проверке "VerifyReport.xml", который лучше всего отображается в браузере. Этот параметр следует использовать вместе с параметром `-MakeAppx`. |
|-PublishComRegistrations| Необязательный| Сканирует все общедоступные регистрации COM, выполненные вашим установщиком, и публикует в манифесте те из них, которые являются допустимыми. Используйте этот флаг, только если хотите, чтобы эти регистрации стали доступны для других приложений. Не указывайте данный флаг, если эти регистрации будут использоваться только вашим приложением. <br><br>Ознакомьтесь с [этим разделом](https://blogs.windows.com/buildingapps/2017/04/13/com-server-ole-document-support-desktop-bridge/#lDg5gSFxJ2TDlpC6.97), чтобы убедиться, что поведение ваших регистраций COM после упаковки приложения соответствует ожидаемому.

<span id="run-app" />
## <a name="run-the-packaged-app"></a>Запуск упакованного приложения

Существует два способа запуска вашего приложения.

Первый — открыть командную строку PowerShell, а затем ввести следующую команду: ```Add-AppxPackage –Register AppxManifest.xml```. Возможно, это наиболее простой способ запустить приложение, так как его не нужно подписывать.

Другой способ— подписать ваше приложение с помощью сертификата. Если вы используете параметр ```sign```, Desktop App Converter создаст файл сертификата, а затем подпишет ваше приложение. Этот файл называется **auto-generated.cer** и находится в корневой папке вашего упакованного приложения.

Чтобы установить созданный сертификат и запустить приложение, выполните следующие действия:

1. Дважды щелкните файл **auto-generated.cer**, чтобы установить этот сертификат.

   ![созданный файл сертификата](images/desktop-to-uwp/generated-cert-file.png)

   > [!NOTE]
   > При появлении запроса пароля используйте пароль по умолчанию "123456".

2. В диалоговом окне **Сертификат** нажмите кнопку **Установить сертификат**.
3. В окне **Мастер импорта сертификатов** установите сертификат на **Локальный компьютер**, а затем поместите в хранилище сертификатов **Доверенные лица**.

   ![Хранилище "Доверенные лица"](images/desktop-to-uwp/trusted-people-store.png)

5. В корневой папке упакованного приложения дважды щелкните файл пакета приложения для Windows.

   ![Файл пакета приложения для Windows](images/desktop-to-uwp/windows-app-package.png)

6. Установите приложение, нажав кнопку **Установить**.

   ![Кнопка "Установить"](images/desktop-to-uwp/install.png)


## <a name="modify-the-packaged-app"></a>Изменение упакованного приложения

Скорее всего, вы будете вносить изменения в упакованное приложение, чтобы устранить ошибки, добавить визуальные ресурсы или улучшить приложение с помощью современных функций, таких как живые плитки.

После внесения изменений запускать преобразователь повторно не требуется. Можно переупаковать приложение с помощью средства MakeAppx и файла appxmanifest.xml, созданного для вашего приложения преобразователем DAC. См. раздел [Создание пакета приложений для Windows](desktop-to-uwp-manual-conversion.md#make-appx).

> [!NOTE]
> Если вы изменили параметры реестра, заданные вашим установщиков, необходимо повторно запустить Desktop App Converter, чтобы восстановить эти изменения.

**Видео**

|Изменение и переупаковка выходных файлов |Демонстрация: изменение и переупаковка выходных файлов|
|---|---|
|<iframe src="https://mva.microsoft.com/en-US/training-courses-embed/developers-guide-to-the-desktop-bridge-17373/Video-Modifying-and-Repackaging-Output-from-Desktop-App-Converter-OwpAJ3WhD_6706218965" width="426" height="472" allowFullScreen frameBorder="0"></iframe>|<iframe src="https://mva.microsoft.com/en-US/training-courses-embed/developers-guide-to-the-desktop-bridge-17373/Demo-Modify-Output-from-Desktop-App-Converter-gEnsa3WhD_8606218965" width="426" height="472" allowFullScreen frameBorder="0"></iframe>|

В следующих двух разделах описываются несколько дополнительных исправлений, которые могут потребоваться для упакованного приложения.

### <a name="delete-unnecessary-files-and-registry-keys"></a>Удаление ненужных файлов и разделов реестра

Desktop App Converter использует очень консервативный подход к фильтрации файлов и системного шума в контейнере.

При желании можно просмотреть папку VFS и удалить все файлы, которые не требуются вашему установщику.  Кроме того, вы можете просмотреть содержимое файла Reg.dat и удалить все разделы, которые не установлены или не требуются вашему приложению.

### <a name="fix-corrupted-pe-headers"></a>Исправление поврежденных PE-заголовков

В процессе преобразования DesktopAppConverter автоматически запускает PEHeaderCertFixTool, чтобы исправить все поврежденные PE-заголовки. Но вы также можете запустить PEHeaderCertFixTool для пакета приложения UWP для Windows, свободных файлов или определенного двоичного файла. Вот пример:

```CMD
PEHeaderCertFixTool.exe <binary file>|<.appx package>|&lt;folder> [/c] [/v]
 /c   -- check for corrupted certificate but do not fix (optional)
 /v   -- verbose (optional)
example1: PEHeaderCertFixTool app.exe
example2: PEHeaderCertFixTool c:\package.appx /c
example3: PEHeaderCertFixTool c:\myapp /c /v
```

## <a name="known-issues-and-disclosures"></a>Известные проблемы и нарушения конфиденциальности

### <a name="known-issues-and-workarounds"></a>Известные проблемы и обходные решения

Рассмотрим некоторые известные проблем и способы их устранения, которые вы можете попробовать.

#### <a name="ecreatingisolatedenvfailed-an-estartingisolatedenvfailed-errors"></a>Ошибки E_CREATING_ISOLATED_ENV_FAILED an E_STARTING_ISOLATED_ENV_FAILED    

Если вы получили какую-либо из этих ошибок, убедитесь, что вы используете правильный базовый образ из [центра загрузки](https://aka.ms/converterimages).
Если вы используете правильный базовый образ, попробуйте выполнить команду ``-Cleanup All``.
Если это не поможет устранить проблему, отправьте ваши журналы по адресу converter@microsoft.com, чтобы мы могли их изучить.

#### <a name="new-containernetwork-the-object-already-exists-error"></a>Ошибка "New-ContainerNetwork: объект уже существует"

Эта ошибка может возникнуть при установке нового базового образа. Это происходит, если на вашем компьютере для разработки, на котором ранее был установлен Desktop App Converter, есть тестируемая возможность, предназначенная для участников программы предварительной оценки Windows.

Чтобы решить эту проблему, попробуйте выполнить команду `Netsh int ipv4 reset` из командной строки с повышенными привилегиями, а затем перезагрузите компьютер.

#### <a name="your-net-app-is-compiled-with-the-anycpu-build-option-and-fails-to-install"></a>Приложение .NET скомпилировано с использованием параметра сборки "AnyCPU", и его установка завершается сбоем

Это может произойти, если главный исполняемый файл или некая зависимость были размещены где-то в иерархии папок **Program Files** или **Windows\System32**.

Чтобы решить эту проблему, попробуйте использовать установщик рабочего стола определенной архитектуры (32-разрядный или 64-разрядный), чтобы создать пакет приложения для Windows.

#### <a name="publishing-public-side-by-side-fusion-assemblies-wont-work"></a>Публикация общедоступных параллельных сборок Fusion будет невозможна.

 В ходе процесса установки приложение может публиковать параллельные общедоступные сборки Fusion, которые являются доступными для любого другого процесса. Во время создания контекста активации процесса эти сборки извлекаются системным процессом с именем CSRSS.exe. Когда эта процедура выполняется для преобразованного процесса, будет происходить сбой процессов создания контекста активации и загрузки модулей этих сборок. Параллельные сборки Fusion регистрируются в следующих местах:
  + Реестр: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SideBySide\Winners`
  + Файловая система: %windir%\\SideBySide

Это известное ограничение, и в настоящее время решения этой проблемы не существует. Несмотря на сказанное, входящие сборки, такие как ComCtl, поставляются вместе с операционной системой, поэтому указание зависимости от них является безопасным.

#### <a name="error-found-in-xml-the-executable-attribute-is-invalid---the-value-myappexe-is-invalid-according-to-its-datatype"></a>В XML обнаружена ошибка. Атрибут "Executable" недействителен: значение "MyApp.EXE" недействительно с точки зрения его типа данных

Эта проблема может произойти, если исполняемые файлы в вашем приложении имеют расширение **. EXE**, написанное прописными буквами. Несмотря на то что регистр расширения не должен влиять на работу вашего приложения, он может привести к возникновению этой ошибки в DAC.

Чтобы решить эту проблему, попробуйте во время упаковки указать флаг **-AppExecutable** и использовать расширение основного исполняемого файла, записанное в нижнем регистре (например, MYAPP.exe).    Либо вы можете изменить регистр всех исполняемых файлов в вашем приложении с нижнего на верхний (например, из exe в EXE).


### <a name="telemetry-from-desktop-app-converter"></a>Телеметрия Desktop App Converter

Desktop App Converter может собирать сведения о вас и об используемом вами программном обеспечении и отправлять эти данные в Майкрософт. Подробнее о процессе сбора данных корпорацией Майкрософт и их использовании в документации по продуктам см. в [заявлении о конфиденциальности корпорации Майкрософт](http://go.microsoft.com/fwlink/?LinkId=521839). Вы соглашаетесь выполнять требования всех применимых положений заявления о конфиденциальности корпорации Майкрософт.

По умолчанию для Desktop App Converter телеметрия будет включена. Добавьте следующий раздел реестра для настройки телеметрии:  

```cmd
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DesktopAppConverter
```
+ Добавьте или измените значение *DisableTelemetry* с помощью DWORD со значением 1.
+ Для включения телеметрии удалите раздел или задайте значение 0.

### <a name="language-support"></a>Языковая поддержка

Desktop App Converter не поддерживает Юникод, поэтому в нем нельзя использовать символы китайского языка или символы, отличные от набора ASCII.

## <a name="next-steps"></a>Следующие шаги

**Запуск приложения / поиск и устранение проблем**

См. [Запуск, отладка и тестирование упакованного классического приложения (мост для классических приложений)](desktop-to-uwp-debug.md)

**Распространение вашего приложения**

См. [Распространение упакованного классического приложения (мост для классических приложений)](desktop-to-uwp-distribute.md)

**Поиск ответов на конкретные вопросы**

Наша команда следит за этими [тегами StackOverflow](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge).

**Оставьте отзыв об этой статье**

Используйте раздел комментариев ниже.
