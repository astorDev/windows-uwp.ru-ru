---
description: Код, интегрирующийся с устройством и его датчиками, включает ввод от пользователя и вывод к нему.
title: Перенос WindowsPhone Silverlight в UWP для ввода-вывода, устройств и моделей приложений "
ms.assetid: bf9f2c03-12c1-49e4-934b-e3fa98919c53
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 6ef1814443b3831e514eafb3f5a0c58b7703126b
ms.sourcegitcommit: c01c29cd97f1cbf050950526e18e15823b6a12a0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2018
ms.locfileid: "8696171"
---
#  <a name="porting-windowsphone-silverlight-to-uwp-for-io-device-and-app-model"></a>Перенос WindowsPhone Silverlight в UWP для ввода-вывода, устройств и модели приложения


Предыдущий раздел назывался [Перенос XAML и пользовательского интерфейса](wpsl-to-uwp-porting-xaml-and-ui.md).

Код, интегрирующийся с устройством и его датчиками, включает ввод от пользователя и вывод к нему. Он может также включать обработку данных. Но в целом этот код не считается уровнем пользовательского интерфейса или уровнем данных. Этот код включает интеграцию с контроллером вибрации, акселерометром, гироскопом, микрофоном и динамиками (которые могут пересекаться с распознаванием речи и синтезом), (географическим) положением и модальностями ввода, такими как сенсорный ввод, мышь, клавиатура и перо.

## <a name="application-lifecycle-process-lifetime-management"></a>Жизненный цикл приложения (управление жизненным циклом процесса)

Приложение WindowsPhone Silverlight содержит код для сохранения и восстановления состояния приложения и его состояния представления для поддержки возможности полного удаления и последующей повторной активации. Жизненный цикл приложений универсальной платформы Windows (UWP) имеет очень жизненному циклу с приложений WindowsPhone Silverlight, так как оба они разработаны с той же целью — развертывания ресурсов, доступных плана пользователь выбрал иметь в наличии переднего плана в любой момент. Вы увидите, что код достаточно легко адаптируется к новой системе.

**Примечание**  при нажатии кнопки **Назад** оборудования автоматически завершает приложение WindowsPhone Silverlight. Нажатие аппаратной кнопки **Назад** на мобильном устройстве *не* завершает автоматически работу приложения UWP. Вместо этого оно будет приостановлено, а затем его можно будет закрыть. Но эти детали понятны для приложения, которое соответствующим образом отвечает на события жизненного цикла приложения.

Окно между моментом— это период между временем, когда приложение становится неактивным, и вызовом системного события приостановки. Для приложения UWP отсутствует окно между моментом; событие приостановки возникает, когда приложение становится неактивным.

Подробнее см. в разделе [Жизненный цикл приложения](https://msdn.microsoft.com/library/windows/apps/mt243287).

## <a name="camera"></a>Камера

Код захвата с камеры WindowsPhone Silverlight использует классы **Microsoft.Devices.Camera**, **Microsoft.Devices.PhotoCamera**или **Microsoft.Phone.Tasks.CameraCaptureTask** . Чтобы перенести этот код в UWP, можно использовать класс [**MediaCapture**](https://msdn.microsoft.com/library/windows/apps/br241124). Пример кода приведен в разделе [**CapturePhotoToStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/hh700836). Этот метод позволяет записать фотографию в файл хранилища, и он требует **микрофон** и **веб-камера**[**возможностей устройств**](https://msdn.microsoft.com/library/windows/apps/dn934747) для задания в манифесте пакета приложения.

Другой вариант — класс [**CameraCaptureUI**](https://msdn.microsoft.com/library/windows/apps/br241030) , который также требует **микрофон** и **веб-камера**[**возможности устройства**](https://msdn.microsoft.com/library/windows/apps/dn934747).

Приложения-объективы не поддерживаются для приложений UWP.

## <a name="detecting-the-platform-your-app-is-running-on"></a>Определение платформы, на которой работает приложение

Способ мышления о том, предназначенных для приложения меняется вместе с Windows10. Новая модель подразумевает, что приложение предназначено для универсальной платформы Windows (UWP) и работает на всех устройствах Windows. Оно может активировать возможности, поддерживаемые только определенным семейством устройств. При необходимости приложение также может быть предназначено только для одного или нескольких семейств устройств. Подробнее о семействах устройств и выборе нужного семейства устройств см. в [Руководстве по приложениям UWP](https://msdn.microsoft.com/library/windows/apps/dn894631).

**Примечание**  мы рекомендуем не использовать операционной системы или семейства устройств для определения наличия функций. Определение текущей операционной системы или семейства устройств — обычно не лучший способ определить наличие указанной функции ОС или семейства устройств. Вместо обнаружения ОС или семейства устройств (и номера версии), проверьте наличие самой функции (см. раздел [Условная компиляция и адаптивный код](wpsl-to-uwp-porting-to-a-uwp-project.md)). Если вам необходимо требовать использование определенной операционной системы или семейства устройств, убедитесь, что определяется минимально поддерживаемая версия, а не проверяйте наличие именно этой версии.

Чтобы адаптировать пользовательский интерфейс приложения к различным устройствам, мы рекомендуем использовать несколько методов. Продолжайте использовать элементы с автоматически устанавливаемым размером и динамические панели макета, как и раньше. В разметке XAML продолжайте использовать размеры в эффективных пикселях (ранее—пиксели просмотра), чтобы пользовательский интерфейс адаптировался к различным разрешениям и коэффициентам масштабирования (см. раздел [Просмотр/эффективные пиксели, расстояние от экрана и коэффициенты масштабирования](wpsl-to-uwp-porting-xaml-and-ui.md)). Кроме того, используйте адаптивные триггеры и параметры диспетчера визуальных состояний для адаптации пользовательского интерфейса к размеру окна (см. [Руководство по приложениям UWP](https://msdn.microsoft.com/library/windows/apps/dn894631)).

Однако если вы используете сценарий, где обнаружение семейства устройства неизбежно, вы можете сделать это. В этом примере мы используем класс [**AnalyticsVersionInfo**](https://msdn.microsoft.com/library/windows/apps/dn960165) для перехода на страницу, предназначенную для семейства мобильных устройств, если это возможно, а в противном случае возвращаемся на страницу по умолчанию.

```csharp
   if (Windows.System.Profile.AnalyticsInfo.VersionInfo.DeviceFamily == "Windows.Mobile")
        rootFrame.Navigate(typeof(MainPageMobile), e.Arguments);
    else
        rootFrame.Navigate(typeof(MainPage), e.Arguments);
```

Приложение может также определить семейство устройств, на котором оно работает, на основе применяемых факторов выбора ресурсов. В следующем примере показано, как сделать это императивно, а в разделе [**ResourceContext.QualifierValues**](https://msdn.microsoft.com/library/windows/apps/br206071) описан более типичный вариант использования класса для загрузки ресурсов для определенного семейства устройств на основе фактора семейства устройств.

```csharp
var qualifiers = Windows.ApplicationModel.Resources.Core.ResourceContext.GetForCurrentView().QualifierValues;
string deviceFamilyName;
bool isDeviceFamilyNameKnown = qualifiers.TryGetValue("DeviceFamily", out deviceFamilyName);
```

См. также раздел [Условная компиляция и адаптивный код](wpsl-to-uwp-porting-to-a-uwp-project.md).

## <a name="device-status"></a>Состояние устройства

Приложение WindowsPhone Silverlight можно использовать класс **Microsoft.Phone.Info.DeviceStatus** , чтобы получить сведения об устройстве, на котором выполняется приложение. Если нет прямого эквивалента UWP пространства имен **Microsoft.Phone.Info**, ниже указаны некоторые свойства и события, которые можно использовать в приложении UWP вместо вызовов к членам класса **DeviceStatus**.

| WindowsPhoneSilverlight                                                               | UWP                                                                                                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Свойства **ApplicationCurrentMemoryUsage** и **ApplicationCurrentMemoryUsageLimit** | Свойства [**MemoryManager.AppMemoryUsage**](https://msdn.microsoft.com/library/windows/apps/dn633832) и [**AppMemoryUsageLimit**](https://msdn.microsoft.com/library/windows/apps/dn633836)                                                                                                                                    |
| Свойство **ApplicationPeakMemoryUsage**                                                 | Используйте инструменты профилирования памяти в Visual Studio. Подробнее см. в разделе [Анализ использования памяти](http://msdn.microsoft.com/library/windows/apps/dn645469.aspx).                                                                                                                                                                          |
| Свойство **DeviceFirmwareVersion**                                                      | Свойство [**EasClientDeviceInformation.SystemFirmwareVersion**](https://msdn.microsoft.com/library/windows/apps/dn608144) (только семейство настольных устройств)                                                                                                                                                                             |
| Свойство **DeviceHardwareVersion**                                                      | Свойство [**EasClientDeviceInformation.SystemHardwareVersion**](https://msdn.microsoft.com/library/windows/apps/dn608145) (только семейство настольных устройств)                                                                                                                                                                             |
| Свойство **DeviceManufacturer**                                                         | Свойство [**EasClientDeviceInformation.SystemManufacturer**](https://msdn.microsoft.com/library/windows/apps/hh701398) (только семейство настольных устройств)                                                                                                                                                                                |
| Свойство **DeviceName**                                                                 | Свойство [**EasClientDeviceInformation.SystemProductName**](https://msdn.microsoft.com/library/windows/apps/hh701401) (только семейство настольных устройств)                                                                                                                                                                                 |
| Свойство **DeviceTotalMemory**                                                          | Нет эквивалента                                                                                                                                                                                                                                                                                                                      |
| Свойство **IsKeyboardDeployed**                                                         | Нет эквивалента. Это свойство содержит сведения об аппаратных клавиатурах для мобильных устройств, которые обычно не используются.                                                                                                                                                                                                        |
| Свойство **IsKeyboardPresent**                                                          | Нет эквивалента. Это свойство содержит сведения об аппаратных клавиатурах для мобильных устройств, которые обычно не используются.                                                                                                                                                                                                        |
| Событие **KeyboardDeployedChanged**                                                       | Нет эквивалента. Это свойство содержит сведения об аппаратных клавиатурах для мобильных устройств, которые обычно не используются.                                                                                                                                                                                                        |
| Свойство **PowerSource**                                                                | Нет эквивалента                                                                                                                                                                                                                                                                                                                      |
| Событие **PowerSourceChanged**                                                            | Обрабатывайте событие [**RemainingChargePercentChanged**](https://msdn.microsoft.com/library/windows/apps/jj207240) (только семейство мобильных устройств). Событие возникает, когда значение свойства [**RemainingChargePercent**](https://msdn.microsoft.com/library/windows/apps/jj207239) (только для семейства мобильных устройств) сокращается на 1%. |

## <a name="location"></a>Расположение

Если приложение, объявляющее определение расположения в его манифесте пакета приложения выполняется в Windows10, система попросит у пользователя согласие. Поэтому, если ваше приложение отображает собственный настраиваемый запрос на продолжение или если оно предоставляет переключатель включения и выключения, следует удалить этот запрос, чтобы пользователь получал только один запрос.

## <a name="orientation"></a>Orientation

Эквивалентом для приложений UWP свойств **PhoneApplicationPage.SupportedOrientations** и **Orientation** является элемент [**uap:InitialRotationPreference**](https://msdn.microsoft.com/library/windows/apps/dn934798) в манифесте пакета приложений. Выберите вкладку **Приложение**, если она еще не выбрана, и установите один или несколько флажков в разделе **Поддерживаемые ориентации** для регистрации своих предпочтений.

Рекомендуется разрабатывать такой пользовательский интерфейс приложения UWP, который будет иметь превосходный вид в любой ориентации и при любом размере экрана. Подробнее об этом см. в разделе [Перенос для форм-факторов и взаимодействия с пользователем](wpsl-to-uwp-form-factors-and-ux.md), который следует за следующим разделом.

Следующий раздел посвящен [переносу уровней бизнеса и данных](wpsl-to-uwp-business-and-data.md).

