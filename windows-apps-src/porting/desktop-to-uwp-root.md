---
author: awkoren
Description: "Подготовьте ваше классическое приложение для Windows (например, Win32, WPF и Windows Forms) к преобразованию в приложение для универсальной платформы Windows (UWP) с помощью расширений для преобразования классических приложений."
Search.Product: eADQiWindows 10XVcnh
title: "Преобразование классического приложения в приложение для универсальной платформы Windows (UWP)"
ms.sourcegitcommit: 37d4c8ef6178fe78c7333c47848177b5185c6d61
ms.openlocfilehash: 16d75ebd2499e56af742c1c9994fd92cc320c22b

---

# Преобразование классического приложения в приложение для универсальной платформы Windows (UWP)

\[Некоторые сведения относятся к предварительным версиям продуктов, в которые перед коммерческим выпуском могут быть внесены существенные изменения. Майкрософт не дает никаких гарантий, прямых или косвенных, в отношении указанной здесь информации.\]

Подготовьте ваше классическое приложение для Windows (например, Win32, WPF и Windows Forms) к преобразованию в приложение для универсальной платформы Windows (UWP) с помощью расширений для преобразования классических приложений.

## Преимущества преобразования приложений в приложения UWP

UWP, используя расширения для преобразования классических приложений, позволяет преобразовывать классические приложения (например, Win32, Windows Forms и WPF) или игры в приложения или игры для универсальной платформы Windows (UWP). Дополнительные сведения см. в разделе [Руководство по приложениям UWP](https://msdn.microsoft.com/library/windows/apps/dn894631.aspx). После преобразования ваше классическое приложение упаковывается, обслуживается и разворачивается в виде пакета приложения UWP (.appx или an .appxbundle) и его целью является классическая версия Windows 10.

Механизм преобразования классических приложений в пакеты UWP делится на два этапа. На первом этапе преобразователь классических приложений использует имеющиеся двоичные файлы и повторно упаковывает их в качестве пакета UWP. Ваш код остается прежним, он просто по-другому упаковывается. На втором этапе используются технологии среды выполнения, содержащиеся в юбилейном обновлении Windows 10, которые позволяют исполняемым файлам пакета UWP выполняться в качестве файлов с полным доверием, а не в контейнере приложения. Этот механизм также присваивает преобразованному приложению идентификатор пакета, который необходим для использования некоторых API-интерфейсов UWP.

Вот некоторые из преимуществ преобразования классического приложения.

* Процедура установки вашего приложения становится значительно удобнее для пользователей. Вы можете разворачивать такие приложения на компьютерах, использующих загрузку неопубликованного приложения (см. [Загрузка неопубликованных бизнес-приложений в Windows 10](https://technet.microsoft.com/library/mt269549.aspx)), и после их удаления не остается каких-либо остаточных файлов. В долгосрочной перспективе вы также сможете опубликовать свое приложение в Магазине Windows.

* Поскольку ваше преобразованное приложение обладает идентификатором пакета, вы сможете вызывать дополнительные API-интерфейсы UWP даже из раздела с полным доверием.

* Вы можете на свое усмотрение добавлять в пакет приложения возможности UWP, такие как пользовательский интерфейс на языке XAML, обновления живых плиток, фоновые задачи UWP, службы приложений и многое другое. Все возможности, доступные любому другому приложению UWP, также доступны для вашего приложения.

* Если вы решите переместить все возможности своего приложения из раздела с полным доверием приложения в раздел с контейнером приложения, то ваше приложение сможет выполняться на любом устройстве с Windows 10.

* Будучи приложением UWP, ваше приложение обладает всеми возможностями классического приложения. Приложение взаимодействует с виртуализированным представлением реестра и файловой системы, которое неотличимо от фактических реестра и файловой системы.

* Ваше приложение может взаимодействовать со встроенными средствами лицензирования и автоматического обновления Магазина Windows Автоматическое обновление — очень надежный и эффективный механизм, поскольку загружаются только измененные части файлов.

## Подготовка классического приложения для преобразования в приложение UWP
Для подготовки приложения к процессу преобразования требуется мало усилий. Не забывайте, что Магазин Windows управляет вместо вас лицензированием и автоматическим обновлением, поэтому эти возможности можно исключить из вашей базы кода. Если любая из перечисленных ниже ситуаций применима к вашему приложению, перед преобразованием необходимо устранить эту проблему.

+ __Приложение использует версию .NET ниже, чем 4.6.1__. Поддерживается только .NET версии 4.6.1. Перед преобразованием приложение необходимо настроить для работы с .NET 4.6.1. 

+ __Ваше приложение всегда запускается с повышенными привилегиями безопасности__. Ваше приложение должно работать при его выполнении в качестве текущего пользователя. Пользователи, устанавливающие ваше приложение из Магазина Windows, могут не являться системными администраторами, поэтому необходимость выполнения вашего приложения с более высокими привилегиями означает, что оно будет работать неправильно для обычных пользователей.

+ __Ваше приложение нуждается в драйвере, работающем в режиме ядра, или в службе Windows__. Мост подходит для приложения, но он не поддерживает драйвер, работающий в режиме ядра, или службу Windows, которая должна работать с правами учетной записи системы. Вместо службы Windows используйте [фоновую задачу](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task).

+ __Модули вашего приложения загружаются во внутрипроцессном режиме в процессы, которые отсутствуют в пакете AppX__. Это запрещено и означает, что внутрипроцессные расширения, такие как [расширения оболочки](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx) не поддерживаются. Но если у вас есть два приложения в одинаковом пакете, вы можете настроить межпроцессное взаимодействие между ними.

+ __Ваше приложение использует пользовательский идентификатор пользовательской модели (AUMID) приложения__. Если ваш процесс вызывает элемент [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx), чтобы задать собственный AUMID, то этот процесс может использовать только тот AUMID, который был сформирован для него средой модели приложения/пакетом AppX. Вы не можете определять пользовательские AUMID.

+ __Ваше приложение изменяет куст реестра HKEY_LOCAL_MACHINE (HKLM)__. Любая попытка приложения создать ключ HKLM или открыть такой ключ для изменения в результате приведет к сбою в виде отказа в доступе. Не забывайте, что у вашего приложения есть собственное закрытое виртуализированное представление реестра, поэтому в такой ситуации понятие куста реестра на уровне пользователя и компьютера (чем является HKLM) неприменимо. Потребуется найти другой способ достичь того, чего требовалось при использовании HKLM, например запись в HKEY_CURRENT_USER (HKCU).

+ __Ваше приложение использует подраздел реестра ddeexec в качестве средства для запуска другого приложения__. Вместо этого используйте один из обработчиков команды DelegateExecute в соответствии с настройками различных расширений Activatable* в вашем [манифесте пакета приложения](https://msdn.microsoft.com/library/windows/apps/br211474.aspx).

+ __Ваше приложение выполняет запись в папку AppData с намерением поделиться данными с другим приложением__. После преобразования AppData перенаправляется в локальное хранилище данных приложения, являющееся частным хранилищем для каждого приложения UWP. Используйте другие средства межпроцессного обмена данными. Подробнее: [Хранение и извлечение параметров и прочих данных приложения](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data).

+ __Ваше приложение выполняет запись в папку установки приложения__. Например, ваше приложение выполняет запись в файл журнала, который вы поместили в тот же каталог, что и файл exe. Эта операция не поддерживается, поэтому потребуется найти другое расположение, например, локальное хранилище данных приложения.

+ __Для установки приложения требуется участие пользователя__. Ваш установщик приложений должен запускаться в автоматическом режиме, а также устанавливать все свои дополнительные компоненты, которые не активированы по умолчанию в чистом образе ОС.

+ __Ваше приложение использует Current Working Directory (текущий рабочий каталог)__. Во время выполнения ваше преобразованное приложение не получит тот же рабочий каталог, который был ранее указан для вашего ярлыка .LNK на рабочем столе. Необходимо изменить CWD во время выполнения, если у вашего приложения должен быть правильный каталог, чтобы оно работало должным образом.

+ __Ваше приложение запрашивает доступ UIAccess__. Если приложение задает значение `UIAccess=true` элементу `requestedExecutionLevel` манифеста UAC, то преобразование в UWP не поддерживается на данный момент. Подробнее см. в разделе [Обзор системы безопасности модели автоматизации пользовательского интерфейса](https://msdn.microsoft.com/library/ms742884.aspx).

+ __Приложение предоставляет объекты модели COM или сборки GAC для использования другими процессами__. В текущем выпуске приложение не может предоставлять объекты модели COM или сборки GAC для использования процессами, возникающими в результате запуска исполняемых файлов, которые являются внешними по отношению к пакету AppX. Процессы из пакета могут регистрировать и использовать объекты модели COM и сборки GAC обычным образом, но они не будут видны извне. Это означает, что сценарии межпрограммного взаимодействия (например, OLE) не будут работать при их вызове внешними процессами. 

+ __Приложение связывается с библиотеками среды выполнения C неподдерживаемым способом__. Библиотека среды выполнения C/C++ Майкрософт предоставляет процедуры для программирования в среде операционной системы Microsoft Windows. Эти процедуры автоматизируют выполнение многих распространенных задач программирования, которые не предоставляются языками C и C++. Если ваше приложение использует библиотеку среды выполнения C/C++, необходимо убедиться, что она связана поддерживаемом способом. 
    
    Visual Studio 2015 поддерживает как динамическое связывание, чтобы код мог использовать общие файлы DLL, так и статическое связывание для связывания библиотеки непосредственно с кодом, до текущей версии CRT. По возможности мы рекомендуем использовать в приложениях динамическое связывание Visual Studio 2015. 

    Поддержка различных типов связывания зависит от версии Visual Studio. Подробности см. в следующей таблице: 

    <table>
    <th>Версия Visual Studio</td><th>Динамическое связывание</th><th>Статическое связывание</th></th>
    <tr><td>2005 (VC 8)</td><td>Не поддерживается</td><td>Поддерживается</td>
    <tr><td>2008 (VC 9)</td><td>Не поддерживается</td><td>Поддерживается</td>
    <tr><td>2010 (VC 10)</td><td>Поддерживается</td><td>Поддерживается</td>
    <tr><td>2012 (VC 11)</td><td>Поддерживается</td><td>Не поддерживается</td>
    <tr><td>2013 (VC 12)</td><td>Поддерживается</td><td>Не поддерживается</td>
    <tr><td>2015 (VC 14)</td><td>Поддерживается</td><td>Поддерживается</td>
    </table>
    
    Примечание. Во всех случаях связывание необходимо выполнять с самой последней общедоступной библиотекой CRT.

+ __Приложение устанавливает и загружает сборки из параллельной папки Windows (SxS)__. Например, в вашем приложении используются библиотеки VC8 или VC9 среды выполнения C и они динамически связываются из папки Windows SxS, то есть в коде используются общие файлы DLL из общей папки. Такой способ связывания не поддерживается. Необходимо связать их статически, то есть связать с распространяемыми файлами библиотеки непосредственно в самом коде.


## В этом разделе

| Раздел | Описание |
|-------|-------------|
| [Обзор преобразователя классических приложений (Project Centennial)](desktop-to-uwp-run-desktop-app-converter.md) | В разделе описывается процесс запуска преобразователя классических приложений. Возможно, вам не потребуется прилагать много усилий (скорее даже наоборот) для подготовки вашего приложения к процессу преобразования. |
| [Ручное преобразование классического приложения для Windows в приложение для универсальной платформы Windows (UWP)](desktop-to-uwp-manual-conversion.md) | Создание манифеста пакета приложения вручную. |
| [Развертывание и отладка преобразованного приложения UWP](desktop-to-uwp-deploy-and-debug.md) | Этот раздел содержит информацию, которая поможет вам успешно разворачивать и выполнять отладку своих приложений после их преобразования. Этот раздел также подойдет вам, если вам интересны какие-либо подробные сведения о расширениях для преобразования классических приложений. |
| [Примеры кода для преобразования классических приложений в приложения UWP](https://github.com/Microsoft/DesktopBridgeToUWP-Samples) | Примеры кода на GitHub, демонстрирующие возможности преобразованных приложений. |



<!--HONumber=Jun16_HO4-->


