---
author: rido-min
Description: This guide explains how to configure your Visual Studio Solution to optimize the application binaries with native images.
Search.Product: eADQiWindows 10XVcnh
title: Оптимизируйте свои приложений .NET рабочего стола с помощью собственных образов
ms.author: normesta
ms.date: 06/11/2018
ms.topic: article
keywords: Windows 10, машинный образ компилятора
ms.localizationpriority: medium
ms.openlocfilehash: 231d5aa895cb4cf63ade01660df61e32424e67c7
ms.sourcegitcommit: e814a13978f33654d8e995584f4b047cb53e0aef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/05/2018
ms.locfileid: "6039385"
---
# <a name="optimize-your-net-desktop-apps-with-native-images"></a>Оптимизируйте свои приложений .NET рабочего стола с помощью собственных образов

> [!NOTE]
> Некоторые сведения относятся к предварительным версиям продуктов, в которые перед коммерческим выпуском могут быть внесены существенные изменения. Майкрософт не дает никаких гарантий, явных или подразумеваемых, в отношении предоставленной здесь информации.

Можно сократить время запуска приложения .NET Framework путем предварительной компиляции двоичных файлов. Можно использовать эту технологию на больших приложений, которые упаковываются и распространяются через магазин Windows. В некоторых случаях мы всему значительное улучшение производительности 20%. Дополнительные сведения об этой технологии в [Технический обзор](https://github.com/dotnet/coreclr/blob/master/Documentation/botr/readytorun-overview.md).

Мы выпустили с предварительной версией компилятора машинный образ в качестве [пакета NuGet](https://www.nuget.org/packages/Microsoft.DotNet.Framework.NativeImageCompiler). Этот пакет можно применять для любого приложения .NET Framework, которое предназначено для .NET Framework версии 4.6.2 или более поздней версии. Этот пакет добавляет этап сборки post, включающий собственных полезные данные для всех двоичных файлов, используемых приложением. Это оптимизированный полезных данных будет загружаться при запуске приложения, в .NET 4.7.2 и более поздних версий во время предыдущих версий по-прежнему будет загружать код MSIL.

Платформа [.NET framework 4.7.2](https://blogs.msdn.microsoft.com/dotnet/2018/04/30/announcing-the-net-framework-4-7-2/) входит в [Центр обновления Windows 10 апреля 2018 г](https://blogs.windows.com/windowsexperience/2018/04/30/how-to-get-the-windows-10-april-2018-update/). Можно также установить эту версию .NET Framework на ПК, запускать Windows 7 + и Windows Server 2008 R2 +.

> [!IMPORTANT]
> Если вы хотите создавать собственные изображения для вашего приложения, упакованного с проект упаковки приложения Windows, убедитесь, что значение целевой платформы Минимальная версия проекта Юбилейное обновление Windows.

## <a name="how-to-produce-native-images"></a>Как для создания собственных образов

Следуйте этим инструкциям для настройки проектов.

1. Настройка целевой версии .NET framework, как 4.6.2 или выше

2. Настройка целевой платформы в качестве x86 или x64 

3. Добавление пакетов NuGet.

4. Создание сборки выпуска.

## <a name="configure-the-target-framework-as-462-or-above"></a>Настройка целевой версии .NET framework, как 4.6.2 или выше

Чтобы настроить проект для целевой платформы .NET Framework 4.6.2 вам понадобится средства разработки .NET Framework 4.6.2 или более поздней версии. Эти средства доступны через установщик Visual Studio как необязательных компонентов в разделе рабочая нагрузка рабочего стола разработки .NET:

![Установите .NET 4.6.2 средств разработки](images/desktop-to-uwp/install-4.6.2-devpack.png)

Кроме того вы можете получить пакеты разработчиков .NET из:[https://www.microsoft.com/net/download/visual-studio-sdks](https://www.microsoft.com/net/download/visual-studio-sdks)

## <a name="configure-the-target-platform-as-x86-or-x64"></a>Настройка целевой платформы в качестве x86 или x64

Компилятор машинный образ оптимизирует код для данной платформы. Чтобы использовать его, необходимо настроить приложение для выбора одного конкретного платформы, например x86 или x64.

При наличии нескольких проектов в вашем решении, будет компилироваться как x86 или x64 имеет только запись точки проект (скорее всего проекта исполняемого файла). Дополнительные двоичные файлы, указанные в основном проекте будут обрабатываться с архитектурой, указанной в основном проекте, даже если они компилируются как "anycpu".

Чтобы настроить проект таким образом:

1. Щелкните правой кнопкой мыши решение, а затем выберите **Configuration Manager**.

2. Выберите **< новые... >** в **платформе** раскрывающегося меню рядом с именем проекта, который создает исполняемый файл.

3. В диалоговом окне **Новая платформа проекта** убедитесь, что в раскрывающемся списке **Копировать параметры из** присвоено **Любой ЦП**.

![Настройка x86](images/desktop-to-uwp/configure-x86.png)

Повторите этот шаг для `Release/x64` Если вы хотите, чтобы создают x64 двоичных файлов.

>[!IMPORTANT]
> Конфигурация AnyCPU не поддерживается с помощью компилятора машинный образ.

## <a name="add-the-nuget-packages"></a>Добавление пакетов NuGet

Компилятор машинный образ предоставляется в виде пакета NuGet, который необходимо добавить в проект Visual Studio, который создает исполняемый файл. Обычно это проект Windows Forms или WPF. Для этого можно используйте следующую команду PowerShell.

```PS
PM> Install-Package Microsoft.DotNet.Framework.NativeImageCompiler -Version 0.0.1-prerelease-00002  -PRE
```

> [!NOTE]
> Предварительный просмотр пакетов публикуются в NuGet.org как списке нет. Не вы найдете их с браузера NuGet.org или с помощью диспетчера пакетов пользовательского интерфейса в Visual Studio. Тем не менее, их можно установить из консоли диспетчера пакетов и когда вы восстановление с другого компьютера. Мы сделаем пакеты полностью доступны при мы опубликуем первая версия без предварительного просмотра.

## <a name="create-a-release-build"></a>Создание сборки выпуска

Пакет NuGet настраивает проект для запуска дополнительные средства для выпуска сборок. Это средство добавляет машинного кода одинаковые двоичные файлы.
Чтобы убедиться, что средство обработал двоичные файлы, можно просмотреть сборки, выводит данные убедитесь, что он включает сообщение, например такой:

```
Native image obj\x86\Release\\R2R\DesktopApp1.exe generated successfully.
```

## <a name="faq"></a>Вопросы и ответы

**Q. Новые двоичные файлы работают на компьютерах без .NET Framework 4.7.2?**

А. Оптимизированные двоичные файлы преимущества улучшения при работе с .NET Framework 4.7.2. Клиенты под управлением предыдущих версий .NET framework будет загружаться не оптимизированного кода MSIL из двоичного файла.

**Q. Как предоставить отзыв или сообщить о проблемах?**

А. Сообщить о проблеме с помощью средства обратной связи в Visual Studio 2017. [Дополнительные сведения](https://docs.microsoft.com/visualstudio/ide/how-to-report-a-problem-with-visual-studio-2017).

**Q. Что такое влияние добавления образа в машинном коде существующих двоичных файлов**

А. Оптимизированные двоичные файлы содержат управляемый и машинный код, что итоговый файл больше.

**Q. Можно удалить двоичных файлов с помощью этой технологии?**

А. Эта версия содержит Go Live лицензию, которую вы можете использовать уже сегодня.
