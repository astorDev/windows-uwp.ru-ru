---
author: normesta
Description: Test your app for Windows 10 in S mode.
Search.Product: eADQiWindows 10XVcnh
title: Тестирование приложения для Windows на Windows10S.
ms.author: normesta
ms.date: 05/11/2017
ms.topic: article
keywords: Windows 10 S, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 3307506c5cf62d04cd19fbc302ad14bfcedd0045
ms.sourcegitcommit: 753e0a7160a88830d9908b446ef0907cc71c64e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2018
ms.locfileid: "5752769"
---
# <a name="test-your-windows-app-for-windows-10-in-s-mode"></a>Тестирование приложения для Windows 10 в режиме S.

Можно протестировать приложение Windows, чтобы убедиться, что оно будет работать правильно на устройствах под управлением Windows 10 S. На самом деле, если вы планируете опубликовать приложение в Microsoft Store, это необходимо, поскольку таковы обязательные требования Store. Чтобы протестировать приложение, можно применить политику целостности кода Device Guard на устройстве под управлением Windows 10 Pro.

> [!NOTE]
> Устройство, на котором применяется политика целостности кода Device Guard, должно работать под управлением Windows 10 Creators (10.0; сборка 15063) или выше.

Политика целостности кода Device Guard применяет правила, которым должны соответствовать приложения для работы в Windows10S.

> [!IMPORTANT]
>Мы рекомендуем применять эти политики к виртуальной машине, однако если вы хотите применить их к локальному компьютеру, предварительно ознакомьтесь с рекомендациями, приведенными в разделе "Установка политики и перезапуск компьютера" этой статьи.

<a id="choose-policy" />

## <a name="first-download-the-policies-and-then-choose-one"></a>Скачивание политик и выбор одной из них

Скачайте [здесь](https://go.microsoft.com/fwlink/?linkid=849018) политики целостности кода Device Guard.

Затем выберите наиболее подходящую политику. Вот краткая информация по каждой из них.

|Политика |Принудительное применение |Сертификат для подписи |Имя файла |
|--|--|--|--|
|Политика режима аудита |Ведет журнал ошибок / не блокирует |Магазин |SiPolicy_Audit.p7b |
|Политика режима производства |Да |Магазин |SiPolicy_Enforced.p7b |
|Политика режима производства с самозаверяющимися приложениями |Да |Тестовый сертификат AppX  |SiPolicy_DevModeEx_Enforced.p7b |

Мы рекомендуем начать с политики режима аудита. Просмотрите журналы событий целостности кода и используйте эти сведения, чтобы внести изменения в ваше приложение. Затем, когда будете готовы провести финальное тестирование, примените политику режима производства.

Ниже представлена дополнительная информация о каждой политике.

### <a name="audit-mode-policy"></a>Политика режима аудита
В этом режиме ваше приложение работает, даже если оно выполняет задачи, не поддерживаемые в Windows 10 S. Windows регистрирует все исполняемые файлы, которые были бы заблокированы, в журналах событий целостности кода.

Эти журналы можно найти, открыв **Просмотр событий** и перейдя в это расположение: Журналы приложений и служб -> Microsoft -> Windows -> CodeIntegrity -> Operational.

![журналы событий целостности кода](images/desktop-to-uwp/code-integrity-logs.png)

Этот режим безопасен и не помешает запуску системы.

#### <a name="optional-find-specific-failure-points-in-the-call-stack"></a>(Необязательно) Поиск конкретных точек сбоя в стеке вызовов
Чтобы найти в стеке вызовов конкретные точки, в которых возникают блокирующие работу проблемы, добавьте этот раздел реестра, а затем [настройте среду отладки в режиме ядра](https://docs.microsoft.com/windows-hardware/drivers/debugger/getting-started-with-windbg--kernel-mode-#span-idsetupakernel-modedebuggingspanspan-idsetupakernel-modedebuggingspanspan-idsetupakernel-modedebuggingspanset-up-a-kernel-mode-debugging).

|Раздел|Имя|Тип|Значение|
|--|---|--|--|
|HKEY_LOCAL_MACHINE\SYSTEM\CurentControlSet\Control\CI| DebugFlags |REG_DWORD | 1 |


![reg-setting](images/desktop-to-uwp/ci-debug-setting.png)

### <a name="production-mode-policy"></a>Политика режима производства
Данная политика применяет правила целостности кода, согласующиеся с Windows 10 S, поэтому вы можете имитировать работу под управлением этой операционной системы. Это самая строгая политика, и она отлично подходит для проведения финального тестирования производства. В этом режиме на ваше приложение распространяются такие же ограничения, какие на него были бы наложены на устройстве пользователя. Чтобы использовать этот режим, ваше приложения должно быть подписано Microsoft Store.

### <a name="production-mode-policy-with-self-signed-apps"></a>Политика режима производства с самозаверяющимися приложениями
Эта политика аналогична политике режима производства, но она также позволяет запускать продукты, подписанные с помощью тестового сертификата, который входит в этот ZIP-файл. Установите PFX-файл, находящийся в папке **AppxTestRootAgency** этого ZIP-файла. Затем подпишите приложение с его помощью. Так вы сможете быстро выполнить итерацию, не подписывая приложение через Магазин.

Поскольку имя издателя сертификата должно соответствовать имени издателя приложения, вам придется временно изменить значение атрибута **Publisher** элемента **Identity** на "CN=Appx Test Root Agency Ex". Можно вернуть этому атрибуту исходное значение после выполнения тестов.

## <a name="next-install-the-policy-and-restart-your-system"></a>Установка политики и перезапуск компьютера

Мы рекомендуем применять эти политики к виртуальной машине, так как они могут привести к ошибкам при загрузке. Это связано с тем, что данные политики блокируют выполнение кода, не подписанного Microsoft Store, включая драйверы.

Если вы хотите применить эти политики на локальном компьютере, лучше всего начать с политики режима аудита. С ней вы сможете просмотреть журналы событий целостности кода, чтобы убедиться, что при ее принудительном применении не будут заблокированы никакие критичные функции.

Когда будете готовы применить политику, найдите P7B-файл выбранной вами политики, переименуйте его в **SIPolicy.P7B** и сохраните в вашей системе в этом расположении: **C:\Windows\System32\CodeIntegrity\\**.

Затем перезапустите компьютер.

>[!NOTE]
>Чтобы удалить политику из системы, удалите файл .P7B и перезапустите систему.

## <a name="next-steps"></a>Дальнейшие действия

**Поиск ответов на вопросы**

Есть вопросы? Задайте их на Stack Overflow. Наша команда следит за этими [тегами](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge). Вы также можете задать нам вопросы [здесь](https://social.msdn.microsoft.com/Forums/en-US/home?filter=alltypes&sort=relevancedesc&searchTerm=%5BDesktop%20Converter%5D).

**Оставьте отзыв или предложите новые возможности для реализации**

См. раздел [UserVoice](https://wpdev.uservoice.com/forums/110705-universal-windows-platform/category/161895-desktop-bridge-centennial)

**Просмотрите подробную запись в блоге, размещенную нашей группой консультантов по приложениям**

См. [Перенос и тестирование классических приложений на Windows 10 S с помощью моста для классических приложений](https://blogs.msdn.microsoft.com/appconsult/2017/06/15/porting-and-testing-your-classic-desktop-applications-on-windows-10-s-with-the-desktop-bridge/).

**Узнайте о средствах, которые упрощают тестирование для Windows в режиме S**

См. [Распаковка, изменение, перепаковка и подписание APPX](https://blogs.msdn.microsoft.com/appconsult/2017/08/07/unpack-modify-repack-sign-appx/).
