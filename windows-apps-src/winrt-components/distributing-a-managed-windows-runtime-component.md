---
title: Распространение управляемого компонента среды выполнения Windows
description: Компоненты среды выполнения Windows можно распространять в виде копий файлов.
ms.assetid: 80262992-89FC-42FC-8298-5AABF58F8212
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 1d306c02d4fd99acaa49ec59230181ac0a20c9f3
ms.sourcegitcommit: f561efbda5c1d47b85601d91d70d86c5332bbf8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "72690388"
---
# <a name="distributing-a-managed-windows-runtime-component"></a>Распространение управляемого компонента среды выполнения Windows

Компоненты среды выполнения Windows можно распространять в виде копий файлов. Однако если компонент состоит из большого числа файлов, то его установка может оказаться трудоемкой для пользователей. Кроме того, ошибки в размещении файлов или неправильное указание ссылок также могут привести к неполадкам. Чтобы упростить установку и использование сложного компонента, вы можете поместить его в пакет SDK расширения Visual Studio. Пользователям нужно лишь указать одну ссылку для всего пакета. Они могут легко найти и установить компонент с помощью диалогового окна **расширения и обновления** , как описано в разделе [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015).

## <a name="planning-a-distributable-windows-runtime-component"></a>Планирование распространяемого компонента среды выполнения Windows

Выберите уникальные имена для двоичных файлов, таких как файлы .winmd. Для обеспечения уникальности мы рекомендуем использовать следующий формат:

``` syntax
company.product.purpose.extension
For example: Microsoft.Cpp.Build.dll
```

Двоичные файлы будут устанавливаться в пакеты приложения, возможно, с двоичными файлами от других разработчиков. См. раздел "пакеты SDK расширений" в разделе [как создать пакет средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015).

Чтобы определить способ распространения компонента, оцените его сложность. Пакет SDK расширения или аналогичный диспетчер пакетов рекомендуется использовать в следующих случаях:

-   компонент состоит из нескольких файлов;
-   вы предоставляете версии компонента для нескольких платформ (например, x86 и ARM);
-   вы предоставляете отладочную и окончательную версию компонента;
-   компонент содержит файлы и сборки, которые используются только во время разработки.

Пакет SDK расширения особенно полезен, если выполняется несколько из вышеперечисленных условий.

> **Обратите внимание** ,   For сложные компоненты, система управления пакетами NuGet предлагает альтернативный источник для пакетов SDK расширений. Как и пакеты SDK расширений, NuGet позволяет создавать пакеты, упрощающие установку сложных компонентов. Сравнение пакетов NuGet и пакетов SDK расширений Visual Studio см. в разделе [Добавление ссылок с помощью NuGet и пакета SDK расширений](https://docs.microsoft.com/visualstudio/ide/adding-references-using-nuget-versus-an-extension-sdk?view=vs-2015).

## <a name="distribution-by-file-copy"></a>Распространение копий файлов

Если компонент состоит из одного файла .winmd или файла .winmd и файлов индекса ресурсов (.pri), вы можете просто позволить пользователям копировать файл .winmd. Пользователи могут поместить файл в любое место проекта: добавить его с помощью диалогового окна **Добавление существующего элемента**, а затем создавать ссылки на него с помощью диалогового окна «Диспетчер ссылок». Если компонент включает файлы .pri или .xml, укажите пользователям, что эти файлы должны находиться вместе с файлом .winmd.

> **Примечание** .   Visual Studio всегда создает PRI-файл при сборке компонента Среда выполнения Windows, даже если проект не содержит ресурсов. Если у вас есть тестовое приложение для компонента, можно определить, используется ли PRI-файл, проверив содержимое пакета приложения в папке bin \\debug \\AppX. Если файл .pri из компонента отсутствует в этой папке, то распространять его не нужно. Также вы можете создать дамп файла ресурсов из проекта компонента среды выполнения Windows с помощью средства [MakePRI.exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10)). Например, в окне командной строки Visual Studio, введите makepri dump /if MyComponent.pri /of MyComponent.pri.xml. Дополнительные сведения о файлах .pri можно найти в разделе [Система управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10)).

## <a name="distribution-by-extension-sdk"></a>Распространение с помощью пакета SDK расширения

Сложный компонент, как правило, включает ресурсы Windows (также ознакомьтесь с примечанием в предыдущем разделе об обнаружении пустых файлов .pri).

**Создание пакета SDK для расширений**

1.  Убедитесь, что установлен пакет SDK для Visual Studio. Пакет SDK для Visual Studio можно скачать на странице [загрузок для Visual Studio](https://visualstudio.microsoft.com/downloads/download-visual-studio-vs).
2.  Создайте новый проект с помощью шаблона "Проект VSIX". Шаблон можно найти в папке Visual C# или Visual Basic в категории "Расширение среды". Этот шаблон устанавливается как часть пакета SDK для Visual Studio. (в разделе [Пошаговое руководство. Создание пакета SDK с использованием C# или Visual Basic](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-csharp-or-visual-basic?view=vs-2015) или [Пошаговое руководство. Создание пакета SDK с использованием C++](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-cpp?view=vs-2015) демонстрируется использование этого шаблона в очень простом сценарии )
3.  Определите структуру папок для пакета SDK. Структура папок начинается на корневом уровне проекта VSIX, содержащем папки **References**, **Redist** и **DesignTime**.

    -   В папке **References** хранятся двоичные файлы, которые пользователи могут использовать в программировании. Пакет SDK расширения создает ссылки на эти файлы в проектах Visual Studio пользователей.
    -   В папке **Redist** хранятся все остальные файлы, которые необходимо распространять вместе с двоичными, в приложениях, созданных с использованием вашего компонента.
    -   **DesignTime** — это расположение файлов, которые используются, только когда разработчики создают приложения, использующие ваш компонент.

    В каждой из этих папок вы можете создать папки конфигурации. Допустимые имена: debug, retail и CommonConfiguration. Папка CommonConfiguration предназначена для файлов, одинаковых как для коммерческой, так и для отладочной сборки. Если вы распространяете только коммерческие сборки компонента, вы можете поместить все в папку CommonConfiguration и не создавать другие две папки.

    В каждой папке конфигурации вы можете создать папки архитектуры для файлов, относящихся к конкретной платформе. Если вы используете одни и те же файлы для всех платформ, вы можете создать только одну папку с именем neutral. Сведения о структуре папок, включая другие имена папок архитектуры, см. в подокне [Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015). (в этой статье описываются как пакеты SDK платформ, так и пакеты SDK расширений; возможно, имеет смысл свернуть раздел о пакетах SDK платформ, чтобы избежать путаницы) )

4.  Создайте файл манифеста пакета SDK. В манифесте указаны имя и сведения о версии, архитектуры, поддерживаемые пакетом SDK, версии .NET и другие сведения о том, как Visual Studio использует ваш пакет SDK. Подробную информацию и пример можно найти в разделе [Практическое руководство. Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015).
5.  Выполните сборку и распространите пакет SDK расширения. Подробные сведения, включая локализацию и подписание пакета VSIX, см. в разделе [развертывание VSIX](https://docs.microsoft.com/visualstudio/misc/how-to-manually-package-an-extension-vsix-deployment?view=vs-2015).

## <a name="related-topics"></a>Статьи по теме

* [Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015)
* [система управления пакетами NuGet](https://github.com/NuGet/Home)
* [Система управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10))
* [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015)
* [Параметры команды передаваемые программе MakePRI. exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10))
