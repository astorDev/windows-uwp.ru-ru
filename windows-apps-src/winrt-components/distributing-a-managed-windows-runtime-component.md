---
title: Распространение компонента управляемого среда выполнения Windows
description: Компонент среда выполнения Windows можно распространять по копиям файлов.
ms.assetid: 80262992-89FC-42FC-8298-5AABF58F8212
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 1d306c02d4fd99acaa49ec59230181ac0a20c9f3
ms.sourcegitcommit: f561efbda5c1d47b85601d91d70d86c5332bbf8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "72690388"
---
# <a name="distributing-a-managed-windows-runtime-component"></a>Распространение компонента управляемого среда выполнения Windows

Компонент среда выполнения Windows можно распространять по копиям файлов. Однако если компонент состоит из множества файлов, установка может быть утомительной для пользователей. Кроме того, ошибки при размещении файлов или сбое установки ссылок могут привести к проблемам. Можно упаковать сложный компонент в качестве пакета SDK для расширений Visual Studio, чтобы упростить его установку и использование. Пользователям необходимо только установить одну ссылку на весь пакет. Они могут легко найти и установить компонент с помощью диалогового окна **расширения и обновления** , как описано в разделе [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015).

## <a name="planning-a-distributable-windows-runtime-component"></a>Планирование распространяемого компонента среда выполнения Windows

Выберите уникальные имена для двоичных файлов, например WinMD-файлы. Для обеспечения уникальности рекомендуется использовать следующий формат:

``` syntax
company.product.purpose.extension
For example: Microsoft.Cpp.Build.dll
```

Двоичные файлы будут установлены в пакетах приложений, возможно, с двоичными файлами других разработчиков. См. раздел "пакеты SDK расширений" в разделе [как создать пакет средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015).

Чтобы выбрать способ распространения компонента, определите его сложность. Пакет SDK расширения или аналогичный диспетчер пакетов рекомендуется использовать в следующих случаях:

-   Компонент состоит из нескольких файлов.
-   Вы предоставляете версии компонента для нескольких платформ (например, x86 и ARM).
-   Вы предоставляете отладочную и окончательную версии компонента.
-   Компонент содержит файлы и сборки, которые используются только во время разработки.

Пакет SDK для расширений особенно полезен, если выполняется более чем одно из указанных выше условий.

> **Примечание** .  для сложных компонентов, система управления пакетами NuGet предлагает альтернативный источник для пакетов SDK расширений. Как и пакеты SDK расширений, NuGet позволяет создавать пакеты, которые упрощают установку сложных компонентов. Сравнение пакетов NuGet и пакетов SDK расширений Visual Studio см. в разделе [Добавление ссылок с помощью NuGet и пакета SDK расширений](https://docs.microsoft.com/visualstudio/ide/adding-references-using-nuget-versus-an-extension-sdk?view=vs-2015).

## <a name="distribution-by-file-copy"></a>Распределение по копиям файлов

Если компонент состоит из одного WINMD-файла, файла. winmd и файла индекса ресурсов (. PRI), можно просто сделать файл. winmd доступным для копирования пользователями. Пользователи могут поместить файл в любое место в проекте, использовать диалоговое окно **Добавление существующего элемента** , чтобы добавить WINMD-файл в проект, а затем использовать диалоговое окно Диспетчер ссылок для создания ссылки. При включении файла. PRI или. XML попросите пользователей поместить эти файлы в файл WinMD.

> **Обратите внимание** ,  Visual Studio всегда создает PRI-файл при сборке компонента Среда выполнения Windows, даже если проект не содержит ресурсов. Если у вас есть тестовое приложение для компонента, можно определить, используется ли PRI-файл, проверив содержимое пакета приложения в папке bin\\Debug\\AppX. Если PRI – файл из компонента не отображается там, его не нужно распространять. Кроме того, можно использовать средство [передаваемые программе MakePRI. exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10)) для дампа файла ресурсов из проекта компонента Среда выполнения Windows. Например, в окне командной строки Visual Studio введите: передаваемые программе MakePRI dump/if MyComponent. PRI/оф MyComponent. PRI. XML. Дополнительные сведения о PRI-файлах в [системе управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10))см. в этой статье.

## <a name="distribution-by-extension-sdk"></a>Распространение по пакету SDK для расширений

Составной компонент обычно включает ресурсы Windows, но в предыдущем разделе см. Примечание об обнаружении пустых PRI-файлов.

**Создание пакета SDK для расширений**

1.  Убедитесь, что установлен пакет SDK для Visual Studio. Пакет SDK для Visual Studio можно скачать на странице [загрузки Visual Studio](https://visualstudio.microsoft.com/downloads/download-visual-studio-vs) .
2.  Создайте новый проект с помощью шаблона проекта VSIX. Шаблон можно найти в элементе Visual C# или Visual Basic в категории расширяемость. Этот шаблон устанавливается в составе пакета SDK для Visual Studio. ([Пошаговое руководство. Создание C# пакета SDK с помощью или Visual Basic](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-csharp-or-visual-basic?view=vs-2015) или [Пошаговое руководство. Создание пакета SDK с помощью C++ ](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-cpp?view=vs-2015), демонстрирует использование этого шаблона в очень простом сценарии. )
3.  Определите структуру папок для пакета SDK. Структура папок начинается на корневом уровне проекта VSIX со **ссылками**, **Redist**и **DesignTime** папками.

    -   **Ссылки** — это расположение двоичных файлов, с которыми пользователи могут программировать. Пакет SDK для расширений создает ссылки на эти файлы в проектах Visual Studio пользователей.
    -   **Redist** — это расположение для других файлов, которые должны быть распространены с двоичными файлами, в приложениях, созданных с помощью вашего компонента.
    -   **DesignTime** — это расположение файлов, которые используются только в том случае, если разработчики создаются приложения, использующие ваш компонент.

    В каждой из этих папок можно создавать папки конфигурации. Допустимые имена: Debug, Retail и CommonConfiguration. Папка CommonConfiguration используется для файлов, которые совпадают независимо от того, используются ли они в розничной или отладочной сборках. Если вы распространяете только розничные сборки компонента, вы можете разместить все в CommonConfiguration и опустить две другие папки.

    В каждой папке конфигурации можно указать папки архитектуры для файлов, зависящих от платформы. При использовании одних и тех же файлов для всех платформ можно указать одну папку с именем Neutral. Сведения о структуре папок, включая другие имена папок архитектуры, см. в подокне [Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015). (В этой статье обсуждаются пакеты SDK для платформы и пакеты SDK расширений. Может оказаться полезным свернуть раздел о пакетах SDK для платформы, чтобы избежать путаницы. )

4.  Создайте файл манифеста SDK. В манифесте указаны имя и сведения о версии, архитектуры, поддерживаемые пакетом SDK, версии .NET и другие сведения о том, как Visual Studio использует ваш пакет SDK. Подробные сведения и пример см. в [инструкции по созданию пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015).
5.  Создание и распространение пакета SDK расширения. Подробные сведения, включая локализацию и подписание пакета VSIX, см. в разделе [развертывание VSIX](https://docs.microsoft.com/visualstudio/misc/how-to-manually-package-an-extension-vsix-deployment?view=vs-2015).

## <a name="related-topics"></a>Связанные разделы

* [Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015)
* [система управления пакетами NuGet](https://github.com/NuGet/Home)
* [Система управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10))
* [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015)
* [Параметры команды передаваемые программе MakePRI. exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10))
