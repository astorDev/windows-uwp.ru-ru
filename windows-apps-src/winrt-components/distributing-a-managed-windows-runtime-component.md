---
title: Распространение управляемого компонента среды выполнения Windows
description: Компоненты среды выполнения Windows можно распространять в виде копий файлов.
ms.assetid: 80262992-89FC-42FC-8298-5AABF58F8212
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: b9fcdff5b8648822bb5cc22771daded23f6d52a5
ms.sourcegitcommit: 6f32604876ed480e8238c86101366a8d106c7d4e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/21/2019
ms.locfileid: "67322233"
---
# <a name="distributing-a-managed-windows-runtime-component"></a>Распространение управляемого компонента среды выполнения Windows



Компоненты среды выполнения Windows можно распространять в виде копий файлов. Однако если компонент состоит из большого числа файлов, то его установка может оказаться трудоемкой для пользователей. Кроме того, ошибки в размещении файлов или неправильное указание ссылок также могут привести к неполадкам. Чтобы упростить установку и использование сложного компонента, вы можете поместить его в пакет SDK расширения Visual Studio. Пользователям нужно лишь указать одну ссылку для всего пакета. Они легко могут находить и устанавливать компоненты с помощью диалогового окна **Расширения и обновления**, как описано в разделе [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015), в библиотеке MSDN.

## <a name="planning-a-distributable-windows-runtime-component"></a>Планирование распространяемого компонента среды выполнения Windows

Выберите уникальные имена для двоичных файлов, таких как файлы .winmd. Для обеспечения уникальности мы рекомендуем использовать следующий формат:

``` syntax
company.product.purpose.extension
For example: Microsoft.Cpp.Build.dll
```

Двоичные файлы будут устанавливаться в пакеты приложения, возможно, с двоичными файлами от других разработчиков. См. в разделе «Пакет SDK расширения» в [как: Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015), в библиотеке MSDN.

Чтобы определить способ распространения компонента, оцените его сложность. Пакет SDK расширения или аналогичный диспетчер пакетов рекомендуется использовать в следующих случаях:

-   компонент состоит из нескольких файлов;
-   вы предоставляете версии компонента для нескольких платформ (например, x86 и ARM);
-   вы предоставляете отладочную и окончательную версию компонента;
-   компонент содержит файлы и сборки, которые используются только во время разработки.

Пакет SDK расширения особенно полезен, если выполняется несколько из вышеперечисленных условий.

> **Примечание**  для сложных компонентов система управления пакетами NuGet является альтернативой открытым исходным кодом SDK расширения. Как и пакеты SDK расширений, NuGet позволяет создавать пакеты, упрощающие установку сложных компонентов. Сравнение пакетов NuGet с пакетами SDK расширений Visual Studio можно найти в разделе [Добавление ссылок с использованием NuGet или расширения SDK](https://docs.microsoft.com/visualstudio/ide/adding-references-using-nuget-versus-an-extension-sdk?view=vs-2015) в библиотеке MSDN.

## <a name="distribution-by-file-copy"></a>Распространение копий файлов

Если компонент состоит из одного файла .winmd или файла .winmd и файлов индекса ресурсов (.pri), вы можете просто позволить пользователям копировать файл .winmd. Пользователи могут поместить файл в любое место проекта: добавить его с помощью диалогового окна **Добавление существующего элемента**, а затем создавать ссылки на него с помощью диалогового окна «Диспетчер ссылок». Если компонент включает файлы .pri или .xml, укажите пользователям, что эти файлы должны находиться вместе с файлом .winmd.

> **Примечание**  Visual Studio всегда создает файл .pri при сборке компонента среды выполнения Windows, даже если проект не содержит никаких ресурсов. Если имеется приложение теста для компонента, можно определить, используется ли файл .pri, проверив содержимое пакета приложения в ячейке\\Отладка\\папки AppX. Если файл .pri из компонента отсутствует в этой папке, то распространять его не нужно. Также вы можете создать дамп файла ресурсов из проекта компонента среды выполнения Windows с помощью средства [MakePRI.exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10)). Например, в окне командной строки Visual Studio, введите makepri dump /if MyComponent.pri /of MyComponent.pri.xml. Дополнительные сведения о файлах .pri можно найти в разделе [Система управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10)).

## <a name="distribution-by-extension-sdk"></a>Распространение с помощью пакета SDK расширения

Сложный компонент, как правило, включает ресурсы Windows (также ознакомьтесь с примечанием в предыдущем разделе об обнаружении пустых файлов .pri).

**Для создания расширения SDK**

1.  Убедитесь, что установлен пакет SDK для Visual Studio. Пакет SDK для Visual Studio можно скачать на странице [загрузок для Visual Studio](https://visualstudio.microsoft.com/downloads/download-visual-studio-vs).
2.  Создайте новый проект с помощью шаблона "Проект VSIX". Шаблон можно найти в папке Visual C# или Visual Basic в категории "Расширение среды". Этот шаблон устанавливается как часть пакета SDK для Visual Studio. ([Пошаговое руководство: Создание пакета SDK с помощью C# или Visual Basic](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-csharp-or-visual-basic?view=vs-2015) или [Пошаговое руководство: Создание пакета SDK с помощью C++](https://docs.microsoft.com/visualstudio/extensibility/walkthrough-creating-an-sdk-using-cpp?view=vs-2015), демонстрируется использование этого шаблона в очень простом сценарии. )
3.  Определите структуру папок для пакета SDK. Структура папок начинается на корневом уровне проекта VSIX, содержащем папки **References**, **Redist** и **DesignTime**.

    -   В папке **References** находятся двоичные файлы, которые нужны пользователям при программировании. Пакет SDK расширения создает ссылки на эти файлы в проектах Visual Studio пользователей.
    -   В папке **Redist** хранятся все остальные файлы, которые необходимо распространять вместе с двоичными, в приложениях, созданных с использованием вашего компонента.
    -   **DesignTime** — это расположение файлов, которые используются, только когда разработчики создают приложения, использующие ваш компонент.

    В каждой из этих папок вы можете создать папки конфигурации. Допустимые имена: debug, retail и CommonConfiguration. Папка CommonConfiguration предназначена для файлов, одинаковых как для коммерческой, так и для отладочной сборки. Если вы распространяете только коммерческие сборки компонента, вы можете поместить все в папку CommonConfiguration и не создавать другие две папки.

    В каждой папке конфигурации вы можете создать папки архитектуры для файлов, относящихся к конкретной платформе. Если вы используете одни и те же файлы для всех платформ, вы можете создать только одну папку с именем neutral. Сведения о структуре папок, включая другие имена папок архитектуры в [как: Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015), в библиотеке MSDN. (в этой статье описываются как пакеты SDK платформ, так и пакеты SDK расширений; возможно, имеет смысл свернуть раздел о пакетах SDK платформ, чтобы избежать путаницы) )

4.  Создайте файл манифеста пакета SDK. Манифест указывает имя и сведения о версии, архитектуру, поддерживаемую пакетом SDK, версии .NET Framework и другие сведения о том, как использовать пакет SDK в Visual Studio. Можно найти сведения и пример см. в [как: Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015).
5.  Выполните сборку и распространите пакет SDK расширения. Более подробные сведения, например информацию о локализации и подписывании пакета VSIX, можно найти в разделе «Развертывание VSIX» в библиотеке MSDN.

## <a name="related-topics"></a>См. также

* [Создание пакета средств разработки программного обеспечения](https://docs.microsoft.com/visualstudio/extensibility/creating-a-software-development-kit?view=vs-2015)
* [Система управления пакетами NuGet](https://github.com/NuGet/Home)
* [Система управления ресурсами (Windows)](https://docs.microsoft.com/previous-versions/windows/apps/jj552947(v=win.10))
* [Поиск и использование расширений Visual Studio](https://docs.microsoft.com/visualstudio/ide/finding-and-using-visual-studio-extensions?view=vs-2015)
* [Параметры команды MakePRI.exe](https://docs.microsoft.com/previous-versions/windows/apps/jj552945(v=win.10))
