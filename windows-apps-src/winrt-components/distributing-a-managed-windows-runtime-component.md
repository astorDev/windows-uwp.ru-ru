---
author: msatranjr
title: Распространение управляемого компонента среды выполнения Windows
description: Компоненты среды выполнения Windows можно распространять в виде копий файлов.
ms.assetid: 80262992-89FC-42FC-8298-5AABF58F8212
ms.author: misatran
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 6461b6889f110bde8929e1f370f9197caa33e5f3
ms.sourcegitcommit: cd00bb829306871e5103db481cf224ea7fb613f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/01/2018
ms.locfileid: "5880520"
---
# <a name="distributing-a-managed-windows-runtime-component"></a>Распространение управляемого компонента среды выполнения Windows



Компоненты среды выполнения Windows можно распространять в виде копий файлов. Однако если компонент состоит из большого числа файлов, то его установка может оказаться трудоемкой для пользователей. Кроме того, ошибки в размещении файлов или неправильное указание ссылок также могут привести к неполадкам. Чтобы упростить установку и использование сложного компонента, вы можете поместить его в пакет SDK расширения Visual Studio. Пользователям нужно лишь указать одну ссылку для всего пакета. Они легко могут находить и устанавливать компоненты с помощью диалогового окна **Расширения и обновления**, как описано в разделе [Поиск и использование расширений Visual Studio](https://msdn.microsoft.com/library/vstudio/dd293638.aspx), в библиотеке MSDN.

## <a name="planning-a-distributable-windows-runtime-component"></a>Планирование распространяемого компонента среды выполнения Windows

Выберите уникальные имена для двоичных файлов, таких как файлы .winmd. Для обеспечения уникальности мы рекомендуем использовать следующий формат:

``` syntax
company.product.purpose.extension
For example: Microsoft.Cpp.Build.dll
```

Двоичные файлы будут устанавливаться в пакеты приложения, возможно, с двоичными файлами от других разработчиков. Ознакомьтесь с разделом «Пакеты SDK расширений» в статье [Практическое руководство. Создание пакета средств разработки программного обеспечения](https://msdn.microsoft.com/library/hh768146.aspx) в библиотеке MSDN.

Чтобы определить способ распространения компонента, оцените его сложность. Пакет SDK расширения или аналогичный диспетчер пакетов рекомендуется использовать в следующих случаях:

-   компонент состоит из нескольких файлов;
-   вы предоставляете версии компонента для нескольких платформ (например, x86 и ARM);
-   вы предоставляете отладочную и окончательную версию компонента;
-   компонент содержит файлы и сборки, которые используются только во время разработки.

Пакет SDK расширения особенно полезен, если выполняется несколько из вышеперечисленных условий.

> **Примечание**сложных компонентов, система управления пакетами NuGet является альтернативой с открытым исходным кодом расширений. Как и пакеты SDK расширений, NuGet позволяет создавать пакеты, упрощающие установку сложных компонентов. Сравнение пакетов NuGet с пакетами SDK расширений Visual Studio можно найти в разделе [Добавление ссылок с использованием NuGet или расширения SDK](https://msdn.microsoft.com/library/jj161096.aspx) в библиотеке MSDN.

## <a name="distribution-by-file-copy"></a>Распространение копий файлов

Если компонент состоит из одного файла .winmd или файла .winmd и файлов индекса ресурсов (.pri), вы можете просто позволить пользователям копировать файл .winmd. Пользователи могут поместить файл в любое место проекта: добавить его с помощью диалогового окна **Добавление существующего элемента**, а затем создавать ссылки на него с помощью диалогового окна «Диспетчер ссылок». Если компонент включает файлы .pri или .xml, укажите пользователям, что эти файлы должны находиться вместе с файлом .winmd.

> **Примечание**Visual Studio всегда создает файл .pri при сборке компонента среды выполнения Windows, даже если проект не содержит никаких ресурсов. Если у вас есть тестовое приложение для компонента, вы можете определить, используется ли файл .pri, проверив содержимое пакета приложения в папке bin\\debug\\AppX. Если файл .pri из компонента отсутствует в этой папке, то распространять его не нужно. Также вы можете создать дамп файла ресурсов из проекта компонента среды выполнения Windows с помощью средства [MakePRI.exe](https://msdn.microsoft.com/library/windows/apps/jj552945.aspx). Например, в окне командной строки Visual Studio, введите makepri dump /if MyComponent.pri /of MyComponent.pri.xml. Дополнительные сведения о файлах .pri можно найти в разделе [Система управления ресурсами (Windows)](https://msdn.microsoft.com/library/windows/apps/jj552947.aspx).

## <a name="distribution-by-extension-sdk"></a>Распространение с помощью пакета SDK расширения

Сложный компонент, как правило, включает ресурсы Windows (также ознакомьтесь с примечанием в предыдущем разделе об обнаружении пустых файлов .pri).

**Создание пакета SDK расширения**

1.  Убедитесь, что установлен пакет SDK для Visual Studio. Пакет SDK для Visual Studio можно скачать на странице [загрузок для Visual Studio](https://www.visualstudio.com/downloads/download-visual-studio-vs).
2.  Создайте новый проект с помощью шаблона "Проект VSIX". Шаблон можно найти в папке Visual C# или Visual Basic в категории "Расширение среды". Этот шаблон устанавливается как часть пакета SDK для Visual Studio. (в разделе [Пошаговое руководство. Создание пакета SDK с использованием C# или Visual Basic](https://msdn.microsoft.com/library/jj127119.aspx) или [Пошаговое руководство. Создание пакета SDK с использованием C++](https://msdn.microsoft.com/library/jj127117.aspx) демонстрируется использование этого шаблона в очень простом сценарии )
3.  Определите структуру папок для пакета SDK. Структура папок начинается на корневом уровне проекта VSIX, содержащем папки **References**, **Redist** и **DesignTime**.

    -   В папке **References** хранятся двоичные файлы, которые пользователи могут использовать в программировании. Пакет SDK расширения создает ссылки на эти файлы в проектах Visual Studio пользователей.
    -   В папке **Redist** хранятся все остальные файлы, которые необходимо распространять вместе с двоичными, в приложениях, созданных с использованием вашего компонента.
    -   **DesignTime**— это расположение файлов, которые используются, только когда разработчики создают приложения, использующие ваш компонент.

    В каждой из этих папок вы можете создать папки конфигурации. Допустимые имена: debug, retail и CommonConfiguration. Папка CommonConfiguration предназначена для файлов, одинаковых как для коммерческой, так и для отладочной сборки. Если вы распространяете только коммерческие сборки компонента, вы можете поместить все в папку CommonConfiguration и не создавать другие две папки.

    В каждой папке конфигурации вы можете создать папки архитектуры для файлов, относящихся к конкретной платформе. Если вы используете одни и те же файлы для всех платформ, вы можете создать только одну папку с именем neutral. Сведения о структуре папок, включая другие имена папок архитектуры, вы можете найти в статье [Практическое руководство. Создание пакета средств разработки программного обеспечения](https://msdn.microsoft.com/library/hh768146.aspx) в библиотеке MSDN (в этой статье описываются как пакеты SDK платформ, так и пакеты SDK расширений; возможно, имеет смысл свернуть раздел о пакетах SDK платформ, чтобы избежать путаницы) )

4.  Создайте файл манифеста пакета SDK. Манифест указывает имя и сведения о версии, архитектуру, поддерживаемую пакетом SDK, версии .NET Framework и другие сведения о том, как использовать пакет SDK в Visual Studio. Подробную информацию и пример можно найти в разделе [Практическое руководство. Создание пакета средств разработки программного обеспечения](https://msdn.microsoft.com/library/hh768146.aspx).
5.  Выполните сборку и распространите пакет SDK расширения. Более подробные сведения, например информацию о локализации и подписывании пакета VSIX, можно найти в разделе «Развертывание VSIX» в библиотеке MSDN.

## <a name="related-topics"></a>Еще по теме

* [Создание пакета средств разработки программного обеспечения](https://msdn.microsoft.com/library/hh768146.aspx)
* [Система управления пакетами NuGet](https://github.com/NuGet/Home)
* [Система управления ресурсами (Windows)](https://msdn.microsoft.com/library/windows/apps/jj552947.aspx)
* [Поиск и использование расширений Visual Studio](https://msdn.microsoft.com/library/dd293638.aspx)
* [Параметры команды MakePRI.exe](https://msdn.microsoft.com/library/windows/apps/jj552945.aspx)
