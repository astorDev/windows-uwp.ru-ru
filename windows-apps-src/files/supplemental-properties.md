---
title: С помощью дополнительных свойств
description: Общие сведения об использовании дополнительных свойств и сведения о том, как они были реализованы в Windows
ms.date: 01/10/2017
ms.topic: article
keywords: Windows 10, uwp, WinRT API индексатора поиска
localizationpriority: medium
ms.openlocfilehash: b2ac43c9aa2d27f8745e9075abc13d8feaba2370
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57592689"
---
# <a name="using-supplemental-properties"></a>С помощью дополнительных свойств  

## <a name="summary"></a>Сводка  
- Дополнительные свойства Разрешить приложениям отметьте файлы как свойства без изменения файла 
- Может использоваться для случаев, где у вас есть свойства, которые трудно вычислить или файл невозможно изменить 
- С помощью дополнительных свойств является так же, как любое другое свойство в системе свойств Windows  

## <a name="introduction"></a>Введение 
Многие из замечательных новых приложений в последние несколько лет необходим работающий с большим объемом операций ЦП на файлы пользователя, чтобы извлечь полезные свойства из файлов за пределами основных вещей, такие как Дата создания. Эти приложения объекта распознавание на изображениях, намерений извлечения в сообщения электронной почты и анализ текста в документы группы друг с другом. Это управляется как возможности для эффективной работы теперь доступна в большинстве потребителя ПК.   

Создавая мгновенно поиска по файлам эти метаданные позволяют пользователям экспоненциально более продуктивной. Просто знать, что вашей дочь изображения интересен, но возможность поиска изображения из нее с помощью ее Бабушке намного полезнее. В результате процедура использования внешний компьютер, более персонализированные и более в активном состоянии. Как кто-то в ней обращается к помогают найти ваш treasured увеличенный объем оперативной памяти. 

В течение десятилетий в решение для быстрого поиска в Windows находятся индексатора, а в Creators Update он был обновлен для поддержки новых сценариев. Приложения, теперь могут отметьте файлы как дополнительные свойства помимо тех, которые извлекаются системой. Эти свойства обрабатываются как привилегированные  

## <a name="windows-properties"></a>Свойства Windows 
[Системе свойств Windows](https://msdn.microsoft.com/library/windows/desktop/ff728898) был ключевой частью взаимодействия с файлами годами. Она позволяет приложениям считывать свойства из файлов не обязательно знать внутреннее содержимое различных форматах файлов или языки, которые может быть файл в. Все, что абстрагируется для вас как разработчика, что необходимо сделать всего лишь запросить список и задать порядок возрастания или убывания.  

Система свойств переплетен с индексатором Windows — она считывает все свойства из файлов в своей области действия и хранит их. Позже при приложение запрашивает список всех .docx в папке, чтобы отсортировать по дате изменения, кроме тех, созданные пользователем John Smith индексатор может возвращать список мгновенно.  

Как работают эти системы недостаток состоит в что индексатора, требующую все свойства он будет храниться о файле доступен сразу же. Это ограничивает его надежность благодаря о наиболее интересных свойств, которые принимают больше времени для вычисления, так как есть требование, сложно.  

Хотя с помощью свойства несложно, приложение может запросить отсортированного набора свойств о файле, аналогично работе с базой данных, или он может передать запрос наподобие с помощью поисковой системы. Индексатор обработает запрос и возвращают результаты. Это предоставить разработчикам возможность объединять свои фильтров (например только поиска jpg-файлы) с помощью пользовательского запроса (имя файла, начиная с «bird»). 

## <a name="supplemental-properties"></a>Дополнительные свойства 

Дополнительные свойства работают одинаково для обычных свойств Windows с одним очень важным отличием — они не будут записываться при добавлении файла в индексатор. Необходимо добавить дополнительное свойство другим приложением, в системе более поздней версии. Это может быть двух минут позже, после завершения распознавание объектов или это может быть дней позже. 

После написания свойство его можно поиск, фильтрация, отсортированы или сгруппированы так же, как и любое другое свойство в системе. Также он может использоваться в запросах, объединенный с другими свойствами в системе, либо дополнительное или нет. Это дает возможность легко объединять дополнительные свойства с существующим кодом файл системы без необходимости перезаписи.  

### <a name="example-scenarios"></a>Примеры сценариев 

Существуют тысячи различных свойств, которые можно написать дополнительные свойства, но есть ряд ключевых сценариев, в этом учебнике будет хранить Возвращаясь к:  

#### <a name="tagging-pictures-with-extracted-properties"></a>Добавление тегов изображений с эти извлеченные свойства 
Эти приложения могут использовать обученную модель машинного Обучения для извлечения признаков из образа, система не располагает информацией о таких как объект изображения. Можно затем получают объекты, обнаруженные в образе и добавить их к системе свойств для более поздней версии, поиска или группирования.  

#### <a name="tagging-files-with-an-app-specific-id"></a>Маркировка файлов с помощью конкретного ИД приложения 
Во многих приложениях синхронизации файла используйте собственный уникальный идентификатор для отслеживания файлов, при переходе между сервером и различных клиентских устройств. Клиент синхронизации может записывать этот идентификатор в системе свойств без влияющие на файл. Этот идентификатор является теперь доступны приложению позже для быстрого доступа и доступны для любого другого приложения в системе для чтения при взаимодействии с поставщиком синхронизации. 

Существует множество других параметров для использования дополнительных свойств, но эти сделать хороших примеров, так как они требуют быстрого поиска или поиска, — это фрагменты данных, не знает о системе и не может быть добавлен в сам файл.  

### <a name="using-supplemental-properties"></a>С помощью дополнительных свойств 
С помощью дополнительных свойств является таким же, как запись обычное свойство файловую систему. Если вы знакомы с помощью StorageFiles и свойств, вы можете пропустить это. В противном случае давайте подробно рассмотрим краткий пример вписывает одно свойство в файл и считывания обратно то же свойство позднее.  

### <a name="writing-supplemental-properties"></a>Запись дополнительных свойств  
Образец будет изменять только первый файл, которое она находит для простоты, но обычно приложение будет добавлено свойство ко всем файлам, которые будут найдены.  

```csharp
// Only indexed jpg files are going to be used 
QueryOptions option = new QueryOptions(CommonFileQuery.DefaultQuery, new string[] { ".jpg" }); 
option.IndexerOption = IndexerOption.OnlyUseIndexer; 
// Typically an app would loop over all the files in the library, updating them all with the new 
// value. To make the sample easier to understand however, this app is only going to update the  
// first file it finds 
var query = KnownFolders.PicturesLibrary.CreateFileQueryWithOptions(option); 
StorageFile file = (await query.GetFilesAsync()).FirstOrDefault(); 
if (file == null) 
{ 
    log("No jpg file found in the library. Stopping"); 
    return; 
} 
log("Found file: " + file.Path); 
// Selecting the property to modify and writing it out 
List<KeyValuePair<string, object>> props = new List<KeyValuePair<string, object>>();             
props.Add(new KeyValuePair<string, object>("System.Supplemental.ResourceId", fileId)); 
await file.Properties.SavePropertiesAsync(props); 
```

Имеется проверку важно, если расположение индексируется до записи вне свойства. В этом примере мы используем параметры запроса для фильтрации только индексировать расположений. Если это не представляется возможным можно проверить состояние индексированных родительскую папку (файл. GetParentAsync(). GetIndexedStateAsync()). В любом случае будет дают одинаковые результаты 

### <a name="reading-supplemental-properties"></a>Чтение дополнительных свойств 
Опять же чтение дополнительные свойства совпадает со значением чтения любого другого свойства файла системы. В этом примере приложение будет просто считывать одно свойство из файла, в нем уже StorageFile для, но другие свойства также удалось считать в то же время.  

```csharp
// An object to hold the result from the indexer, and a string to store  
// the value in once we have confirmed it is valid. 
object uncheckedResourceId; 
string resourceId = ""; 
// Fetching the key value pair from the indexer 
IDictionary<string,object> returnedProps =  
    await file.Properties.RetrievePropertiesAsync(new string[] { "System.Supplemental.ResourceId" });             
if (returnedProps.TryGetValue("System.Supplemental.ResourceId", out uncheckedResourceId)) 
{ 
    if (uncheckedResourceId != null && !String.IsNullOrEmpty(uncheckedResourceId.ToString())) 
    { 
        resourceId = uncheckedResourceId.ToString(); 
    } 
} 
```
Выполняется проверка, чтобы убедиться в том, что значение, возвращающийся из системы свойств ожиданиям. Несмотря на то, что маловероятно, возможна значение был очищен, так как он написал приложения. Это будет рассматриваться ниже подробно.  

### <a name="implementation-notes"></a>Примечания по реализации 
Существует несколько вариантов слабая, которые были внесены в разработке дополнительных свойств. Для облегчения реализации следующие разделы были скопированы из engineering спецификации разработки для компонента. Они предоставляют краткий обзор, в том, как функция была разработана и почему некоторые ограничения существуют. 

### <a name="supplemental-properties-available"></a>Дополнительные свойства, доступные 
Существует только два свойства, которые можно использовать для приложений, изначально. System.Supplemental.ResourceId и System.Supplemental.AlbumID. При необходимости Дополнительные сведения, которые могут быть добавлены. Идентификатор альбома — строка несколькими значениями, который может использоваться для множества различных приложений и ResourceId используется в качестве уникального идентификатора для поставщиков облачных синхронизации. 

#### <a name="file-system-support"></a>Поддержка файловой системы 
Поскольку формат FAT съемный носитель сценарий является важным, дополнительные свойства будет поддерживать дисков FAT и NTFS. Это позволит гарантировать, что дополнительные свойства будет доступна для всех пользователей, независимо от их типа устройства.   

### <a name="non-indexed-locations"></a>Неиндексированных местах  
На рабочем столе есть ряд папок, которые не индексируются. В этих случаях приложений может потребоваться по-прежнему иметь доступ к дополнительные свойства. Тем не менее дополнительные свойства не были доступны за пределами расположения индексирования. Соотношение выгод и потерь был сделан по двум причинам:  

- По умолчанию индексируются все библиотеки и облачных хранилищах.   
  Они находятся, приложений универсальной платформы Windows в первую очередь с помощью. Существуют другие расположения, которые не являются индексированные (диски системы или сети), но они редко используются для хранения пользовательских данных. 

- Поверхность проектирования WinRT API предполагается, что индексатор почти всегда доступен.  
  Таким образом индексатор уже доступна в большинстве мест, которые хотели бы приложений. Если пользователи найдены хранением данных в неиндексированных местах, самым простым решением будет добавить это расположение в индекс. Работы затем дополнительные свойства, перечисление будет работать быстрее, и приложения будут иметь возможность изменять отслеживает расположение.

### <a name="reading-or-writing-supplemental-properties-from-a-file-in-a-non-indexed-location"></a>Чтения или записи дополнительных свойств из файла в месте Non-Indexed 
В случае, приложение пытается записать дополнительное свойство, по которому в настоящее время не индексируется затем вызов API вызовет исключение. Это будет то же исключение, выданное как в том случае, когда кто-то пытается обновить System.Music.AlbumArtist в DOCX-файл (недопустимые аргументы).  
 
### <a name="change-notifications"></a>Уведомления об изменениях:  
Уведомления об изменении универсальной платформы Windows и отслеживание изменений по-прежнему работают для дополнительных свойств, как и для стандартных свойств. Это позволит приложений, в которых данные, чтобы отслеживать все изменения, происходящие в одно из своих приложений предоставляются 
  
### <a name="invalidating-properties"></a>Аннулирования свойства:  
Дополнительные свойства в файле может устареть файл модификации или перемещен в системе. Приложения, отправлять данные будут использоваться те со сведениями о, если данных является допустимым или должен быть обновлен, чтобы система будет просто предоставляют средства для узнать сами.  
 
В случае изменения файла, но не перемещать или переименован, все дополнительные свойства в файле останутся без изменений. Приложения смогут зарегистрироваться для уведомлений об изменениях через существующие поверхность API и необходимости обновите свойства. 
 
Если файл перемещается, свойств будет необходимо сделать недействительным. Приложение будет получать уведомления об изменениях, либо удалить, необходимо создать, переименован или перемещен в зависимости от того, как именно операция выполняется. Когда приложение получил уведомление об изменении будет возможность проверить файл и обновить дополнительные свойства для файла, при необходимости. 
 
### <a name="indexer-rebuilds"></a>Перестраивает индексатора  
Иногда имеет индекс системы создаются заново для одного из ряда причин — удалось изменить свойство схему, пользователь может включить EDP или просто файл базы данных может быть поврежден. В этом случае дополнительные свойства не будет сохранен. Мы рассматривали возможность сделать работу для сохранения дополнительных свойств, когда происходит перестроение индекса, но возникли несколько основных препятствия:  

### <a name="protecting-the-data"></a>Защита данных 
В случае, когда файл базы данных поврежден, ошибок диска или мошенническое по обеспечения его будет невозможно защитить данные, хранящиеся в этом файле. Его длина будет храниться в другом месте в системе или каким-либо образом изолирован от остальной базы данных. 

Так как мы уже делаем массу работы, чтобы сделать индекс менее вероятно, поврежден, это позволит снизить скорость потенциальное этой ситуации в любом случае.  
Обслуживание сопоставление файлов и их метаданные во время перестроения 

Даже если индекс может защищать данные в нескольких перестройка, невозможно узнать, если файл был изменен во время был выполняется перестроение индекса. Индекс обеспечивает защиту из файла данных может быть больше не допустимым Если файл изменен или перемещен.  
Поведение 

В случае перестроения индексатора все дополнительные данные будут потеряны. Приложения будет отвечать за размещение данных обратно в индексаторе, который был потерян во время перестроения. Это поместить дополнительные сложности, связанные по приложениям, но считается разумным, так как они всегда будет содержать master состояние для всех своих данных.  

### <a name="recovering"></a>Восстановление 
Когда приложения было заметить, что происходит перестроение индекса, он сможет отвечает за обновление дополнительных свойств в удобное для себя время.  
### <a name="privacy"></a>Конфиденциальность 
Некоторые свойства, которые могут быть записаны в файлы будут таким образом, что пользователи могут не следует использовать совместно с другими приложениями. Приложения должны иметь возможность указывать, что сведения, которые выполняют запись в свойства будет быть закрытыми либо свои приложения, с помощью нескольких других приложений, общедоступную каждое приложение в системе.  

Несмотря на то, что это потенциально интересных компонент, для некоторых ранних внедрений функции, они считают, что начало открытые свойства по-прежнему будет добавить в проект имеет очень большое значение. Таким образом помечено как полезные рекомендации, и мы должны продолжать создавать функцию без поддержки скрытия значения при необходимости. Добавить его позже откроется большего количества сценариев, поэтому он будет необходимо иметь в виду во все схемы.  

## <a name="conclusions"></a>Заключение 
Таким образом, дополнительные свойства — простой способ хранения свойств файла в системе. С их помощью безусловно является необязательным, но его можно предоставить для приложения ребро поверх других приложений, которые не могут сортировать и искать данные быстрее. 

Мы надеемся увидеть приложения, которые начинают использовать эти свойства. Если у вас есть вопросы о как с помощью заголовка сообщите нам об этом в комментариях ниже 
