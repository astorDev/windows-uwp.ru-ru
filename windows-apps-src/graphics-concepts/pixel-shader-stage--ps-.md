---
title: Этап построителя текстуры (PS)
description: На этапе шейдера пикселей (PS) принимаются интерполированные данные для примитива и генерируются данные для пикселей, такие как цвет.
ms.assetid: 0AEBFDFB-0AD8-4633-AE4E-A44004B57745
keywords:
- Этап построителя текстуры (PS)
ms.date: 02/08/2017
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: e1f7e787f2ee80a3168d38a9afd9a249dc0e6de0
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57603069"
---
# <a name="pixel-shader-ps-stage"></a>Этап построителя текстуры (PS)


На этапе шейдера пикселей (PS) принимаются интерполированные данные для примитива и генерируются данные для пикселей, такие как цвет.

Это программируемая стадия шейдера, показанная на схеме [графического конвейера](graphics-pipeline.md) как закругленный блок. На этом этапе шейдер предоставляет собственные уникальные функции, основанные на [общем ядре шейдера](https://msdn.microsoft.com/library/windows/desktop/bb509580) модели 4.0.

Стадия шейдера пикселей (PS) позволяет применять расширенные возможности заливки приемы, такие как попиксельное освещение и постобработка. Шейдер пикселей — это программа, объединяющая константные переменные, данные текстур, интерполированные значения вершин и другие данные для получения отдельных пикселей. На [этапе средства программной прорисовки (RS)](rasterizer-stage--rs-.md) шейдер пикселей вызывается для каждого пикселя, покрытого примитивом, однако можно указать значение **NULL**, чтобы не запускать шейдер.

При множественной дискретизации текстуры шейдер пикселей вызывается один раз для каждого охваченного пикселя, а тестирование глубины трафарета выполняется для каждого объекта множественной дискретизации. Образцы которые проходят проверку глубины трафарета, обновляются с использованием выходного цвета шейдера пикселей.

Встроенные функции шейдера пикселей создают или используют производные от количества относительно экранного пространства x и y. Самый распространенный способ использования производных — вычисления уровня детализации для дискретизации текстур, а в случае с анизотропной фильтрацией — выбор образцов по оси анизотропии. Как правило, аппаратная реализации запускает шейдер пикселей на нескольких пикселях (например, в сетке 2x2) одновременно, чтобы производные количества, вычисленные в шейдере, можно было аппроксимировать текстуры как дельты значений в той же точке выполнения в соседних пикселях.

## <a name="span-idinputsspanspan-idinputsspanspan-idinputsspaninputs"></a><span id="Inputs"></span><span id="inputs"></span><span id="INPUTS"></span>Входные данные


Если конвейер настроен без шейдера геометрии, шейдер текстуры ограничивается 16 32-разрядными и 4-компонентными входными данными. В противном случае шейдер пикселей может принимать до 32 32-разрядных, 4-компонентных входных данных.

Входные данные шейдера пикселей включают атрибуты вершин (которые можно интерполировать с коррекцией перспективы или без нее) или могут рассматриваться как константы примитивов. Входные данные шейдера пикселей интерполируются на основе атрибутов вершин растеризуемого примитива в зависимости от объявленного режима интерполяции. Если примитив обрезается до растеризации, режим интерполяции также учитывается в процессе обрезки.

Атрибуты вершин интерполируются (или оцениваются) в центральных расположениях шейдера пикселей. Режимы интерполяции атрибутов шейдера пикселей указываются в объявлении регистрация входных данных отдельно для каждого элемента в [аргументе](https://msdn.microsoft.com/library/windows/desktop/bb509606) или [входной структуре](https://msdn.microsoft.com/library/windows/desktop/bb509668). Атрибуты можно интерполировать линейно или с центроидной дискретизацией. См. раздел "Центроидная дискретизация атрибутов при множественном сглаживании" статьи [Правила растеризации](rasterization-rules.md). Центроидная дискретизация учитывается только во время множественной дискретизации, чтобы охватить случаи, когда пиксель покрывается примитивом, а центр пикселя — нет. Центроидная оценка происходит максимально близко к центру пикселя (не охваченного примитивом).

Входные данные также можно объявить с помощью [семантики системного значения](https://msdn.microsoft.com/library/windows/desktop/bb509647), которая помечает параметр, используемый на других этапах конвейера. Например, положение пикселя должны быть помечены SV\_семантической позиции. [Стадии ассемблера входных данных (IA)](input-assembler-stage--ia-.md) может создавать одно скалярное для шейдер пикселей (с помощью SV\_PrimitiveID); [этап растеризации (RS)](rasterizer-stage--rs-.md) также можно создать одно скалярное для шейдера пикселей (с помощью "SV\_ IsFrontFace).

## <a name="span-idoutputsspanspan-idoutputsspanspan-idoutputsspanoutputs"></a><span id="Outputs"></span><span id="outputs"></span><span id="OUTPUTS"></span>Выходные данные


Пиксельный шейдер может вывести до 8 32-разрядных 4-компонентных цветов (если пиксель отклоняется, цвет не предоставляется). Компоненты регистрация выходных данных шейдера пикселей следует объявить перед использованием. У каждого регистра может быть отдельная маска вывода записи.

Используйте состояние depth-write-enable (на [этапе слияния и вывода (OM)](output-merger-stage--om-.md)), чтобы указать, записываются ли данные глубины в буфер глубины (или используйте инструкцию discard, чтобы удалить данные для пикселя). Построитель текстуры можно также выводить значение необязательно глубины 32-разрядной, 1-компонент, с плавающей запятой, для тестирования глубины (с помощью SV\_семантической глубины). Значение глубины выводится в регистре oDepth и заменяет интерполированное значение для тестирования глубины (если тестирование глубины включено). Не существует способа для динамического переключения между глубиной с фиксированной функцией и oDepth шейдера.

Шейдер пикселей не может выводить значение трафарета.

## <a name="span-idrelated-topicsspanrelated-topics"></a><span id="related-topics"></span>Связанные разделы


[Графический конвейер](graphics-pipeline.md)

 

 




