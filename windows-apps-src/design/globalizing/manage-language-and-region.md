---
Description: В этом разделе определяется список языков профилей пользователей, список языков манифестов приложений и список языков среды выполнения приложения. Мы будем использовать эти термины в этом разделе и других разделах этой области функций, поэтому важно знать, что они означают.
title: Обзор языков профиля пользователя и языков манифеста приложения
ms.assetid: 22D3A937-736A-4121-8285-A55DED56E594
template: detail.hbs
ms.date: 11/08/2017
ms.topic: article
keywords: windows 10, uwp, глобализация, локализуемость, локализация
ms.localizationpriority: medium
ms.openlocfilehash: 46ce97ecc11d7aa04013d77ad8cbfe3e50a31f91
ms.sourcegitcommit: 0dee502484df798a0595ac1fe7fb7d0f5a982821
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2020
ms.locfileid: "82970469"
---
# <a name="understand-user-profile-languages-and-app-manifest-languages"></a>Обзор языков профиля пользователя и языков манифеста приложения
Пользователь Windows может использовать **Параметры** > **время & язык** > **& язык** для настройки упорядоченного списка предпочтительных языков интерфейса или только один предпочтительный язык интерфейса. У языка может быть региональный вариант. Например, можно выбрать испанский язык в качестве разговорного языка в Испании, в Мексике, в Соединенных Штатах и другие варианты.

Кроме того, в разделе **Параметры** > **время &** > языковой**регион & язык**, но он отделен от языка, пользователь может указать свое расположение (под названием регион) в мире. Обратите внимание, что параметр "Язык интерфейса" (и региональный вариант) не определяет параметр региона и наоборот. Например, пользователь может проживать во Франции, но выбрать испанский язык (Мексика) интерфейса Windows в качестве предпочтительного.

Для приложений Windows язык представляется в виде [тега языка BCP-47](https://tools.ietf.org/html/bcp47). Например, тег языка BCP-47 с кодом "en-US" соответствует английскому языку (США) в разделе **Параметры**. Соответствующие среда выполнения Windows API принимают и возвращают строковые представления тегов языка BCP-47.

Также см. [Реестр подтегов языков IANA](https://www.iana.org/assignments/language-subtag-registry).

В следующих трех разделах приводятся определения терминов "список языков профиля пользователя", "список языков манифеста приложения" и "список языков среды выполнения приложения". Мы будем использовать эти термины в этом разделе и других разделах этой области функций, поэтому важно знать, что они означают.

## <a name="user-profile-language-list"></a>Список языков профиля пользователя
Список языков профилей пользователей — это имя списка, настроенного пользователем в области **Параметры** > **время & язык** > языков **& языковых** > **языках**. В коде можно использовать свойство [**GlobalizationPreferences.Languages**](/uwp/api/windows.system.userprofile.globalizationpreferences.Languages) для осуществления доступа к списку языков профиля пользователя в качестве нередактируемого списка строк, в котором каждая строка является отдельным [тегом языка BCP-47](https://tools.ietf.org/html/bcp47), например, "en-US" или "ja-JP".

```csharp
    IReadOnlyList<string> userLanguages = Windows.System.UserProfile.GlobalizationPreferences.Languages;
```

## <a name="app-manifest-language-list"></a>Список языков манифеста приложения
Список языков манифеста приложения — это список языков, для которых приложение объявляет (или объявит) поддержку. Этот список растет по мере продвижения вашего приложения по жизненному циклу разработки вплоть до этапа локализации.

Список определяется во время компиляции, но у вас есть два способа управления тем, как это произойдет. Один способ — позволить Visual Studio определить список, используя файлы из вашего проекта. Для этого необходимо сначала настроить **Язык по умолчанию** вашего приложения на вкладке **Приложение** в исходном файле манифеста пакета приложения (`Package.appxmanifest`). Затем подтвердите, что тот же файл содержит следующую конфигурацию (он содержит ее по умолчанию).

```xml
  <Resources>
    <Resource Language="x-generate" />
  </Resources>
```

Всякий раз, когда Visual Studio создает файл манифеста пакета приложения для сборки (`AppxManifest.xml`), происходит расширение этого отдельного элемента `Resource` в исходном файле в объединение квалификаторов языка, которые Visual Studio находит в проекте (см. раздел [Адаптация ресурсов с учетом языка, масштаба, высокой контрастности и других квалификаторов](../../app-resources/tailor-resources-lang-scale-contrast.md)). Например, если вы уже приступили к локализации и у вас есть строка, изображение и/или файловые ресурсы, имена папок или файлов которых содержат коды "en-US", "ja-JP" и "fr-FR", файл `AppxManifest.xml` вашей сборки будет содержать следующие записи (первая запись в списке является языком по умолчанию, который вы задали).

```xml
  <Resources>
    <Resource Language="EN-US" />
    <Resource Language="JA-JP" />
    <Resource Language="FR-FR" />
  </Resources>
```

Второй способ — замена этого отдельного элемента `<Resource>` ("x-generate") в исходном файле манифеста пакета приложения (`Package.appxmanifest`) на расширенный список элементов `<Resource>` (сначала необходимо указать язык по умолчанию). Этот способ подразумевает больший объем работ по обслуживанию, однако он может подойти, если вы используете пользовательскую систему сборки.

Сначала список языков манифеста приложения будет содержать только один язык. Возможно, это будет английский язык (США); "en-US". Но в конечном счете — независимо от того, будете ли вы вручную настраивать манифест или по мере добавления переведенных ресурсов в проект — список будет увеличиваться.

Когда ваше приложение находится в Microsoft Store, в списке языков манифеста приложения будут содержаться те языки, которые показываются пользователям. Список тегов языка BCP-47, специально поддерживаемых в Microsoft Store, см. в разделе [Поддерживаемые языки](../../publish/supported-languages.md).

В коде можно использовать свойство [**ApplicationLanguages.ManifestLanguages**](/uwp/api/windows.globalization.applicationlanguages.ManifestLanguages) для осуществления доступа к списку языков манифеста приложения в качестве нередактируемого списка строк, в котором каждая строка является отдельным тегом языка BCP-47, например, "en-US" или "ja-JP".

```csharp
    IReadOnlyList<string> userLanguages = Windows.Globalization.ApplicationLanguages.ManifestLanguages;
```

## <a name="app-runtime-language-list"></a>Список языков среды выполнения приложения
Третий список языков является пересечением между двумя списками, которые мы только что обсудили. Во время выполнения, список языков, для которых приложение объявило о поддержке (список языков манифеста приложения) сравнивается со списком языков, для которых пользователь объявил предпочтения (список языков профиля пользователя). Список языков среды выполнения приложения задается этому пересечению (если пересечение не является пустым) или просто языку по умолчанию приложения (если пересечение является пустым).

Точнее говоря, список языков среды выполнения приложения состоит из этих элементов.

1.  **(Необязательно) Переопределение основного языка**. [**PrimaryLanguageOverride**](/uwp/api/Windows.Globalization.ApplicationLanguages.PrimaryLanguageOverride) — это простой параметр переопределения для приложений, которые предоставляют пользователям независимый выбор языка или имеют серьезную причину переопределять языки, выбранные по умолчанию. Подробнее см. в [Примере ресурсов и локализации приложения](https://code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa).
2.  **Языки пользователя, поддерживаемые приложением**. Это список языков профиля пользователя, отфильтрованных по списку языков манифеста приложения. Фильтрация языков пользователя по языкам, поддерживаемым приложением, обеспечивает согласованность между пакетами средств разработки программного обеспечения (SDK), библиотеками классов, зависимыми пакетами платформ и приложением.
3.  **Если элементы 1 и 2 пусты, то язык по умолчанию или первый язык, поддерживаемый приложением**. Если список языков профиля пользователя не содержит никакие языки, поддерживаемые приложением, то языком среды выполнения приложения будет первый язык, поддерживаемый приложением.

В коде можно использовать свойство [ResourceContext.QualifierValues](/uwp/api/windows.applicationmodel.resources.core.resourcecontext.QualifierValues) для осуществления доступа к списку языков среды выполнения приложения в виде строки, содержащей список с использованием точки с запятой в качестве разделителя для тегов языка BCP-47.

```csharp
    string runtimeLanguages = Windows.ApplicationModel.Resources.Core.ResourceContext.GetForCurrentView().QualifierValues["Language"];
```

Также к нему можно осуществлять доступ как к нередактируемому списку из строк, каждая из которых содержит отдельный тег языка BCP-47. Это можно делать, используя свойства [**ResourceContext.Languages**](/uwp/api/windows.applicationmodel.resources.core.resourcecontext.Languages) или [**ApplicationLanguages.Languages**](/uwp/api/windows.globalization.applicationlanguages.Languages).

```csharp
    IReadOnlyList<string> runtimeLanguages = Windows.ApplicationModel.Resources.Core.ResourceContext.GetForCurrentView().Languages;

    runtimeLanguages = Windows.Globalization.ApplicationLanguages.Languages;
```

Список языков среды выполнения приложения определяет ресурсы, которые система Windows загружает для вашего приложения, а также языки, используемые для форматирования дат, времени, чисел и других компонентов. См. раздел [Глобализации форматов даты/времени/чисел](use-global-ready-formats.md).

**Примечание**. Если язык профиля пользователя и языка манифеста приложения являются региональными вариантами друг друга, в качестве языка среды выполнения приложения будет использоваться региональный вариант языка пользователя. Например, если пользователь говорит на языке en-GB, а приложение поддерживает en-US, языком среды выполнения приложения будет en-GB. Это гарантирует, что формат дат, времени и чисел будет лучше соответствовать предпочтениям пользователя (en-GB), но локализованные ресурсы все равно будут загружаться на языке, поддерживаемом приложением (en-US).

## <a name="qualify-resource-files-with-their-language"></a>Задание квалификаторов языка для файлов ресурсов
Файлам ресурсов или их папкам следует присваивать квалификаторы ресурсов языка. Дополнительные сведения о квалификаторах ресурсов см. в разделе [Адаптация ресурсов с учетом языка, масштаба, высокой контрастности и других квалификаторов](../../app-resources/tailor-resources-lang-scale-contrast.md). Файл ресурсов может быть изображением (или другим ресурсом) или файлом контейнера ресурсов, например *. resw* , содержащим текстовые строки.

**Примечание** . Даже ресурсы на языке приложения по умолчанию должны указывать квалификатор языка. Например, если языком приложения по умолчанию является английский (США), укажите ресурсы в качестве `\Assets\Images\en-US\logo.png`.

- Windows выполняет комплексное сопоставление, включая региональные варианты, такие как en-US и EN-GB. При необходимости включите подтег Region. См. раздел [Как система управления ресурсами сопоставляет языковые теги](../../app-resources/how-rms-matches-lang-tags.md).
- Укажите вспомогательный тег скрипта языка в квалификаторе, если для данного языка не задано значение "подавлять". Например, вместо zh-CN или zh-TW используйте zh-Hant, zh-Hant-TW или zh-Ханс (Дополнительные сведения см. в разделе [реестра IANA на языке субтаг](https://www.iana.org/assignments/language-subtag-registry)).
- Для языков с одним стандартным диалектом не нужно включать квалификатор Region. Например, используйте ja вместо ja-JP.
- Некоторые инструменты и другие компоненты, такие как средства машинного перевода, могут находить специальные языковые теги, например информацию о региональном диалекте, необходимую для понимания данных.

### <a name="not-all-resources-need-to-be-localized"></a>Не все ресурсы должны быть локализованы

Локализация может быть необязательной для всех ресурсов.

- Как минимум убедитесь, что все ресурсы существуют на языке по умолчанию.
- Для тесно связанных языков может быть достаточно подмножество некоторых ресурсов (частичная локализация). Например, не все пользовательские интерфейсы приложения могут быть переведены на каталанский, если приложение содержит полный набор ресурсов на испанском языке. Для пользователей, говорящих на каталанского, а затем на испанском, ресурсы, недоступные в каталанского, отображаются на испанском языке.
- Некоторые ресурсы могут потребовать исключений для определенных языков, а большая часть других ресурсов сопоставляется с общим ресурсом. В этом случае следует отметить ресурс, предназначенный для использования со всеми языками, с неопределенной меткой языка "und". Windows интерпретирует тег языка "und" как подстановочный знак (аналогично "\*") в том, что он соответствует верхнему языку приложения после любого другого совпадения. Например, если несколько ресурсов для финского языка отличаются, а остальные ресурсы одинаковы для всех языков, финский ресурс необходимо отметить языковым тегом финского языка, а остальные — тегом «und».
- Для ресурсов, основанных на языке скрипта, например шрифта или высоты текста, используйте неопределенный тег языка с указанным скриптом: ' und-&lt;script&gt;'. Например, для латинских шрифтов используйте `und-Latn\\fonts.css`, а для кириллических — `und-Cryl\\fonts.css`.

## <a name="set-the-http-accept-language-request-header"></a>Установка заголовка запроса, определяющего допустимый язык для HTTP
Подумайте, сравнимы ли уровни локализации вызываемых вами веб-служб и вашего приложения. HTTP-запросы, выполняемые из приложений Windows в обычных веб-запросах и XMLHttpRequest (XHR), используют стандартный заголовок запроса Accept-языка HTTP. По умолчанию этот заголовок HTTP задается в соответствии со списком языков профиля пользователя. Каждый язык в списке дополнительно раскрывается, отображая язык, который не зависит от региона, и весовой коэффициент (q). Например, список языков пользователя fr-FR и en-US в заголовке запроса, определяющем допустимый язык для HTTP (HTTP Accept-Language), раскрывается соответственно: fr-FR, fr; en-US, en ("fr-FR,fr;q=0.8,en-US;q=0.5,en;q=0.3"). Однако, если пользовательский интерфейс приложения прогноза погоды (например) отображается на французском языке (Франция), а в списке предпочтений пользователя первым стоит немецкий язык, чтобы внутри приложения сохранялось языковое соответствие, вам, возможно, придется явным образом запросить у службы французский язык (Франция).

## <a name="apis-in-the-windowsglobalization-namespace"></a>API-интерфейсы в пространстве имен Windows.Globalization
Обычно для определения языка API-интерфейсы в пространстве имен [**Windows.Globalization**](/uwp/api/windows.globalization?branch=live) используют список языков среды выполнения приложения. Если ни один из языков не имеет совпадающего формата, используются региональные параметры пользователя. Это тот же самый язык, который применяется в системных часах. Языковой стандарт пользователя доступен на странице **Параметры** > **время & язык** > **регион & язык** > **Дополнительные Дата, время, & региональные параметры** > .**измените форматы даты, времени или чисел**. Кроме того, API-интерфейсы **Windows.Globalization** позволяют задать список языков для использования в приложении вместо списка языков среды выполнения приложения.

Использование класса [**Language**](/uwp/api/windows.globalization.language?branch=live) дает возможность получать такие подробные сведения о конкретном языке, как сценарий языка, отображаемое и исходное имя.

## <a name="use-geographic-region-when-appropriate"></a>Используйте географический регион, когда это необходимо
В поле **Параметры** > **время & язык** > **регион & язык** > **страна или регион**, пользователь может указать свое расположение в мире. Чтобы выбрать содержимое для показа на экране, вместо языка можно использовать этот параметр. Например, новостное приложение может по умолчанию отображать содержимое из этого региона.

В коде можно получить доступ к этому параметру, используя свойство [**GlobalizationPreferences.HomeGeographicRegion**](/uwp/api/windows.system.userprofile.globalizationpreferences.HomeGeographicRegion).

Использование класса [**GeographicRegion**](/uwp/api/windows.globalization.geographicregion?branch=live) позволяет получить подробные сведения о конкретном регионе, такие как его отображаемое и исходное имя, а также используемые валюты.

## <a name="examples"></a>Примеры
В следующей таблице приводятся примеры того, как пользователь мог бы увидеть различные параметры языка и региона в пользовательском интерфейсе приложения.

<table border="1">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Список языков манифеста приложения</th>
<th align="left">Список языков профиля пользователя</th>
<th align="left">Переопределение основного языка приложения (необязательно)</th>
<th align="left">Список языков среды выполнения приложения</th>
<th align="left">Что пользователь видит в приложении</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Английский (Великобритания) (по умолчанию); немецкий (Германия)</td>
<td align="left">Русский</td>
<td align="left">нет</td>
<td align="left">Русский</td>
<td align="left">Пользовательский интерфейс: английский (Великобритания)<br>Даты/время/числа: английский (Великобритания)</td>
</tr>
<tr>
<td align="left">Немецкий (Германия) (по умолчанию); французский (Франция); итальянский (Италия)</td>
<td align="left">Французский (Австрия)</td>
<td align="left">нет</td>
<td align="left">Французский (Австрия)</td>
<td align="left">Пользовательский интерфейс: французский (Франция) (запасной вариант для французского языка (Австрия))<br>Даты/время/числа: французский (Австрия)</td>
</tr>
<tr>
<td align="left">Английский (США) (по умолчанию); французский (Франция); английский (Великобритания)</td>
<td align="left">Английский (Канада); французский (Канада)</td>
<td align="left">нет</td>
<td align="left">Английский (Канада); французский (Канада)</td>
<td align="left">Пользовательский интерфейс: английский (США) (запасной вариант для английского языка (Канада))<br>Даты/время/числа: английский (Канада)</td>
</tr>
<tr>
<td align="left">Испанский (Испания) (по умолчанию); испанский (Мексика); испанский (Латинская Америка); португальский (Бразилия)</td>
<td align="left">Английский (США)</td>
<td align="left">нет</td>
<td align="left">испанский (Испания)</td>
<td align="left">Пользовательский интерфейс: испанский (Испания) (используется язык по умолчанию, так как запасного варианта для английского языка нет)<br>Даты/время/числа: испанский (Испания)</td>
</tr>
<tr>
<td align="left">Каталанский (по умолчанию); испанский (Испания); французский (Франция)</td>
<td align="left">Каталанский; французский (Франция)</td>
<td align="left">нет</td>
<td align="left">Каталанский; французский (Франция)</td>
<td align="left">Пользовательский интерфейс: в основном каталанский, местами французский (Франция), так как не все строки представлены на каталанском языке<br>Даты/время/числа: каталанский</td>
</tr>
<tr>
<td align="left">Английский (Великобритания) (по умолчанию); французский (Франция); немецкий (Германия)</td>
<td align="left">Немецкий (Германия); английский (Великобритания)</td>
<td align="left">Английский (Великобритания) (выбранный пользователем в пользовательском интерфейсе программы)</td>
<td align="left">Английский (Великобритания); немецкий (Германия)</td>
<td align="left">Пользовательский интерфейс: английский (Великобритания) (переопределение языка)<br>Даты/время/числа: английский (Великобритания)</td>
</tr>
</tbody>
</table>

>[!NOTE]
> Список стандартных кодов стран и регионов, используемых корпорацией Майкрософт, см. в [официальном списке стран или регионов](/windows/uwp/publish/supported-languages).

## <a name="important-apis"></a>Важные API
* [GlobalizationPreferences.Languages](/uwp/api/windows.system.userprofile.globalizationpreferences.Languages)
* [ApplicationLanguages.ManifestLanguages](/uwp/api/windows.globalization.applicationlanguages.ManifestLanguages)
* [PrimaryLanguageOverride](/uwp/api/Windows.Globalization.ApplicationLanguages.PrimaryLanguageOverride)
* [ResourceContext.QualifierValues](/uwp/api/windows.applicationmodel.resources.core.resourcecontext.QualifierValues)
* [ResourceContext.Languages](/uwp/api/windows.applicationmodel.resources.core.resourcecontext.Languages)
* [ApplicationLanguages.Languages](/uwp/api/windows.globalization.applicationlanguages.Languages)
* [Windows. Globalization](/uwp/api/windows.globalization?branch=live)
* [Язык](/uwp/api/windows.globalization.language?branch=live)
* [GlobalizationPreferences.HomeGeographicRegion](/uwp/api/windows.system.userprofile.globalizationpreferences.HomeGeographicRegion)
* [GeographicRegion](/uwp/api/windows.globalization.geographicregion?branch=live)

## <a name="related-topics"></a>Связанные темы
* [Тег языка BCP-47](https://tools.ietf.org/html/bcp47)
* [Реестр подтегов языков IANA](https://www.iana.org/assignments/language-subtag-registry)
* [Адаптация ресурсов с учетом языка, масштаба, высокой контрастности и других квалификаторов](../../app-resources/tailor-resources-lang-scale-contrast.md)
* [Поддерживаемые языки](../../publish/supported-languages.md)
* [Глобализация форматов даты, времени и чисел](use-global-ready-formats.md)
* [Как система управления ресурсами сопоставляет языковые теги](../../app-resources/how-rms-matches-lang-tags.md)

## <a name="samples"></a>Примеры
* [Пример ресурсов и локализации приложения](https://code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa)
