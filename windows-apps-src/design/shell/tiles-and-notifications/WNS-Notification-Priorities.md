---
title: Приоритеты уведомлений WNS
description: Описание различных приоритетов, которые можно задать для уведомления
ms.date: 01/10/2017
ms.topic: article
keywords: Windows 10, UWP, API WinRT, WNS
localizationpriority: medium
ms.openlocfilehash: 3310b34b2748bd684e46e04775c973680f8e03a9
ms.sourcegitcommit: 445320ff0ee7323d823194d4ec9cfa6e710ed85d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2019
ms.locfileid: "72282243"
---
# <a name="wns-notification-priorities"></a>Приоритеты уведомлений WNS
Установив приоритет уведомления с простым заголовком для сообщений POST в WNS, вы можете управлять доставкой уведомлений в ситуациях, зависящих от аккумулятора.

## <a name="power-on-windows"></a>Power On Windows
Так как больше пользователей работает только на устройствах с питанием от аккумулятора, минимизация энергопотребления стало стандартным требованием для всех приложений. Если приложения потребляют больше энергии, чем предоставленное ими значение, пользователи могут удалить эти приложения. Хотя операционная система Windows снижает энергопотребление на батарее, когда это возможно, ответственность за эффективность работы приложения. 

Приоритеты WNS — это один из способов переместить некритическую работу за пределы аккумулятора. Приоритеты WNS сообщают системе, какие уведомления должны доставляться мгновенно, и что может ожидать, пока устройство не будет подключено к источнику питания. С помощью этих указаний система может доставлять уведомления на точное время, наиболее ценное для пользователя и приложения. 

## <a name="power-modes-on-the-device"></a>Режимы питания на устройстве
Каждое устройство Windows работает с различными режимами электропитания (батарея, экономия заряда и заряд аккумулятора), и пользователи предполагают разные поведения приложений в различных режимах электропитания. Если устройство включено, все уведомления должны доставляться. В режиме экономии заряда следует доставлять только самые важные уведомления. Пока устройство подключено, можно выполнить синхронизацию или несинхронизированные критические операции.

Windows не знает, какие уведомления важны для любого пользователя или приложения, поэтому система полностью полагается на приложения, чтобы установить правильный приоритет для своих уведомлений. 

## <a name="priorities"></a>Приоритеты
Существует четыре приоритета, которые могут использоваться приложением при отправке push-уведомлений. Приоритет задается для отдельных уведомлений, что позволяет выбрать, какие уведомления должны быть доставлены мгновенно (например, сообщение IM) и какие из них могут ожидать (например, можно обратиться к обновлениям фотографий).

Ниже перечислены приоритеты. 

|    Priority    |    Переопределение пользователя    |    Описание    |    Пример    |
|----------------|---------------------|-------------------|---------------|
|    Высокий    |    Да — пользователь может блокировать все уведомления из приложения или может препятствовать регулированию приложения в режиме экономии энергии.    |    Наиболее важные уведомления, которые должны быть немедленно доставлены в любой ситуации, когда устройство может получать уведомления. Такие вещи, как вызовы VoIP или критические оповещения, которые должны относить устройство к этой категории.    |    Звонки VoIP, критические по времени оповещения    |
|    Средний    |    Да — пользователь может блокировать все уведомления из приложения или может препятствовать регулированию приложения в режиме экономии энергии.    |    Это все, что не так важно, но не нужно сразу же, но пользователи будут раздражен, если они не работают в фоновом режиме.    |    Синхронизация дополнительной учетной записи электронной почты, Обновление динамических плиток.    |
|    Низкий    |    Да — пользователь может блокировать все уведомления из приложения или может препятствовать регулированию приложения в режиме экономии энергии.    |    Уведомления, имеющие смысл только в том случае, если пользователь использует устройство или если фоновое действие имеет смысл. Они кэшируются и не обрабатываются до тех пор, пока пользователь не войдет в систему или не подключается к устройству.    |    Состояние контакта (в сети или вне сети)    |
|    Очень низкий     |    Нет — он не может препятствовать регулированию уведомлений с низким приоритетом в режиме экономии энергии.    |    Это почти то же самое, что и низкий приоритет, за исключением того, что пользователи не могут переопределять политику экономии заряда. Эти уведомления никогда не будут доставляться в заставку аккумулятора.    |    Синхронизация файлов для службы синхронизации.    |

Обратите внимание, что многие приложения будут иметь уведомления с разными приоритетами в течение жизненного цикла. Так как приоритет установлен для каждого уведомления, это не является проблемой. Приложение VoIP может отправить уведомление с высоким приоритетом для входящего звонка, а затем следовать ему с низким приоритетом, когда контакт переходит в режим «в сети». 

## <a name="setting-the-priority"></a>Установка приоритета

Установка приоритета для запроса уведомления выполняется в дополнительном заголовке запроса POST, `X-WNS-PRIORITY`. Это целочисленное значение от 1 до 4, которое соответствует приоритету: 

| Имя приоритета | Значение X-WNS-PRIORITY | По умолчанию для: |
|---------------|----------------------|------------------|
| Высокий | 1 | Всплывающие уведомления |
| Средняя | 2 | Плитки и эмблемы |
| Низкий | 3 | Необработанное |
| Очень низкий | 4 |  |

Для обеспечения обратной совместимости Установка приоритета не требуется. Если приложение не устанавливает приоритет своих уведомлений, система будет предоставлять приоритет по умолчанию. Значения по умолчанию показаны на приведенной выше диаграмме и соответствуют поведению существующих версий Windows. 

## <a name="detailed-listing-of-desktop-behavior"></a>Подробный список поведения рабочего стола 

Если вы отправите приложение на множество различных SKU Windows, лучше всего следовать приведенной выше диаграмме. 

Ниже перечислены более конкретные Рекомендуемые варианты поведения для каждого приоритета. Это не гарантирует, что каждое устройство будет работать в точности в соответствии с диаграммой. Поставщики вычислительной техники могут настроить поведение по-разному, но большинство из них близко к этой диаграмме. 

| Состояние устройства    | ПРИОРИТЕТЫ Высокий    |    ПРИОРИТЕТЫ Средний        | ПРИОРИТЕТЫ Низкий    |    ПРИОРИТЕТЫ Очень низкий    |
|-------------------------------------------------------|----------------------------------------------------|----------------------------------------------------|----------------------------------------------------|--------------------------|
|    Экран включен или подключен    |    Отправить    |    Отправить    |    Отправить    |    Отправить    |
|    Экран и питание от аккумулятора    |    Отправить    |    Если пользователь исключен: Доставка else: пакетная     |    Если пользователь исключен: Доставка else: Cache *    |    Кэш    |
|    Экономия заряда включена    |    Если пользователь исключен: Доставка else: Cache    |    Если пользователь исключен: Доставка else: Cache    |    Если пользователь исключен: Доставка else: Cache    |    Кэш     |
|    От аккумулятора + заставка аккумулятора включено + экран выключен    |    Если пользователь исключен: Доставка else: Cache    |    Если пользователь исключен: Доставка else: Cache    |    Если пользователь исключен: Доставка else: Cache    |    Кэш    |

Обратите внимание, что уведомления с низким приоритетом будут доставляться по умолчанию для экрана и аккумулятора только для устройств на базе Windows Phone. Это маинтиан совместимость с существовавшей ранее политикой MPNS. Также обратите внимание, что четвертая и пятая строки одинаковы, просто вызывая различные сценарии.

Чтобы исключить приложение в режиме экономии заряда, пользователи должны переходить в раздел "Использование аккумулятора приложением" в параметрах и выбрать "разрешить приложению выполнять фоновые задачи". Этот выбор пользователей исключают приложение от экономии заряда, чтобы получать уведомления о высокой, средней и низкой важности. Вы также можете вызвать [API баккграундексекутионманажер, чтобы программно](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.backgroundexecutionmanager.requestaccesskindasync#Windows_ApplicationModel_Background_BackgroundExecutionManager_RequestAccessKindAsync_Windows_ApplicationModel_Background_BackgroundAccessRequestKind_System_String_) запросить разрешение пользователя.  

## <a name="related-topics"></a>См. также
- [Обзор служб push-уведомлений Windows (WNS)](windows-push-notification-services--wns--overview.md)
- [Запрос разрешения на запуск в фоновом режиме](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.backgroundexecutionmanager.requestaccesskindasync#Windows_ApplicationModel_Background_BackgroundExecutionManager_RequestAccessKindAsync_Windows_ApplicationModel_Background_BackgroundAccessRequestKind_System_String_)
