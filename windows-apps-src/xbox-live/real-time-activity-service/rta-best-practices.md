---
title: Рекомендации для возврата
description: Дополнительные сведения о рекомендациях при использовании службы Live действий в реальном времени для Xbox.
ms.assetid: 543b78e3-d06b-4969-95db-2cb996a8bbd3
ms.date: 04/04/2017
ms.topic: article
keywords: Xbox live, xbox, игры, универсальной платформы Windows, windows 10, xbox, один, действие в режиме реального времени
ms.localizationpriority: medium
ms.openlocfilehash: 7733aab9330c316ad5938cf9a2ef763e06f19b9a
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57613569"
---
# <a name="real-time-activity-rta-best-practices"></a>Рекомендации по действия (возврата) режиме реального времени
Эти рекомендации помогут выполнить максимально эффективно использовать заголовок вашей возврата.


## <a name="the-basics"></a>Основные сведения

Возврата используют WebSocket сеансы для создания постоянного соединения с клиентом. Это, как служба будет доставлять статистики для вас. Когда клиенту необходимо отправить запрос соединения с проверкой подлинности и возврата будет использовать маркер, предоставленный в запросе для проверки подключения могут быть созданы и затем установить его.

После установления соединения приложение может отправить запросы для подписки на конкретной статистики. Для успешной подписки возврата возвращает текущее значение и некоторые дополнительные метаданные, такие как тип статистического показателя, как часть полезных данных ответа. Затем возврата будет пересылать все обновления, которые происходят к статистике, хотя он подписан.

Если название не требует обновления в режиме реального времени на статистику, его следует прервать его подписки для этой статистики.


## <a name="handling-disconnects"></a>Отключает обработку

Заголовки следует иметь в виду, что по истечении срока действия токена проверки подлинности для пользователя их сеанс будет прекращен службой. Заголовок должен уметь обнаруживать, когда такое событие происходит, подключение и повторно подписаться на всех статистических данных, ранее подписаться.

Возврата подключения закрываются через два часа намеренно, что вынудит клиент для повторного подключения. Это делается потому, что для экономии пропускной способности сообщений кэшируется маркер проверки подлинности для подключения. В конечном итоге истечет этот маркер. Закрыв подключение и вынудит клиент для повторного подключения клиент принудительно обновить токен аутентификации.

Клиент также может получить разорвано, из-за пользователя поставщик услуг Интернета, возникли проблемы, или при приостановке процесс для заголовка. Когда это происходит, чтобы сообщить об этом клиенту возникает событие WebSocket. Как правило, рекомендуется подход, чтобы иметь возможность обрабатывать отключается от службы.

> [!WARNING]
> Если клиент использует возврата для многопользовательской сеансов и отключен в течение 30 секунд, [многопользовательские Directory(MPSD) сеанса](../multiplayer/multiplayer-appendix/multiplayer-session-directory.md) обнаруживает, что возврата сеанс закрывается и запускает пользователя из сеанса. Он работает для возврата клиенту обнаружить, когда соединение закрывается и инициировать выполняется попытка повторного подключения и повторно подписаться перед MPSD завершает сеанс.

## <a name="managing-subscriptions"></a>Управление подписками

Относительно управления подписками, по истечении срока действия маркера, название должен отслеживать все время которого были внесены подписок. После успешной подписки возврата возвращает уникальный идентификатор для каждой подписки статистики. В этой статистике все будущие обновления идентификатор будет использоваться вместо имени статистики. Это позволяет сэкономить пропускную способность. Клиенты отвечают за обеспечение свои собственные сопоставления статистики для возврата идентификаторы подписки.


## <a name="unsubscribing"></a>Отмена подписки

Наличие неиспользуемых подписок не рекомендуется. Служба ограничивает количество подписок, к которым у пользователя может быть на заголовок в определенный момент времени. Если производится подписка на все, что и все, что, вы можете достигнуть предела, и это может помешать подписки на важные статистические данные. (Дополнительные сведения об ограничениях подписки см. в разделе **регулирует**далее в этом разделе.)

Например название может потребоваться только подписки на определенные сцены. Когда пользователь вводит сцены, название должна быть подписана. Когда пользователь покидает сцены, связанная с этим следует отменять подписку. Аналогично имеется сообщение unsubscribe-all, который может использоваться, если подписки не требуются.

После отмены подписки, идентификатор подписки для этой статистики больше не используется.


## <a name="awareness-of-latent-items-in-the-queue"></a>Осведомленность о скрытых элементов в очереди

При отказе от подписки из статистического показателя, вполне возможно, что имеется обновление статистики еще не закончили процесс достижения вашего клиента. Таким образом даже если название просто отменил подписку на статистику, имейте в виду, что он все равно может получить обновление или две связанные с этой статистике.

Рекомендуется игнорировать обновления статистики, когда идентификатор подписки не распознается.


## <a name="ignore-messages-you-do-not-understand"></a>Игнорировать сообщения, вы не понимаете

Вполне возможно, что будет обновляться из протокола сообщений. Чтобы ваше приложение зависит от новых сообщений, рекомендуется что название просто отменить типы неизвестное сообщение.


## <a name="throttles"></a>Регулирует

Возврата применяет определенные интервалы повтора в службе:

-   UserStats: 1000
-   Наличие: 2500

Если клиент достигает предела регулирования, которые он будет либо сообщение об ошибке в процессе вызова отказаться от подписки или подписки, или он будет отключен. В любом случае Дополнительные сведения о регулирования ограничение, который был нажат будут доступные для клиента, а также сообщение об ошибке или отключить сообщение.

При разработке название, учитывайте эти понятия. Если вы выполняете-то экстремальное, вы потому, что служба может быть регулирует вызовов может воспользоваться возможностями сниженной функциональности приложения. Право, служба позволяет 1000 подписок на статистические данные для каждого экземпляра приложения. В Кроме того, экземпляр приложения можно также подписаться на пользователя Длина списка людей всего наличие обновлений. Этот номер настраивается, поэтому он может измениться в будущих версиях.
