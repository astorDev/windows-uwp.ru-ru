---
title: Подключение хранилища рекомендации
description: Рекомендации о том, как обеспечить максимальную производительность и возникнуть из подключенных хранилища
ms.date: 02/27/2018
ms.topic: article
keywords: Xbox live, xbox, игры, универсальной платформы Windows, windows 10 для настольных ПК, xbox, одно подключение хранилища
ms.localizationpriority: medium
ms.openlocfilehash: dbdb8f95e9afc44a3280d897e74f74d327f94b97
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57632929"
---
# <a name="connected-storage-best-practices"></a>Рекомендации по использованию подключенного хранилища

Разработчикам следует разделить сохранение данных на логические группы, являющиеся независимое обновление, вместо того чтобы писать монолитных сохраняет. Это позволяет заголовки уменьшить объем данных, создаваемых в различных ситуациях, снижения объема используемой обоих локального ресурса и отправка использование пропускной способности. Интерфейс API позволяет также заголовки обновить более одного элемента данных в атомарной операции, который гарантированно выполняются успешно полностью, либо не вступают в силу вообще (например, в случае катастрофического сбоя среднего "Сохранить").

Так как Xbox One позволяет пользователям быстро переключаться между заголовков, разработчикам следует разрабатывать названий будет держать готовыми для сохранения на краткое уведомление в ожидании получения Suspend событие, которое может выполняться практически в любой момент их текущее состояние. Подключение API службы хранилища использует ОЗУ за пределами резервирование заголовок как первая точка хранения, чтобы обеспечить максимальную скорость title записи во время краткосрочного приостановки временного окна. Затем система сохраняет данные в долговременном хранилище, согласовывает его с любой другой операции записи данных с момента последней передачи и планирует передачи данных. Сохраняется и в очередь для отправки, система после надежными для различных сбоев, таких как сбой сетевого подключения потери или питания.

## <a name="when-to-load-a-users-connected-storage-space-data"></a>Причины для загрузки данных места хранения, подключенные

Время выполнения для загрузки пользователя подключенных данных места могут различаться. Приложения должны пользоваться этим способом, во время выполнения основной, а не в ответ на начиная пользователя выйти из системы или в ответ на получение уведомления suspend от системы.
Как правило, приложения должны загрузиться подключенных дискового пространства как пользователь входит в систему и указывает большие усилия для воспроизведения, если игры не требуется режим, в котором он не определенные функциональные возможности сохранения. Также следует выравнивание загрузки подключенных дискового пространства с длинные последовательности загрузки данных, чтобы операции могли выполняться параллельно.
После загрузки данных места хранения, подключенные приложения его необходимо сохранять это значение для будущих сохраняет. Сохраняя подключенных дисковое пространство, со временем не негативное воздействие на производительность или надежность. Поскольку загрузка подключенных дисковое пространство вызывает проверку синхронизации с облаком, если система подключена к сети, освобождения и повторной загрузке пользователя подключенных дискового пространства при медленных или ненадежных сетевых условий может привести к пользователю видеть синхронизации пользовательского интерфейса пока системное время ожидания. Подключенного хранилища, пробелы не обязательно должны быть явно освобожден заставить синхронизацией облака. Один раз обработчик завершения, указанное в `SubmitUpdatesAsync` вызов вернулся с `AsyncStatus::Completed`, система берет на себя синхронизацию с облаком ли приложение освобождает `ConnectedStorageSpace` объекта.

## <a name="when-to-save"></a>Когда следует сохранить

Каждый раз, когда приложение получает уведомление suspend, приложение по крайней мере следует сохранить важные данные, позволяя в системе, чтобы вернуться к используемому в состоянии для пользователя.

Если проекту game использует периодических, автоматическое или сохраняет инициированного пользователем, подключенные хранилища может вызываться чаще, чем при получении уведомления suspend; Это является хорошим способом снизить риск потери данных из-за отключения питания или сбой.
Если вы разрабатываете свою игру с помощью XDK, когда пользователь выходит из системы, объект пользователя для этого пользователя остается допустимым и в этот момент приложение может выполнить окончательную операции сохранения с помощью подключения хранилища.

## <a name="robustness"></a>Надежность

Так как сохраненные данные всегда синхронизируются в облако, ошибка в сохраненные данные и код приложения, которая приводит к сбою в работе приложения может резервное копирование в облаке и распределенных между устройствами. Чтобы вызвать отказ в приложение, которое вызывает сбой при каждом запуске, разработать приложение, чтобы убедиться, что:

-   Пользователи могут попасть точки в приложении, с которой они могут управлять сохраненное состояние, даже если некоторые сохраненные данные имеет неправильный формат.
-   Приложение могло обработать поврежденных данных автоматически, восстановления столько данных, как и повторная инициализация все остальное безопасного состояния.

## <a name="use-cases-for-save-game-designs"></a>Варианты использования для игровых сохранения схемы

Конструкция игры сохранение системы, которая дает максимально эффективно использовать контейнеры в подключенных дискового пространства зависит от типа приложения:

### <a name="single-save"></a>Единый сохранения

Для приложений, использующих один стиле кампании сохранить система, например первый кораблей person:

-   Поместить все данные в одном контейнере и всегда запись в тот же контейнер, идентифицируемое по его имени.
-   Попробуйте предоставить возможность сбросить все данные, которые будут удалены все сохраненные данные пользователя, в том случае, если он хочет начать воспроизведение приложения с самого начала с помощью нет предыдущего процесса сохраняются в памяти.

### <a name="multiple-saves"></a>Сохраняет несколько

Для приложений, которые имеют фиксированное число сохранить слотов, давайте предположим, что пять существует два способа использования контейнеров для сохранения данных игры:

-   Все 5 слоты в пределах одного контейнера-name Store с помощью 1 BLOB-объектов для каждого сохранить слота. С помощью этого метода все слоты 5 будут полностью синхронизированные и доступны, или, в случае, синхронизация завершается сбоем в любой момент ни один из слотов будут синхронизированы и останется в предыдущее состояние. Если пользователь играет приложение в автономный режим на две разные консоли, сохранение хода выполнения в слот 1 в первой консоли, так и в слоте 2 на второй консоли, пользователь должен выбрать, какие данные для сохранения о подключении обе консоли Xbox Live; объединенную логику для контейнеров, вызовет конфликт.
-   Store каждого слота в контейнере со своим именем. Это позволяет независимым хода выполнения в каждом гнезде, даже на нескольких компьютерах, которые могут быть вне сети. Тем не менее если пользователь отменяет получаться через синхронизацию, это только некоторые из этих слотов, могут быть доступны во время текущего сеанса; Некоторые из их может не завершил загрузку. В этом случае пользователь увидит, что синхронизация не была завершена, и что некоторые облачные данные не находится в локальной консоли.

Какой подход используется, должно предоставить пользователя с помощью пользовательского интерфейса для удаления отдельных сохраняет из слотов.

### <a name="warning"></a>Тревожное

**Не храните данные, зависящие от по контейнерам.** Не хранить данные с зависимостями в рамках более одного контейнера. Контейнеры могут быть разделены из-за неполной синхронизации, отключения питания или другими ошибками. Данные, хранящиеся в одном контейнере должны быть самостоятельными и согласованным.

### <a name="tips"></a>Советы

**Не рекомендуйте пользователям не выключения консоли или переход отсюда.** Название должно не допустить пользователями выключения консоли или переходе от приложения, при сохранении. На Xbox 360 при выключении системы во время название сохранения, данные пользователя не сохраняются. В службе Xbox One название получает событие suspend и имеет 1 секунда для использования подключенных API службы хранилища для сохранения состояния. Система обеспечивает правильно фиксируются жестком диске данных до полностью выключается или переходит в состояние низкого энергопотребления. Один и тот же процесс приостановки возникает, если пользователь извлекает заголовок вашей диск для воспроизведения еще один.

**Сохранить подключение дисковых пространств.** Хранит объекты ConnectedStorageSpace, а не пытаться загружать их каждый раз при возникновении события, чтение или запись. Существуют негативного влияния на производительность или надежность, из-за сохранение объекта ConnectedStorageSpace в течение длительного времени.

**Уменьшайте размер данных.** Небольшой размер сохраненных данных. Все данные пользователей в подключенных хранилище передаются в облако при консоль доступна в сети. Оптимизация форматирования данных для обеспечения минимальной задержки и пропускной способности.

**Убедитесь, что пользователи не против не был сохранен.** Проверьте наличие ошибок OutOfLocalStorage, возвращаемого из GetForUserAsync и SubmitUpdatesAsync и запросов пользователей, см. в разделе, если они действительно хотите воспроизвести без сохранения. Если пользователь укажет, желающие сохранить игры, повторите операцию.

**Проверьте, квоты и запрос для освобождения пространства пользователя.** Проверьте наличие QuotaExceeded ошибки, возвращенный SubmitUpdatesAsync. Если приложение получает это сообщение, уведомление пользователей, что они не удается сохранить любые дополнительные данные, пока они не освободить некоторое пространство и представлять их с помощью пользовательского интерфейса, который позволит сделать это. Каждый пользователь получит 256- или 64 МБ данных в приложение, и каждая книга XDK получает 64 МБ хранилища на уровне компьютера, который является локальным для консоли.

**Сохраните состояние меню для восстановления более поздней версии.** Сохраните состояние меню и другие параметры приложения, Дополнительно к скидке core игровых данных. Если пользователь играет другое приложение и снова обращается к вам, восстановите их в зависимости от контекста соответствующего меню состояние.
Реагировать на изменения вошедшего в систему пользователя. Пользователи могут входить, когда приложения приостановлен. При возобновлении приложения, его следует определить, изменилась ли набор пользователей, выполнившего вход. Рассмотрите возможность перехода на соответствующее место в приложении, например меню, когда это происходит.

**Предоставляет пользовательский Интерфейс для управления сохраненными данными.** Должно предоставить пользовательский Интерфейс, который дает пользователям возможность управлять их сохраненные данные в приложении. Для приложений с помощью автоматического сохранения системы приложение должно предложить параметр сброса сохраненных данных, чтобы пользователи могли сбросить состояние по умолчанию play.

**Убедитесь, что пользователи всегда могут попасть в пользовательский Интерфейс для управления сохраненные игры.** Убедитесь, что приложение всегда сможет связаться с его пользовательский Интерфейс управления для сохраненных игр, даже при наличии коляска сохраненные данные. Если сохраненные данные пользователя становится может быть прочитан из-за повреждения ошибки или данные приложения, приложения пользователи должны иметь возможность восстановить до состояния, которые не ломаются или предотвратить их воспроизведение.