---
title: Обзор интегрированного многопользовательского режима Xbox
author: KevinAsgari
description: Узнайте об интегрированном многопользовательском режиме Xbox (XIM)— универсальном решении для многопользовательской игры, сетевого взаимодействия и чата в играх Xbox Live.
ms.assetid: edbb28e6-1b6c-4f12-a9c6-fa8961de99a8
ms.author: kevinasg
ms.date: 04/04/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: xbox live, xbox, игры, uwp, windows 10, xbox one
ms.localizationpriority: medium
ms.openlocfilehash: 5af9a5c386dc620c19183747750081ea1bd5a66d
ms.sourcegitcommit: db09dcb08da5995c46c2729896e56be3774ee5ba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/07/2018
ms.locfileid: "1563402"
---
# <a name="xbox-integrated-multiplayer-overview"></a>Обзор интегрированного многопользовательского режима Xbox

 Интегрированный многопользовательский режим (XIM)— это автономный интерфейс для удобного добавления сетевого взаимодействия и функций чата в режиме реального времени в многопользовательскую игру с использованием служб Xbox Live. В его основе— несколько ключевых концепций.

 - **Сеть XIM**— логическое представление набора взаимосвязанных пользователей, участвующих в определенном многопользовательском взаимодействии, а также базовое состояние, описывающее эту коллекцию. Участники не могут находиться в нескольких сетях XIM одновременно, но могут без проблем перемещаться из одной концептуальной сети XIM в другую.
 - `xim_player` - Объект, представляющий отдельного пользователя, который выполнил вход на локальное или удаленное устройство и участвует в сети XIM. Отдельный физический пользователь, который присоединяется к одной и той же сети XIM, затем покидает ее и присоединяется снова, считается двумя отдельными экземплярами игрока.
 - `xim_authority` - Объект, представляющий отдельную сущность с разрешением на управление единообразным представлением состояния игры в сети XIM для всех участников и ответственностью за такое управление. Использование этого объекта не является обязательным. Его функциональность в настоящее время недоступна в этом выпуске программного обеспечения.
 - `xim_state_change` - Структура, представляющая уведомление локального устройства относительно асинхронного изменения в определенном аспекте сети XIM.
 - `xim::start/finish_processing_state_changes` - Пара методов, вызываемых приложением каждый кадр пользовательского интерфейса для выполнения асинхронных операций, с целью получения результатов, которые будут обрабатываться в форме структур `xim_state_change`, а затем для освобождения соответствующих ресурсов, когда все будет готово.
 - **Поиск сочетаний**— необязательный процесс обнаружения дополнительных удаленных игроков с аналогичными интересами или уровнем навыков для участия в сети XIM (не требуя существующих социальных отношений).

В общем и целом приложение использует библиотеку, чтобы настроить набор пользователей на локальном устройстве для перемещения в сеть XIM в качестве новых игроков. Так же как экземпляры приложения на удаленных устройствах делают то же самое со своими пользователями и каждое состояние непрерывной обработки начала и конца меняется каждый кадр пользовательского интерфейса, каждый экземпляр-участник получает обновления `xim_state_change`, которые описывают локальные и удаленные `xim_player`, которые присоединяются к этой сети XIM.

В сети XIM приложение может отправлять собственные сообщения данных, связанные с игрой, например новости о перемещении аватаров. Они могут быть нацелены на других игроков или представлять собой `xim_authority`, который автоматически выбирается для расположения на одном из устройств-участников (с учетом оптимального качества сети, стабильности, репутации игрока и других факторов), чтобы приложение на этом устройстве `xim_authority` могло возвращать сообщения игрокам (обычно выполняется их слияние, чтобы повысить эффективность сети и обеспечить разрешение конфликтов). Все полученные сообщения доставляются приложению в качестве `xim_state_change`, указывая на предусмотренный источник и локальные места назначения.

Всем игрокам также автоматически предоставляется возможность голосового взаимодействия и общения в чате, если это допускают параметры конфиденциальности и конфигурация приложения. Для игроков, включивших преобразование речи в текст и текста в речь, XIM прозрачно выполнит это преобразование, чтобы доставлять текстовые сообщения чата, представляющие звук входящей речи и звук синтезированной речи в игре для исходящих сообщений чата соответственно.

Когда игрок перестает принимать участие в сети XIM (добровольно или из-за проблем с сетевым подключением), обновления `xim_state_change` предоставляются всем экземплярам приложения, указывая на то, что `xim_player` покинул игру. Если устройство, выбранное в качестве `xim_authority`, покидает игру, экземпляры приложения информируются о том, что центр управления перемещается; начинается "согласование" состояния игры: для этого в целях повторной синхронизации новому `xim_authority` предоставляется буфер данных (необязательно). Новый центр управления может интерпретировать данные согласования от всех игроков любым желаемым образом и, в свою очередь, возвращает буфер согласованных данных всем игрокам, чтобы завершить перенос центра управления и процедуру повторной синхронизации. Та же базовая процедура согласования предлагается новым устройствам-участникам, чтобы центр управления мог удобно предоставить им текущее состояние игры с точки зрения управления, когда их игроки присоединятся к сети XIM, не создавая дополнительный код. Обратите внимание, что в этом выпуске ПО изменения состояния центра управления в настоящее время не предоставляются.

Приложение может определить сеть XIM, в которой необходимо участвовать, несколькими способами. Часто приложение запускается посредством автоматического перемещения локальных пользователей в новую сеть, доступную друзьям пользователей, где локальные пользователи могут отправлять приглашения или обеспечивать возможность обнаружения их сети XIM в рамках присоединения к команде (например, через карты игроков). Как только будет выполнено социальное обнаружение пользователей, приложение может инициировать процесс поиска соответствий Xbox Live и переместить всех игроков в новую сеть XIM, которая также содержит дополнительных "сопоставленных" удаленных игроков для заполнения команд или списков оппонентов. Затем, когда многопользовательское взаимодействие завершится, экземпляры приложения смогут вернуть своих локальных игроков (и, при необходимости, изначально подобранных удаленных игроков) в новую закрытую сеть XIM или в другую произвольную сеть XIM, подобранную в ходе поиска сочетаний. Голосовой и текстовый чат доступны на протяжении всего процесса. Ключевой характеристикой этого API является простота перемещения игроков из одной сети XIM в другую. Это полностью соответствует ожиданиям к современным играм— качественным и с широким ассортиментом механизмом социального взаимодействия.

Сведения о начале работы см. в разделе [Использование XIM](xbox-integrated-multiplayer/using-xim.md).

## <a name="xims-relationship-to-other-modules"></a>Связь XIM с другими модулями

XIM предоставляет удобный единый интерфейс для игр с базовыми потребностями в многопользовательском взаимодействии. Он включает функциональность нескольких модулей, в частности модуля Xbox Services API (XSAPI) `multiplayer_manager`, библиотеки `Microsoft::Xbox::GameChat` и защищенной многопользовательской сети `Windows::Networking::XboxLive` в виде единого оптимизированного API. Это уменьшает типичный объем кода, задач и концепций, участвующих в создании многопользовательских игр, которые не требуют абсолютной гибкости или контроля. В приложениях, требования которых не соответствуют концепции упрощения XIM, однако, может оказаться целесообразно использовать компоненты напрямую.

Сеть XIM создана, чтобы устранить необходимость в управлении такими объектами, как документы сессии MPSD или сетевой транспорт, с помощью базовых компонентов. Тем не менее она не препятствует их одновременному или параллельному использованию в составе отдельного списка игроков или сетки взаимодействия. В этом случае приложение обязано обеспечить совместное использование сетевых ресурсов сетью XIM и ее собственными механизмами. В настоящее время XIM поддерживает внеполосные резервирования, чтобы упростить использование этой сети в качестве выделенного решения для чата, список пользователей в котором составляется исключительно на основе внешнего ввода.

Xbox Live предоставляет множество других функций, которые ценны для многопользовательских игр, но напрямую не участвуют в настройке многопользовательского чата и сетевого взаимодействия. Следовательно, они не рассматриваются в этом модуле. Для реализации обратной связи с игроками, достижений, списков лидеров, хранения данных и многого другого в приложениях следует использовать API Xbox Services (XSAPI).


## <a name="using-xim-as-a-dedicated-chat-solution-via-out-of-band-reservations"></a>Использование XIM в качестве выделенного решения для чата посредством внеполосных резервирований

Большинство приложений используют XIM для обработки всех аспектов объединения игроков воедино. В конце концов, именно фокус на объединении всех функций, необходимых для комплексной поддержки стандартных многопользовательских сценариев, является причиной, по которой этот механизм называется интегрированным многопользовательским режимом Xbox. Однако некоторые приложения, которые реализуют собственные сетевые решения с использованием специальных интернет-серверов, тоже захотят воспользоваться преимуществами надежного однорангового взаимодействия в чате— с низкой задержкой и низкими затратами. XIM осознает эту потребность и в настоящее время поддерживает режим расширения, чтобы воспользоваться упрощенным одноранговым взаимодействием и дополнить управление внешними игроками за пределами API XIM.

> Подробная документация об использовании XIM посредством внеполосных резервирований доступна в разделе [Резервирования XIM](xbox-integrated-multiplayer/xim-reservations.md).
