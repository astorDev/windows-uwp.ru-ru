---
title: Диспетчер многопользовательского режима
description: Дополнительные сведения о Xbox Live многопользовательские manager верхнего уровня API, разработанные для облегчения его проще реализовать многопользовательские.
ms.assetid: f3a6c8bc-4f73-4b99-ac51-aadee73c8cfa
ms.date: 04/04/2017
ms.topic: article
keywords: xbox live, xbox, игры, uwp, windows 10, xbox one
ms.localizationpriority: medium
ms.openlocfilehash: 99159b5d126c671b07d37e20f1bcd61452c7d670
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57594719"
---
# <a name="multiplayer-manager"></a>Диспетчер многопользовательского режима

Xbox Live предоставляет расширенную поддержку добавления многопользовательские функций в свои заголовки, позволяя игры соединения Xbox Live членов по всему миру.  Сюда входят сценарии форматированного подбор игроков, возможность проигрывателя для присоединения к игре друга в ход выполнения и многое другое. Тем не менее реализация Xbox Live многопользовательские напрямую с помощью API-интерфейсы многопользовательскую 2015 может быть сложной задачей, требующих большой степени разработки и проверку, чтобы убедиться, что вы следуете рекомендациям и соблюдения требований сертификации.

Многопользовательскую Manager упрощает добавление функциональных возможностей многопользовательские игры, управления сеансами и подбор игроков и предоставляя состояние и модель программирования на основе событий. Это набор интерфейсов API, которые позволяют легко реализовать многопользовательских сценариях для Xbox Live игр. Он предоставляет API, который ориентирован на многопользовательской распространенных сценариев, например многопользовательской игры с друзьями, приглашает обработки игры, обработка соединения в ход выполнения, подбор игроков и многое другое. Он поддерживает несколько локальных пользователей и облегчает название для интеграции с многопользовательскую каталога сеансов, при использовании сторонней службы подбор игроков. Многие из этих сценариев можно с помощью всего нескольких вызовов API.

## <a name="key-features"></a>Ключевые особенности
Ниже приведены основные возможности API диспетчера многопользовательскую.

* Управление сеансами легко и Xbox Live Координирующему
* Состояния и событий на основе модели программирования.
* Кроме того, соответствует XR многопользовательскую гарантирует, Xbox Live советы и рекомендации.
* Поддерживает названия одного XDK Xbox и универсальной платформы Windows.
* Реализует [блок-схемы 2015 многопользовательскую](https://developer.xboxlive.com/en-us/platform/development/education/Documents/Xbox%20One%20Multiplayer%202015%20Developer%20Flowcharts.aspx).
* Можно использовать с API-интерфейсов традиционных 2015 многопользовательскую.

>**Важные** -игры по-прежнему необходимо реализовать необходимые события для online многопользовательскую для прохождения сертификации.

## <a name="overview"></a>Обзор
Диспетчер многопользовательскую ориентирован на несколько основных понятий:
* `lobby_session` : Постоянный сеанс, используемый для управления пользователями, которые являются локальными для данного устройства, а также приглашенного друзей, которые желают играть друг с другом. Группы может воспроизводиться несколько туров карты, уровни, и т.д., игры, и сеанс lobby отслеживает этой группы core друзей (включая игроков, локальными для устройства). Как правило эта группа имеет формат, пока узел может перемещения по меню, общаться с участников группы, чтобы решить, какие игрового режима, они хотят воспроизвести.

* `game_session` : Отслеживает проигрыватели, которые играют в конкретном экземпляре игры. Например состояния гонки, карты или уровень. Можно создать новый сеанс игр с помощью `join_game_from_lobby` , который включает элементы сеанса основной.  Если член принимает приглашение, они будут добавлены в холле и игр сеанса (если есть место). Дополнительные игроков могут добавляться игр сеанс, если включен подбор игроков, но эти дополнительные проигрыватели не добавляются к сеансу основной. Это означает, что после завершения игры, игроков в сеансе lobby по-прежнему друг с другом, хотя не является дополнительной игроков подбор игроков.

* `multiplayer_member` : Представляет отдельного пользователя, вошедшего на локальном или удаленном устройстве.

* `do_work` : Обеспечивает правильное игровое состояние обновления сохраняются между заголовком и сетевая служба Xbox Live. Чтобы обеспечить наилучшую производительность, do_work() должен вызываться часто, например, один раз для каждого кадра. Предоставляет список `multiplayer_event` события обратного вызова для игры для обработки.

## <a name="state-machine"></a>Конечный автомат
`do_work()` Вызов является обязательным для обеспечения состояние хранится новая.  Для выполнения своей работы диспетчера многопользовательскую разработчики должны вызывать `do_work()` метод регулярно. Самый надежный способ сделать это — по крайней мере один раз вызвать каждого кадра. `do_work()` Возвращает быстро, когда в нем нет задания, поэтому нет причин для беспокойства о вызове его слишком часто.

Все объекты, возвращаемые API диспетчера многопользовательскую не должен считаться поточно ориентированными. Тем не менее, она предоставляет элемент управления, чтобы синхронизация потоков при его вызове из нескольких потоков. В библиотеке есть внутренняя защиты многопоточности, но будет по-прежнему необходимо реализовать собственную блокировку, если требуется, чтобы один поток для доступа к любой значениям — например, проход по списку members() в том случае, пока другой поток может вызов `do_work()`.

Диспетчер многопользовательскую сохраняет свое состояние в зависимости модели, обновление сеансов в фоновом режиме, как проигрыватели join, оставьте или, при обновлении сеансы. Чтобы избежать ошибок синхронизации потоков между потоком пользовательского интерфейса и потока игр, многопользовательскую Manager не обновляет приложение видимое состояние сеансов до вызова метода `do_work()` метод. Традиционно вы будет получать уведомления о событиях, таких как изменения сеанса в фоновом потоке, а затем для ее синхронизации с потоком пользовательского интерфейса для отображения этих изменений. С помощью диспетчера многопользовательскую эта работа выполняется автоматически в фоновом.  Вы можете вызвать `do_work()` на основной поток во время по своему выбору, чтобы получить последний моментальный снимок состояния какие многопользовательскую Manager буферизация автоматически в фоновом.

## <a name="events-and-notifications"></a>События и уведомления
Многопользовательскую Manager определяет набор значимые события (см. в разделе `multiplayer_event_type`) и уведомляет заголовок с помощью `do_work()` метод, когда они происходят. События, например удаленных проигрывателей, приходят или покидают, изменив свойства элементов, или изменение состояния сеанса. Все API-интерфейсы диспетчера многопользовательскую являются синхронными. `do_work()` Метод возвращает список событий по завершении этих асинхронных операций. Название должно обрабатывать эти события, как можно увидеть соответствующие. См. в разделе `multiplayer_event` класса документации для получения дополнительных сведений.

Для каждого события, в зависимости от типа события, необходимо привести `event_args` класс arg соответствующее событие, чтобы получить свойства событий. В следующем примере показано использование `do_work()` для обработки событий:

```cpp
auto eventQueue = mpInstance.do_work();
for (auto& event : eventQueue)
{
    switch (event.event_type())
    {
      case multiplayer_event_type::member_joined:
      {
        auto memberJoinedArgs =  std::dynamic_pointer_cast<member_joined_event_args>(event.event_args());
        HandleMemberJoined(memberJoinedArgs);
        break;
      }
      case multiplayer_event_type::session_property_changed:
      {
        auto sessionPropertyChangedArgs =  std::dynamic_pointer_cast<session_property_changed_event_args>(event.event_args());
        HandlePropertiesChanged(sessionPropertyChangedArgs);
        break;
      }
      . . .
    }
}

```

## <a name="scenarios"></a>Сценарии

В этом разделе мы рассмотрим некоторые распространенные сценарии и API-интерфейсов, который вызывается в каждом сценарии.  Также предоставляется некоторые сведения о действиях диспетчера многопользовательскую за кулисами.

* [Воспроизведение с друзьями](multiplayer-manager/play-multiplayer-with-friends.md)
* [Найти совпадение](multiplayer-manager/play-multiplayer-with-matchmaking.md)
* [Отправлять приглашения игр](multiplayer-manager/send-game-invites.md)
* [Дескриптор протокола активации](multiplayer-manager/handle-protocol-activation.md)

Общий обзор API-интерфейса можно найти в [Обзор API диспетчера многопользовательскую](multiplayer-manager/multiplayer-manager-api-overview.md).

## <a name="what-multiplayer-manager-does-not-do"></a>Что сделать многопользовательскую Manager
Хотя многопользовательскую Manager значительно упрощает для реализации сценариев многопользовательской и абстрагирует некоторые данные от разработчика, есть несколько моментов, он не обрабатывает, или не является наилучшим образом подходит для.

* Постоянные online server игры, например MMOs или других типов игры, которые требуют больших (более 100 исполнителей в сеанс).
* Сервер для управления сеансами сервера

>Диспетчер многопользовательскую не привязан к любой определенные сетевые технологии и должны работать с любого сетевого уровня.

## <a name="next-steps"></a>Дальнейшие действия

См. в разделе C++ или WinRT *многопользовательскую* образец рабочий пример API-интерфейса.

Документация по API можно найти в руководствах в пространстве имен Microsoft::Xbox::Services::Multiplayer::Manager C++ или WinRT.  Также вы увидите `multiplayer_manager.h` заголовка.

Если у вас возникли вопросы, отзыв, или возникнут проблемы, с помощью диспетчера многопользовательскую, обратитесь к вашей DAM или блога поток поддержку на форумах по [ https://forums.xboxlive.com ](https://forums.xboxlive.com).
