---
Description: Microsoft Store применяет определенные правила, связанные с номерами версий, которые работают несколько иначе в разных версиях ОС.
title: Нумерация версий пакета
ms.assetid: DD7BAE5F-C2EE-44EE-8796-055D4BCB3152
ms.date: 10/31/2018
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: d5ac50cdba542de56ffb1daee01da12d4979ac45
ms.sourcegitcommit: 96b7be654a0922eeb421b5fa51ebfc586abe74fe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2020
ms.locfileid: "84945980"
---
# <a name="package-version-numbering"></a>Нумерация версий пакета

У каждого пакета, который вы предоставляете, должен быть номер версии (значение атрибута **Version** элемента [Package/Identity](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity) в манифесте приложения). Microsoft Store применяет определенные правила, связанные с номерами версий, которые работают несколько иначе в разных версиях ОС.

> [!NOTE]
> Этот раздел относится к "пакетам", но если не указано иное, то одни и те же правила применяются к номерам версий для файлов. msix/. appx и. msixbundle/. appxbundle.


## <a name="version-numbering-for-windows10-packages"></a>Нумерация версий пакетов Windows 10

> [!IMPORTANT]
> Для пакетов Windows 10 (UWP) последний (Четвертый) раздел номера версии зарезервирован для использования в магазине и должен оставаться равным 0 при сборке пакета (хотя магазин может изменить значение в этом разделе). В других разделах должно быть задано целое число от 0 до 65535 (за исключением первого раздела, который не может быть равен 0).

При выборе пакета UWP из опубликованной отправки Microsoft Store всегда будет использовать пакет с наивысшей версией, применимый к устройству Windows 10 клиента. Это дает больше гибкости и контроля над тем, какие пакеты будут предоставлены пользователям для различных устройств. Важно, что вы можете отправлять эти пакеты в любом порядке. При этом необязательно предоставлять пакеты с более поздней версией с каждой последующей отправкой.

Вы можете указать несколько пакетов UWP с одинаковым номером версии. Однако пакеты с одинаковым номером версии не могут использовать одинаковую архитектуру, так как полное удостоверение, которое Магазин применяет для каждого пакета, должно быть уникальным. Подробнее: [**Удостоверение**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity).

При предоставлении нескольких пакетов UWP, использующих один и тот же номер версии, будет использоваться архитектура (в порядке x64, x86, ARM, нейтральная), чтобы решить, какой из них имеет более высокий ранг (когда магазин определяет, какой пакет следует предоставить устройству клиента). При ранжировании пакетов приложений, использующих одну версию, учитывается самый высокий ранг архитектуры в пакете: пакет для архитектуры x64 получает более высокий ранг, чем пакет, который содержит только архитектуру x86.

Это дает вам достаточно гибкости для развития вашего приложения с течением времени. Вы можете отправлять и отправлять новые пакеты с более низкими номерами версий для добавления поддержки устройств Windows 10, которые ранее не поддерживались. Вы можете добавить пакеты с более высоким контролем версий, имеющие более строгие зависимости, чтобы воспользоваться преимуществами оборудования или ОС, или добавить пакеты с более высоким контролем версий, которые будут использоваться в качестве обновлений для некоторых или всех существующих клиентов.

В следующем примере показано, как управлять нумерацией версий для последовательной доставки запланированных пакетов пользователям.

### <a name="example-moving-to-a-single-package-over-multiple-submissions"></a>Пример: переход к отдельному пакету для множества отправок

Windows 10 позволяет создать единую базу кода, которая работает везде. Это значительно упрощает создание кроссплатформенных проектов. Однако по ряду причин не следует объединять существующие базы кода для создания одного проекта.

Можно использовать правила нумерации версий пакета, чтобы пользователи постепенно перешли на единый пакет для семейства универсальных устройств, предоставляя промежуточные обновления для конкретных семейств устройств (включая те, что используют API-интерфейсы Windows 10). В приведенном ниже примере показано, как согласованные правила применяются к ряду отправок для одного и того же приложения.

| Отправка | Содержимое                                                  | Взаимодействие с пользователем                                                                                                                                                                             |
|------------|-----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1          | - Версия пакета: 1.1.10.0 <br> - Семейство устройств: Windows.Desktop, minVersion 10.0.10240.0 <br> <br> - Версия пакета: 1.1.0.0 <br> - Семейство устройств: Windows.Mobile, minVersion 10.0.10240.0     | - Устройства со сборкой 10.0.10240.0 классической версии Windows 10 или более новой получат версию 1.1.10.0 <br> - Устройства со сборкой 10.0.10240.0 Windows 10 Mobile или более новой получат версию 1.1.0.0 <br> - Другие семейства устройств не смогут приобрести и установить приложение |
| 2          | - Версия пакета: 1.1.10.0 <br> - Семейство устройств: Windows.Desktop, minVersion 10.0.10240.0 <br> <br> - Версия пакета: 1.1.0.0 <br> - Семейство устройств: Windows.Mobile, minVersion 10.0.10240.0 <br> <br> - Версия пакета: 1.0.0.0 <br> - Семейство устройств: Windows.Universal, minVersion 10.0.10240.0    | - Устройства со сборкой 10.0.10240.0 классической версии Windows 10 или более новой получат версию 1.1.10.0 <br> - Устройства со сборкой 10.0.10240.0 Windows 10 Mobile или более новой получат версию 1.1.0.0 <br> - Другие семейства устройств (не настольные ПК и не мобильные устройства) получат версию 1.0.0.0 после выпуска <br> - Настольные ПК и мобильные устройства, на которых приложение уже установлено, не увидят обновление (поскольку на них уже установлена наилучшая доступная версия — и 1.1.10.0, и 1.1.0.0 больше 1.0.0.0) |
| 3          | - Версия пакета: 1.1.10.0 <br> - Семейство устройств: Windows.Desktop, minVersion 10.0.10240.0 <br> <br> - Версия пакета: 1.1.5.0 <br> - Семейство устройств: Windows.Universal, minVersion 10.0.10250.0 <br> <br> - Версия пакета: 1.0.0.0 <br> - Семейство устройств: Windows.Universal, minVersion 10.0.10240.0    | - Устройства со сборкой 10.0.10240.0 классической версии Windows 10 или более новой получат версию 1.1.10.0 <br> - Устройства со сборкой 10.0.10250.0 Windows 10 Mobile или более новой получат версию 1.1.5.0 <br> - Устройства со сборкой Windows 10 Mobile ≥ 10.0.10240.0, но < 10.010250.0 получат версию 1.1.0.0 
| 4          | - Версия пакета: 2.0.0.0 <br> - Семейство устройств: Windows.Universal, minVersion 10.0.10240.0   | - Все пользователи на всех семействах устройств со сборкой версии 10.0.10240.0 Windows 10 или более новой получат пакет 2.0.0.0 | 

> [!NOTE]
>  Во всех случаях устройства пользователей получат пакет, имеющий самый высокий доступный номер версии. Например, в вышеприведенной третьей отправке все настольные устройства получат версию 1.1.10.0, даже если на них установлена версия ОС 10.0.10150.0 или старше, т. е. они могут также принять версию 1.1.5.0. Поскольку 1.1.10.0 — наивысший доступный для них номер версии, этот пакет они и получат.

### <a name="using-version-numbering-to-roll-back-to-a-previously-shipped-package-for-new-acquisitions"></a>Использование нумерации версий для возврата к ранее отправленному пакету для новых приобретений

Если вы храните копии пакетов, у вас есть возможность откатить пакет приложения в хранилище до более ранней версии пакета Windows 10, если вы хотите обнаружить проблемы в выпуске. Это временный способ ограничить перерывы в работе клиентов, в то время как вы занимаетесь устранением проблемы.

Для этого создайте новую [отправку](app-submissions.md). Удалите проблемный пакет и отправьте старый пакет в Магазин. У пользователей, которые уже получили откатываемый пакет, по-прежнему будет проблемный пакет (поскольку номер версии старого пакета меньше). Но это не позволит другим пользователям скачать проблемный пакет, при этом приложение по-прежнему будет доступно в Магазине.

Чтобы устранить проблему для клиентов, которые уже получили проблемный пакет, можно отправить новый пакет Windows 10, номер версии которого выше, чем у поврежденного пакета, как только вы сможете. После сертификации этой отправки все пользователи получат обновленный пакет, так как у него будет самый большой номер версии.


## <a name="version-numbering-for-windows81-and-earlier-and-windows-phone-81-packages"></a>Нумерация версий для пакетов Windows 8.1 (и более ранних версий) и Windows Phone 8.1

> [!IMPORTANT]
> Вы больше не можете отправлять новые пакеты XAP, созданные с помощью пакетов SDK для Windows Phone 8. x. Приложения, которые уже находятся в магазине с пакетами XAP, продолжат работать на устройствах с Windows 10 Mobile. Дополнительные сведения см. в этой [записи блога](https://blogs.windows.com/windowsdeveloper/2018/08/20/important-dates-regarding-apps-with-windows-phone-8-x-and-earlier-and-windows-8-8-1-packages-submitted-to-microsoft-store).

Для пакетов .appx, предназначенных для Windows Phone 8.1, номер версии пакета в новой отправке всегда должен быть больше, чем номер пакета, включенного в последнюю отправку (или любую предыдущую отправку).

Для пакетов .appx, предназначенных для Windows 8 и Windows 8.1, то же правило применяется к архитектуре: номер версии пакета в новой отправке всегда должен быть больше номера последнего пакета для той же архитектуры, опубликованного в Microsoft Store.

Кроме того, номер версии пакетов Windows 8.1 должен быть больше, чем номера версий всех пакетов Windows 8 того же приложения. Другими словами, номер версии отправляемого пакета Windows 8 должен быть меньше номера версии любого отправляемого пакета Windows 8.1 для того же приложения.

> [!NOTE]
> Если в приложении также есть пакеты Windows 10, номер версии пакетов Windows 10 должен быть выше, чем для любого из пакетов Windows 8, Windows 8.1 и (или) Windows Phone 8,1. Дополнительные сведения см. [в разделе Добавление пакетов для Windows 10 в ранее опубликованное приложение](guidance-for-app-package-management.md#adding-packages-for-windows-10-to-a-previously-published-app).

Ниже приведено несколько примеров того, что происходит в разных сценариях обновления номеров версий для пакетов, предназначенных для Windows 8 и Windows 8.1.

| Версия приложения в Магазине  | Отправка этой версии | После появления новой версии в Microsoft Store это будет установлено в случае нового приобретения | После появления новой версии в Microsoft Store это будет обновлено, если клиент уже установил приложение |
|---------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------|----------|
| Nothing                                     | x86, v1.0.0.0               | x86, v1.0.0.0 на компьютерах x86 и x64                                                | Nothing. |
| x86, v1.0.0.0                               | x64, v1.0.0.0               | v1.0.0.0 для архитектуры клиента                                                   | Nothing. Номера версий совпадают. |
| x86, v1.0.0.0 <br> x64, v1.0.0.0            | x64, v1.0.0.1               | v1.0.0.0 для клиентов с компьютером x86 <br> v1.0.0.1 для клиентов с компьютером x64                 | Отсутствуют изменения для клиентов, запускающих приложение на компьютере x86. <br> Версия 1.0.0.0 будет обновлена до версии 1.0.0.1 для клиентов, запускающих приложение на компьютере x64. <br> **Примечание**    . Если версия x86 приложения работает на компьютере с 64-разрядной архитектурой, приложение не будет обновляться до версии x64, если клиент не будет удален и переустановлен. |
| Nothing                                     | нейтральный, v1.0.0.1           | нейтральный, v1.0.0.1 на любых компьютерах                                                         | Nothing. |
| нейтральный, v1.0.0.1                           | x86, v1.0.0.0 <br> x64, v1.0.0.0 <br> ARM, v1.0.0.0 | v1.0.0.0 для архитектуры компьютера клиента          | Nothing. Клиенты, которые используют нейтральный пакет версии 1.0.0.1, будут и дальше пользоваться этой версией приложения. |
| нейтральный, v1.0.0.1 <br> x86, v1.0.0.0 <br> x64, v1.0.0.0 <br> ARM, v1.0.0.0 | x86, v1.0.0.1 <br> x64, v1.0.0.1 <br> ARM, v1.0.0.1 | v1.0.0.1 для архитектуры компьютера клиента | Отсутствуют изменения для клиентов, запускающих нейтральную версию приложения v1.0.0.1. <br> v1.0.0.0 будет обновлена до v1.0.0.1 для клиентов, использующих версию v1.0.0.0 приложения, разработанную специально для архитектуры их компьютера. |
| x86, v1.0.0.1 <br> x64, v1.0.0.1 <br> ARM, v1.0.0.1 | x86, v1.0.0.2 <br> x64, v1.0.0.2 <br> ARM, v1.0.0.2 | v1.0.0.2 для архитектуры компьютера клиента  | Версия 1.0.0.1 будет обновлена до версии 1.0.0.2 для клиентов, использующих любую версию 1.0.0.1 приложения, разработанную специально для архитектуры их компьютеров. |

> [!NOTE]
> В отличие от пакетов .appx, номера версии в любых пакетах .xap не учитываются при решении, какой пакет предоставить конкретному пользователю. Для обновления пакета .xap пользователя до более нового удалите старый пакет .xap из новой отправки.
