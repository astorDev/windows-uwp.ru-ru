---
title: Адаптация композиции
description: Используйте API-интерфейсы компоновки для адаптации пользовательского интерфейса, оптимизации производительности и настройки параметров пользователей и устройств.
ms.date: 07/16/2018
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 95a7355241f9ba4cc7b4bb743b78ac09169d65d9
ms.sourcegitcommit: 2747d9266e1678fca96d3822ce47499ca91a2c70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2020
ms.locfileid: "77213681"
---
# <a name="tailoring-effects--experiences-using-windows-ui"></a>Действия по адаптации & возможности с помощью пользовательского интерфейса Windows

Пользовательский интерфейс Windows предоставляет множество привлекательных эффектов, анимации и средств для различения. Тем не менее, чтобы удовлетворить ожидания пользователей в целях повышения производительности и настройки, все равно необходимо создать успешные приложения. Универсальная платформа Windows поддерживает большое, разнообразное семейство устройств, имеющих различные функции и возможности. Чтобы обеспечить широкую работу для всех пользователей, необходимо обеспечить масштабирование приложений на разных устройствах и учитывать предпочтения пользователей. Адаптация пользовательского интерфейса может обеспечить эффективный способ использования возможностей устройства и обеспечения приятный и инклюзивного взаимодействия с пользователем.

Адаптация пользовательского интерфейса — это обширная категория, охватывающая работу для производительного, привлекательного пользовательского интерфейса в следующих областях:

- Соблюдение и адаптация параметров пользователя для применения эффектов
- Настройка параметров пользователя для анимации
- Оптимизация пользовательского интерфейса для заданных аппаратных возможностей

Здесь мы расскажем о том, как адаптировать эффекты и анимации с помощью визуального слоя в областях выше, но существует много других средств для настройки приложения, чтобы обеспечить удобство работы конечных пользователей. Документация по руководство содержит сведения о том, как [настроить пользовательский интерфейс](/windows/uwp/design/layout/screen-sizes-and-breakpoints-for-responsive-design) для различных устройств и [создать реагирующий пользовательский интерфейс](/windows/uwp/design/layout/responsive-design).

## <a name="user-effects-settings"></a>Параметры пользовательских эффектов

Пользователи могут настраивать работу Windows по различным причинам, в которых приложения должны учитывать и адаптироваться к. Один пользователь области может управлять изменением типов эффектов, которые они видят при использовании в системе.

### <a name="transparency-effects-settings"></a>Параметры эффектов прозрачности

Один из таких параметров влияет на то, что пользователи могут настраивать эффекты прозрачности. Это можно найти в приложении "Параметры" в разделе "Персонализация > цвета" или с помощью приложения "Параметры" > простоту доступа > экрана.

![Параметр прозрачности в параметрах](images/tailoring-transparency-setting.png)

Если этот компонент включен, любой эффект, использующий прозрачность, будет отображаться должным образом. Это относится к акриловая, Хостбаккдропбруш или любой диаграмме пользовательских эффектов, которая не является полностью непрозрачной.

Если этот параметр отключен, акриловая материал автоматически переключается на сплошной цвет, так как кисть акриловая XAML прослушивает это событие по умолчанию. Здесь мы видим, что приложение калькулятора правильно припадает к сплошному цвету, когда эффекты прозрачности не включены:

![калькулятор с помощью акриловая](images/tailoring-acrylic.png)
![калькулятор с акриловая, отвечающим на параметры прозрачности](images/tailoring-acrylic-fallback.png)

Однако для любых пользовательских эффектов, которые приложение должно отвечать на событие [уисеттингс. адванцедеффектсенаблед](https://docs.microsoft.com/uwp/api/windows.ui.viewmanagement.uisettings.advancedeffectsenabled) или [адванцедеффектсенабледчанжед](https://docs.microsoft.com/uwp/api/windows.ui.viewmanagement.uisettings.advancedeffectsenabledchanged) , и выключать граф эффектов и эффектов, чтобы использовать эффект без прозрачности. Ниже приведен пример.

```cs
public MainPage()
{
   var uisettings = new UISettings();
   bool advancedEffects = uisettings.AdvancedEffectsEnabled;
   uisettings.AdvancedEffectsEnabledChanged += Uisettings_AdvancedEffectsEnabledChanged;
}

private void Uisettings_AdvancedEffectsEnabledChanged(UISettings sender, object args)
{
    // TODO respond to sender.AdvancedEffectsEnabled
}
```

## <a name="animations-settings"></a>Параметры анимации

Аналогичным образом приложения должны прослушивать и реагировать на свойство [уисеттингс. аниматионсенаблед](https://docs.microsoft.com/uwp/api/windows.ui.viewmanagement.uisettings.animationsenabled) , чтобы убедиться, что анимация включена или отключена на основе параметров пользователя в параметрах > простота доступа > экрана.

![Параметр анимации в параметрах](images/tailoring-animations-setting.png)

```cs
public MainPage()
{
   var uisettings = new UISettings();
   bool animationsEnabled = uisettings.AnimationsEnabled;
   // TODO respond to animations settings
}

```

## <a name="leveraging-the-capabilities-api"></a>Использование API возможностей

Используя API-интерфейсы [компоситионкапабилитиес](/uwp/api/windows.ui.composition.compositioncapabilities) , вы можете определить, какие функции компоновки доступны и работают на заданном оборудовании, и адаптировать проект, чтобы пользователи могли получить полноценную и привлекательную работу на любом устройстве. Интерфейсы API предоставляют средства для проверки аппаратной системы, чтобы реализовать плавное масштабирование для различных форм-факторов. Это позволяет легко адаптировать приложение к созданию привлекательного и беспрепятственного взаимодействия с пользователем.

Этот API предоставляет методы и прослушиватель событий, которые можно использовать для принятия решений о масштабировании в пользовательском интерфейсе приложения. Эта функция определяет, насколько хорошо система может обрабатывать сложные операции композиции и визуализации, а затем возвращает информацию в удобной модели для использования разработчиками.

### <a name="using-composition-capabilities"></a>Использование возможностей компоновки

Функция Компоситионкапабилитиес уже используется для таких функций, как акриловая материал, где материал возвращается к более эффективному результату в зависимости от сценария и оборудования.

API можно добавить в существующий код, выполнив несколько простых действий.

1. Получите объект capabilities в конструкторе приложения.

    ```cs
    _capabilities = CompositionCapabilities.GetForCurrentView();
    ```

1. Зарегистрируйте в приложении прослушиватель событий измененных возможностей.

    ```cs
    _capabilities.Changed += HandleCapabilitiesChanged;
    ```

1. Добавьте содержимое в метод обратного вызова события для управления различными уровнями возможностей. Это может быть и не похоже на следующий шаг ниже.
1. При использовании эффектов сначала проверьте объект capabilities. Рассмотрите возможность использования условных проверок или операторов управления Switch в зависимости от того, как вы хотите адаптировать эффекты.

    ```cs
    if (_capabilities.AreEffectsSupported())
    {
        // Add incremental effects updates here

        if (_capabilities.AreEffectsFast())
        {
            // Add more advanced effects here where applicable
        }
    }
    ```

Полный пример кода можно найти в [репозитории пользовательского интерфейса Windows](https://github.com/microsoft/WindowsCompositionSamples/tree/master/SampleGallery/Samples/SDK 15063/CompCapabilities).

## <a name="fast-vs-slow-effects"></a>Быстрые и медленные эффекты

Основываясь на обратной связи от предоставленных методов [ариффектссуппортед](/uwp/api/windows.ui.composition.compositioncapabilities.areeffectssupported) и [Ариффектсфаст](/uwp/api/windows.ui.composition.compositioncapabilities.areeffectsfast) в API компоситионкапабилитиес, приложение может принять решение о перестановке дорогостоящих или неподдерживаемых эффектов для других эффектов по выбору, оптимизированных для устройства. Известно, что некоторые эффекты постоянно являются более ресурсоемкими, чем другие, и их следует использовать экономно, а другие эффекты можно использовать более свободно. Однако для всех эффектов следует использовать осторожность при создании цепочки и анимации, так как некоторые сценарии или сочетания могут изменить характеристики производительности диаграммы эффектов. Ниже приведены некоторые правила характеристик производительности Thumb для отдельных эффектов.

- К эффектам, которые известны с высокой производительностью, относятся следующие: Размытие по Гауссу, теневая маска, Баккдропбруш, Хостбаккдропбруш и визуальный элемент слоя. Они не рекомендуются для устройств низкого [уровня (уровень компонентов 9.1-9,3)](https://docs.microsoft.com/windows/desktop/direct3d11/overviews-direct3d-11-devices-downlevel-intro)и должны внимательно использоваться на высоких устройствах.
- Эффекты с средней производительностью включают цветовую матрицу, определенный эффект смешения Блендмодес (яркость, цвет, насыщенность и цветовой тон), SpotLight, Сценелигхтинжеффект и (в зависимости от сценария) Бордереффект. Эти эффекты могут работать с определенными сценариями на устройствах с низким уровнем, но при создании цепочки и анимации следует использовать осторожность. Рекомендуется ограничивать использование до двух или менее и анимировать только для переходов.
- Все остальные последствия имеют низкую производительность и работают во всех разумных сценариях при анимации и создании цепочек.

## <a name="related-articles"></a>Связанные статьи

- [Методики разработки с откликом UWP](https://docs.microsoft.com/windows/uwp/design/layout/responsive-design)
- [Адаптация устройств UWP](https://docs.microsoft.com/windows/uwp/design/layout/screen-sizes-and-breakpoints-for-responsive-design)
