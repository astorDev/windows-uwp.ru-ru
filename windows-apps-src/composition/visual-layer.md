---
ms.assetid: a2751e22-6842-073a-daec-425fb981bafe
title: Визуальный уровень
description: API-интерфейс Windows.UI.Composition предоставляет доступ к уровню композиции, находящемуся между уровнем платформы (XAML) и уровнем графики (DirectX).
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: ac41d461982a39a939e460b7a81b144e5a08fdb3
ms.sourcegitcommit: b52ddecccb9e68dbb71695af3078005a2eb78af1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74255523"
---
# <a name="visual-layer"></a>Визуальный уровень

Визуальный уровень обеспечивает высокую производительность, API абстрактного режима для графики, эффектов и анимации и является основой для всех элементов пользовательского интерфейса на всех устройствах Windows. Пользовательский интерфейс определяется декларативным образом, а визуальный уровень зависит от аппаратного ускорения, чтобы гарантировать, что содержимое, эффекты и анимации визуализируются без проблем независимо от потока пользовательского интерфейса приложения.

Важные основные положения:

* Знакомые API WinRT.
* Архитектура, обеспечивающая более динамичный пользовательский интерфейс и взаимодействия.
* Концепции, согласованные со средствами разработки.
* Линейная масштабируемость без внезапного снижения производительности.

Ваши приложения Windows UWP уже используют визуальный уровень через одну из инфраструктур пользовательского интерфейса. Визуальный уровень позволяет также легко напрямую выполнять пользовательскую отрисовку, создавать эффекты и анимации.

![Уровни инфраструктуры пользовательского интерфейса: уровень платформы (Windows.UI.XAML) основан на визуальном уровне (Windows.UI.Composition), который, в свою очередь, построен на графическом уровне (DirectX)](images/layers-win-ui-composition.png)

## <a name="whats-in-the-visual-layer"></a>Что такое визуальный уровень?

Основные функции визуального уровня:

1. **Содержимое**: облегченная компоновка пользовательского нарисованного содержимого.
1. **Эффекты**: система создания эффектов пользовательского интерфейса в реальном времени, позволяющая анимировать, соединять и настраивать эффекты.
1. **Анимация**: выразительная анимация без привязки к конкретной платформе, которая не зависит от потока пользовательского интерфейса.

### <a name="content"></a>Содержимое

Размещение содержимого, его преобразование и доступ к нему обеспечивает система анимации и эффектов с использованием визуальных элементов. В основе иерархии классов находится класс [**Visual**](https://docs.microsoft.com/uwp/api/Windows.UI.Composition.Visual) — упрощенный прокси-сервер с гибким потоком в процессе приложения для визуального состояния в компоновщике. К подклассам визуального элемента относятся  [**ContainerVisual**](https://docs.microsoft.com/uwp/api/Windows.UI.Composition.ContainerVisual) , позволяющие дочерним элементам создавать деревья визуальных элементов и [**спритевисуал**](https://docs.microsoft.com/uwp/api/Windows.UI.Composition.SpriteVisual) , которые содержат содержимое и могут быть окрашены сплошным цветом, пользовательским изображением или визуальными эффектами. Вместе эти типы Visual составляют визуальную древовидную структуру для двумерного пользовательского интерфейса и позволяют создавать наиболее видимые элементы FrameworkElements XAML.

Дополнительные сведения см. в обзоре [визуальных объектов композиции](composition-visual-tree.md).

### <a name="effects"></a>Эффекты

Система эффектов в визуальном уровне позволяет применить цепочку эффектов фильтра и прозрачности к визуальному элементу или дереву таких элементов. Это система эффектов пользовательского интерфейса, которые не следует путать с эффектами изображений и мультимедиа. Эффекты работают совместно с системой анимации, позволяя пользователям создавать плавную и динамичную анимацию свойств эффектов, которая отрисовывается независимо от потока пользовательского интерфейса. Эффекты в визуальном уровне представляют собой креативные структурные элементы, которые можно комбинировать и анимировать для создания специальных интерактивных возможностей.

Помимо цепочек анимируемых эффектов, визуальный уровень также поддерживает модель освещения. Она позволяет визуальным элементам имитировать свойства материалов, реагируя на анимируемые источники освещения. Визуальные элементы также могут отбрасывать тени. Для создания реалистичного ощущения глубины можно сочетать освещение и тени.

Дополнительные сведения см. в обзоре [эффектов композиции](composition-effects.md).

### <a name="animations"></a>Анимации

Система анимации в визуальном уровне позволяет перемещать визуальные элементы, анимировать эффекты и создавать преобразования, клипы и другие свойства.  Это независимая от платформы система, которая была разработана с нуля, с учетом производительности.  Он выполняется независимо от потока пользовательского интерфейса, чтобы обеспечить гладкость и масштабируемость.  Хотя он позволяет использовать привычные анимации по опорным кадрам для изменения свойств с течением времени, он также позволяет настроить математические связи между различными свойствами, включая ввод пользователя, позволяя напрямую создавать удобные организуются.

Дополнительную информацию см. в обзорном материале [Анимации композиции](composition-animation.md).

### <a name="working-with-your-xaml-uwp-app"></a>Работа с приложением UWP XAML.

Получить доступ к визуальному элементу, созданному платформой XAML, и к поддержке видимого элемента FrameworkElement можно с помощью класса [**ElementCompositionPreview**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Hosting.ElementCompositionPreview) в [**Windows.UI.Xaml.Hosting**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Hosting). Обратите внимание, что визуальные элементы, созданные для вас платформой, имеют определенные ограничения, касающиеся настройки. Это связано с тем, что платформа управляет смещением, преобразованием и временем жизни. Однако можно создавать собственные визуальные элементы и вкладывать их в существующий элемент XAML через ElementCompositionPreview или путем добавления в существующий ContainerVisual в визуальной древовидной структуре.

Дополнительные сведения см. в обзоре [использования визуального уровня с помощью XAML](using-the-visual-layer-with-xaml.md).

### <a name="working-with-your-desktop-app"></a>Работа с классическим приложением

Вы можете использовать визуальный уровень, чтобы улучшить внешний вид, поведение и функциональность приложений WPF, Windows Forms и C++ Win32. Вы можете перенести острова содержимого, чтобы использовать визуальный уровень и сохранять остальную часть пользовательского интерфейса в существующей платформе. Это означает, что вы можете вносить значительные изменения в пользовательский интерфейс приложения, не требуя внесения значительных изменений в существующую базу кода.

Дополнительные сведения см. в статье [Using the Visual layer in desktop apps](/windows/apps/desktop/modernize/visual-layer-in-desktop-apps) (Использование визуального уровня в классических приложениях).

## <a name="additional-resources"></a>Дополнительные ресурсы

* [**Полная справочная документация по API**](https://docs.microsoft.com/uwp/api/Windows.UI.Composition)
* Расширенные примеры пользовательского интерфейса и композиции в [WindowsUIDevLabs GitHub](https://github.com/microsoft/WindowsCompositionSamples)
* [Коллекция примеров Windows. UI. композиция](https://www.microsoft.com/store/apps/9pp1sb5wgnww)
* [веб-канал Twitter @windowsui](https://twitter.com/windowsui)
* Ознакомьтесь со статьей Кенни Керра (Kenny Kerr) на MSDN, которая посвящена этому API: [Graphics and Animation — Windows Composition Turns 10](https://msdn.microsoft.com/magazine/mt590968) (Графика и анимация — композиция в Windows 10)
