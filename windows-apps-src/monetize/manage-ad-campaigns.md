---
ms.assetid: 7b07a6ca-4be1-497c-a901-0a2da3762555
description: Используйте этот метод в API рекламных акций Microsoft Store для создания, редактирования и получения рекламных кампаний.
title: Управление рекламными кампаниями
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, UWP, API рекламных акций Microsoft Store, рекламные кампании
ms.localizationpriority: medium
ms.openlocfilehash: 6529c1a21865b2997d36e9b254b19f971f620490
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57633229"
---
# <a name="manage-ad-campaigns"></a>Управление рекламными кампаниями

Используйте эти методы в [API рекламных акций Microsoft Store](run-ad-campaigns-using-windows-store-services.md) для создания, редактирования и получения рекламных кампаний для вашего приложения. Каждую создаваемую вами с помощью этого метода кампанию можно связать только с одним приложением.

>**Примечание**&nbsp;&nbsp;вы можете также создавать и администрировать рекламные кампании, с помощью центра партнеров и кампании, которые можно создать программным способом можно получить в центре партнеров. Дополнительные сведения об управлении рекламных кампаний в центре партнеров см. в разделе [создания кампании типа ad для приложения](../publish/create-an-ad-campaign-for-your-app.md).

Если вы используете эти методы для создания и обновления кампании, вы обычно также вызываете один или несколько из следующих методов для управления *линиями поставки*, *профилями таргетинга* и *рекламными материалами*, которые связаны с этой кампанией. Дополнительные сведения о связи между кампаниями, линиями поставки, профилями таргетинга и рекламными материалами см. в разделе [Проведение рекламных кампаний с помощью служб Microsoft Store](run-ad-campaigns-using-windows-store-services.md#call-the-windows-store-promotions-api).

* [Управление доставки строк для рекламных кампаний](manage-delivery-lines-for-ad-campaigns.md)
* [Управление профилями выбора целевой платформы для рекламных кампаний](manage-targeting-profiles-for-ad-campaigns.md)
* [Управление предъявляемым для рекламных кампаний](manage-creatives-for-ad-campaigns.md)

## <a name="prerequisites"></a>Предварительные условия

Для использования этих методов сначала необходимо сделать следующее.

* Если вы еще не сделали этого, выполните все [необходимые условия](run-ad-campaigns-using-windows-store-services.md#prerequisites) для API рекламных акций Microsoft Store.

  >**Примечание**&nbsp;&nbsp;как часть необходимых компонентов, убедитесь, что вами [создайте по крайней мере одной платный рекламную кампанию в центре партнеров](../publish/create-an-ad-campaign-for-your-app.md) и добавлять по крайней мере один инструмент оплаты для рекламную кампанию партнера Центр. Строки доставки для рекламных кампаний, созданный с помощью этого API автоматически будет выставлять счета платежного средства по умолчанию, показанное на **рекламных кампаний** страницы в центре партнеров.

* [Получите маркер доступа Azure AD](run-ad-campaigns-using-windows-store-services.md#obtain-an-azure-ad-access-token), который будет использоваться в заголовке запроса этих методов. После получения токена доступа у вас будет 60 минут, чтобы использовать его до окончания его срока действия. После истечения срока действия токена можно получить новый токен.


## <a name="request"></a>Запрос

Эти методы имеют следующие URI.

| Тип метода | Универсальный код ресурса (URI) запроса                                                      |  Описание  |
|--------|------------------------------------------------------------------|---------------|
| POST   | ```https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign``` |  Создает новую рекламную кампанию.  |
| PUT    | ```https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign/{campaignId}``` |  Редактирует рекламную кампанию, заданную *campaignId*.  |
| GET    | ```https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign/{campaignId}``` |  Получает рекламную кампанию, заданную *campaignId*.  |
| GET    | ```https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign``` |  Запросы для рекламных кампаний. В разделе [Параметры](#parameters) приведены поддерживаемые параметры запросов.  |


### <a name="header"></a>Заголовок

| Заголовок        | Тип   | Описание         |
|---------------|--------|---------------------|
| Authorization | Строка | Обязательный. Маркер доступа Azure AD в форме **носителя** &lt; *маркера*&gt;. |
| Tracking ID   | Код GUID   | Необязательно. Идентификатор, который отслеживает поток вызовов.                                  |


<span id="parameters"/> 

### <a name="parameters"></a>Параметры

Метод GET для запроса рекламных кампаний поддерживает следующие необязательные параметры запроса.

| Имя        | Тип   |  Описание      |    
|-------------|--------|---------------|------|
| skip  |  int   | Количество строк, пропускаемых в запросе. Используйте этот параметр для постраничного перемещения по наборам данных. Например, при fetch=10 и skip=0 извлекаются первые 10 строк данных; при top=10 и skip=10 извлекаются следующие 10 строк данных и т. д.    |       
| fetch  |  int   | Количество строк данных, возвращаемых в запросе.    |       
| campaignSetSortColumn  |  Строка   | Заказывает объекты [Кампания](#campaign) в теле ответа с помощью указанного поля. Используется следующий синтаксис: <em>CampaignSetSortColumn = field</em>, где параметр <em>field</em> параметр может принимать одно из следующих строковых значений:</p><ul><li><strong>Идентификатор</strong></li><li><strong>Дата и время создания</strong></li></ul><p>Значение по умолчанию — **createdDateTime**.     |     
| isDescending  |  Boolean (Логическое)   | Сортирует объекты [Campaign](#campaign) в теле ответа в порядке убывания или возрастания.   |         
| storeProductId  |  Строка   | Используйте это значение, чтобы возвратить только те рекламные кампании, которые связаны с приложением по указанному [коду продукта в Магазине](in-app-purchases-and-trials.md#store-ids). Пример кода продукта в Магазине — 9nblggh42cfd.   |         
| label  |  Строка   | Используйте это значение для возвращения только тех рекламных кампаний, которые включают указанный параметр *label* в объект [Кампания](#campaign).    |       |    


### <a name="request-body"></a>Тело запроса

Методы POST и PUT требуют использовать тело запроса JSON с обязательными полями объекта [Кампания](#campaign) и любыми другими полями, которые вы хотите установить или изменить.


### <a name="request-examples"></a>Примеры запросов

Следующий пример демонстрирует вызов метода POST для создания рекламной кампании.

```json
POST https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign HTTP/1.1
Authorization: Bearer <your access token>

{
    "name": "Contoso App Campaign",
    "storeProductId": "9nblggh42cfd",
    "configuredStatus": "Active",
    "objective": "DriveInstalls",
    "type": "Community"
}
```

Ниже показано, как вызвать метод GET для получения конкретной рекламной кампании.

```json
GET https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign/31043481  HTTP/1.1
Authorization: Bearer <your access token>
```

Ниже показано, как вызвать метод GET для запроса для набора рекламных кампаний, отсортированных по дате создания.

```json
GET https://manage.devcenter.microsoft.com/v1.0/my/promotion/campaign?storeProductId=9nblggh42cfd&fetch=100&skip=0&campaignSetSortColumn=createdDateTime HTTP/1.1
Authorization: Bearer <your access token>
```


## <a name="response"></a>Ответ

Эти методы возвращают тело ответа JSON с одним или несколькими объектами [Кампания](#campaign) в зависимости от того, какой метод вызван. В следующем примере показано тело ответа для метода GET для конкретной кампании.

```json
{
    "Data": {
        "id": 31043481,
        "name": "Contoso App Campaign",
        "createdDate": "2017-01-17T10:12:15Z",
        "storeProductId": "9nblggh42cfd",
        "configuredStatus": "Active",
        "effectiveStatus": "Active",
        "effectiveStatusReasons": [
            "{\"ValidationStatusReasons\":null}"
        ],
        "labels": [],
        "objective": "DriveInstalls",
        "type": "Paid",
        "lines": [
            {
                "id": 31043476,
                "name": "Contoso App Campaign - Paid Line"
            }
        ]
    }
}
```


<span id="campaign"/>

## <a name="campaign-object"></a>Объект кампании

Для этих методов тела запроса и ответа содержат следующие поля. В этой таблице показаны поля, которые доступны только для чтения (это означает, что они не могут изменяться в методе PUT), и поля, которые необходимы в теле запроса для метода POST.

| Поле        | Тип   |  Описание      |  Только чтение  | По умолчанию  | Обязательный для POST |  
|--------------|--------|---------------|------|-------------|------------|
|  id   |  целое число   |  Идентификатор рекламной кампании.     |   Да    |      |  Нет     |       
|  name   |  Строка   |   Название рекламной кампании.    |    Нет   |      |  Да     |       
|  configuredStatus   |  Строка   |  Одно из следующих значений, которое указывает статус рекламной кампании, заданный разработчиком: <ul><li>**Active**</li><li>**Неактивные**</li></ul>     |  Нет     |  Активный    |   Да    |       
|  effectiveStatus   |  Строка   |   Одно из следующих значений, определяющих действующий статус рекламной кампании, в зависимости от проверки системы: <ul><li>**Active**</li><li>**Неактивные**</li><li>**Обработка**</li></ul>    |    Да   |      |   Нет      |       
|  effectiveStatusReasons   |  Массив   |  Одно или несколько из следующих значений, задающих причину нынешнего состояния рекламной кампании: <ul><li>**AdCreativesInactive**</li><li>**BillingFailed**</li><li>**AdLinesInactive**</li><li>**ValidationFailed**</li><li>**не удалось**</li></ul>      |  Да     |     |    Нет     |       
|  storeProductId   |  Строка   |  [Код продукта в Магазине](in-app-purchases-and-trials.md#store-ids) для приложения, с которым связана эта рекламная кампания. Пример кода продукта в Магазине — 9nblggh42cfd.     |   Да    |      |  Да     |       
|  labels   |  Массив   |   Одна или несколько строк, представляющих пользовательские метки для кампании. Эти метки могут использоваться для поиска и добавления тегов кампании.    |   Нет    |  null    |    Нет     |       
|  type   | Строка    |  Одно из следующих значений, указывающее тип кампании: <ul><li>**Платные**</li><li>**Дом**</li><li>**Сообщество**</li></ul>      |   Да    |      |   Да    |       
|  objective   |  Строка   |  Одно из следующих значений, определяющих цель кампании: <ul><li>**DriveInstall**</li><li>**DriveReengagement**</li><li>**DriveInAppPurchase**</li></ul>     |   Нет    |  DriveInstall    |   Да    |       
|  lines   |  Массив   |   Один или несколько объектов, которые определяют [линии поставки](manage-delivery-lines-for-ad-campaigns.md#line), которые связаны с рекламной кампанией. Каждый объект в этом поле состоит из поля *идентификатора* и *имени*, которое определяет идентификатор и название линии поставки.     |   Нет    |      |    Нет     |       
|  createdDate   |  Строка   |  Дата и время создания рекламной кампании в формате ISO 8601.     |  Да     |      |     Нет    |       |


## <a name="related-topics"></a>Статьи по теме

* [Запустите рекламные кампании, с помощью служб Microsoft Store](run-ad-campaigns-using-windows-store-services.md)
* [Управление доставки строк для рекламных кампаний](manage-delivery-lines-for-ad-campaigns.md)
* [Управление профилями выбора целевой платформы для рекламных кампаний](manage-targeting-profiles-for-ad-campaigns.md)
* [Управление предъявляемым для рекламных кампаний](manage-creatives-for-ad-campaigns.md)
* [Получить данные о производительности ad кампании](get-ad-campaign-performance-data.md)
