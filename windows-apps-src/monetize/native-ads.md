---
author: mcleanbyron
description: "Узнайте, как добавлять собственную рекламу в приложения UWP."
title: "Собственные объявления"
ms.author: mcleans
ms.date: 06/26/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: "windows 10, uwp, рекламные объявления, реклама, элемент управления рекламой, собственная реклама"
ms.openlocfilehash: 47a69e48f04c670a462c34083af1117d2c7908d8
ms.sourcegitcommit: 8c4d50ef819ed1a2f8cac4eebefb5ccdaf3fa898
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2017
---
# <a name="native-ads"></a>Собственные объявления

Собственные объявления — это формат на основе рекламных компонентов, где каждая часть рекламного объявления (например, заголовок, изображение, описание и призыв к действию) доставляется приложение в виде отдельного элемента. Эти элементы можно интегрировать в приложение с использованием собственных шрифтов, цветов, анимации и других компонентов пользовательского интерфейса, чтобы предоставлять пользователям цельную ненавязчивую рекламу, соответствующую вашему приложению по внешнему виду и общему впечатлению, а также получать высокий доход от рекламы.

Рекламодателям собственные объявления предоставляют высококачественное размещение, поскольку взаимодействие с рекламой интегрировано с приложением, и поэтому пользователи чаще реагируют на объявления такого типа.

> [!NOTE]
> Для показа собственной рекламы в общедоступной версии приложения в Магазине необходимо создать **собственную** группу объявлений на странице **Монетизация с помощью рекламы** на информационной панели Центра разработки. Возможность создавать **Собственные** группы объявлений в настоящее время доступна только отдельным разработчикам, участвующим в пилотной программе, но мы планируем сделать этот компонент доступным для всех разработчиков в скором времени. Если вы хотите присоединиться к пилотной программе, обратитесь по адресу aiacare@microsoft.com.

> [!NOTE]
> Собственные объявления в настоящее время поддерживаются только для приложений UWP на основе XAML для Windows 10. Поддержка для приложений UWP, написанных на HTML и JavaScript, намечена в последующих выпусках Microsoft Advertising SDK.

## <a name="prerequisites"></a>Что вам понадобится

* Установить [Microsoft Advertising SDK](http://aka.ms/ads-sdk-uwp) (версии 10.0.4 или более поздней) с помощью Visual Studio 2015 или более позднего выпуска Visual Studio. Инструкции по установке см. в [этой статье](install-the-microsoft-advertising-libraries.md). Вы можете установить SDK на компьютере разработки с помощью установщика MSI, также можно установить пакет SDK для использования в конкретном проекте через пакет NuGet.

## <a name="integrate-a-native-ad-into-your-app"></a>Интеграция собственного рекламного объявления в приложение

Следуйте этим инструкциям, чтобы интегрировать собственную рекламу в свое приложение и убедиться, что ваша реализация собственной рекламы отображает тестовое объявление.

1. В Visual Studio откройте свой проект либо создайте новый.

2. Если ваш проект направлен на работу на **Любом ЦП**, обновите его, чтобы он использовал результаты сборки, предназначенные для определенной архитектуры (например **x86**). Если ваш проект направлен на работу на **Любом ЦП**, вам не удастся надлежащим образом добавить ссылку на Microsoft Advertising SDK в приведенных ниже шагах. Дополнительные сведения см. в разделе [Ошибки, вызванные указанием варианта "Любой ЦП" как целевого в вашем проекте](known-issues-for-the-advertising-libraries.md#reference_errors).

3.  В **Обозревателе решений** щелкните правой кнопкой мыши элемент **Ссылки** и выберите **Добавить ссылку...**.

4.  В **Диспетчере ссылок** разверните раздел **Универсальная платформа Windows**, нажмите **Расширения** и выберите флажок рядом с **SDK Microsoft Advertising для XAML** (версия 10.0).

5.  В **Диспетчере ссылок** нажмите "ОК".

6. В соответствующий файл с кодом в вашем приложении (например, в файл MainPage.xaml.cs или в файл с кодом для другой страницы) добавьте следующие ссылки на пространство имен.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#Namespaces)]

7.  В соответствующем месте вашего приложения (например, в ```MainPage``` или на другой странице) объявите объект [NativeAdsManager](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativeadsmanager.aspx) и несколько строковых полей, которые будут представлять собой идентификатор приложения и идентификатор группы объявлений вашей собственной рекламы. Следующий код присваивает полям `myAppId` и `myAdUnitId` [тестовые значения](test-mode-values.md) для собственной рекламы.

    > [!NOTE]
    > Каждый элемент **NativeAdsManager** имеет соответствующую *группу объявлений*, используемую нашими службами для передачи рекламы элементу управления собственной рекламой, и каждая группа объявлений состоит из *идентификатора группы объявлений* и *идентификатора приложения*. На этих этапах вы задаете тестовые значения идентификатора группы объявлений и идентификатора приложения для своего элемента управления. Эти тестовые значения можно использовать только в тестовой версии приложения. Перед публикацией приложения в Магазине [тестовые значения необходимо заменить на фактические значения](#release) из Центра разработки для Windows.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#Variables)]

8.  В коде, который выполняется при запуске (например, в конструкторе для страницы), создайте объект **NativeAdsManager** и привяжите обработчики событий к событиям [AdReady](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativeadsmanager.adready.aspx) и [ErrorOccurred](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativeadsmanager.erroroccurred.aspx) этого объекта.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#ConfigureNativeAd)]

9.  Когда вы будете готовы показать собственную рекламу, вызовите метод [RequestAd](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativeadsmanager.requestad.aspx) для получения рекламы.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#RequestAd)]

10.  Когда собственная реклама готова для вашего приложения, вызывается ваш обработчик событий **AdReady**, и объект [NativeAd](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.aspx), представляющий собственную рекламу передается параметру *e*. Используйте свойства **NativeAd**, чтобы получить все элементы собственной рекламы и отобразить их на странице. Не забудьте также вызвать метод [RegisterAdContainer](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.registeradcontainer.aspx), чтобы зарегистрировать элемент пользовательского интерфейса, который действует как контейнер для собственной рекламы. Это требуется для правильного подсчета показов рекламных объявлений и нажатий по ним.
  > [!NOTE]
  > Некоторые элементы собственной рекламы являются обязательными и должны всегда отображаться в приложении. Дополнительные сведения см. в разделе [Требования и рекомендации](#requirements-and-guidelines).

    Например, предположим, что ваше приложение содержит ```MainPage``` (или другую страницу) со следующей панелью **StackPanel**. Эта **StackPanel** содержит ряд элементов управления, которые используются для отображения различных элементов собственного объявления, включая название, описание, изображения, текст *спонсируется* и кнопку, на которой будет отображаться текст *призыва к действию*.

    ``` xml
    <StackPanel x:Name="NativeAdContainer" Background="#555555" Width="Auto" Height="Auto"
                Orientation="Vertical">
        <Image x:Name="AdIconImage" HorizontalAlignment="Left" VerticalAlignment="Center"
               Margin="20,20,20,20"/>
        <TextBlock x:Name="TitleTextBlock" HorizontalAlignment="Left" VerticalAlignment="Center"
               Text="The ad title will go here" FontSize="24" Foreground="White" Margin="20,0,0,10"/>
        <TextBlock x:Name="DescriptionTextBlock" HorizontalAlignment="Left" VerticalAlignment="Center"
                   Foreground="White" TextWrapping="Wrap" Text="The ad description will go here"
                   Margin="20,0,0,0" Visibility="Collapsed"/>
        <Image x:Name="MainImageImage" HorizontalAlignment="Left"
               VerticalAlignment="Center" Margin="20,20,20,20" Visibility="Collapsed"/>
        <Button x:Name="CallToActionButton" Background="Gray" Foreground="White"
                HorizontalAlignment="Left" VerticalAlignment="Center" Width="Auto" Height="Auto"
                Content="The call to action text will go here" Margin="20,20,20,20"
                Visibility="Collapsed"/>
        <StackPanel x:Name="SponsoredByStackPanel" Orientation="Horizontal" Margin="20,20,20,20">
            <TextBlock x:Name="SponsoredByTextBlock" Text="The ad sponsored by text will go here"
                       FontSize="24" Foreground="White" Margin="20,0,0,0" HorizontalAlignment="Left"
                       VerticalAlignment="Center" Visibility="Collapsed"/>
            <Image x:Name="IconImageImage" Margin="40,20,20,20" HorizontalAlignment="Left"
                   VerticalAlignment="Center" Visibility="Collapsed"/>
        </StackPanel>
    </StackPanel>
    ```

    В следующем примере кода показан обработчик событий **AdReady**, который отображает каждый элемент собственной рекламы в элементах управления в **StackPanel**, а затем вызывает метод **RegisterAdContainer**, чтобы зарегистрировать **StackPanel**. В этом коде предполагается, что он запускается из файла кода программной части для страницы, которая содержит **StackPanel**.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#AdReady)]

11.  Определите обработчик событий для события **ErrorOccurred** для обработки ошибок, связанных со встроенной рекламой. Следующий пример записывает сведения об ошибке в окно **вывода** Visual Studio во время тестирования.

    [!code-cs[NativeAd](./code/AdvertisingSamples/NativeAdSamples/cs/MainPage.xaml.cs#ErrorOccurred)]

12.  Скомпилируйте и запустите приложение, чтобы увидеть его с тестовым объявлением.

<span id="release" />
## <a name="release-your-app-with-live-ads"></a>Выпуск приложения с реальной рекламой

После подтверждения того, что ваша реализация собственной рекламы успешно показывает тестовое объявление, выполните следующие действия для настройки вашего приложения для отображения реальных рекламных объявлений и отправки обновленного приложения в Магазин.

1.  Убедитесь, что ваша реализация собственной рекламы соответствует [требованиям и рекомендациям](#requirements-and-guidelines) для собственных объявлений.

2.  На информационной панели Центра разработки перейдите на страницу [Монетизация с помощью рекламы](../publish/monetize-with-ads.md) вашего приложения и [создайте группу объявлений](../monetize/set-up-ad-units-in-your-app.md). В качестве типа группы объявлений укажите **Собственная**. Запомните идентификатор группы объявлений и идентификатор приложения.
    > [!IMPORTANT]
    > Одну группу объявлений можно использовать только в одном приложении. Если использовать одну группу объявлений в нескольких приложениях, объявления для этой группы объявлений предоставляться не будут.

3. Вы можете при необходимости включить рекламный посредник для собственной рекламы, настроив параметры в разделе [Рекламный посредник](../publish/monetize-with-ads.md#mediation) на странице [Монетизация с помощью рекламы](../publish/monetize-with-ads.md). Рекламный посредник позволяет увеличить прибыль от рекламы и рекламные возможности приложений путем показа объявлений из множества популярных рекламных сетей.

4.  В своем коде замените тестовые значения (параметры *applicationId* и *adUnitId* конструктора [NativeAdsManager](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativeadsmanager.nativeadsmanager.aspx)) действительными значениями, сгенерированными в Центре разработки.

5.  [Отправьте приложение](../publish/app-submissions.md) в Магазин с помощью информационной панели в Центре разработки.

6.  Изучите [отчеты по показателям рекламы](../publish/advertising-performance-report.md) на информационной панели Центра разработки.

<span id="requirements-and-guidelines" />
## <a name="requirements-and-guidelines"></a>Требования и рекомендации

Собственные объявления предоставляют вам полный контроль над тем, как показывать рекламное содержимое своим пользователям. Выполните эти требования и рекомендации, чтобы гарантировать, что сообщение рекламодателя получит внимание пользователей, а также предотвратить путаницу при показе собственных рекламных объявлений вашим пользователям.

### <a name="register-the-container-for-your-native-ad"></a>Зарегистрируйте контейнер для своего собственного объявления

В коде необходимо вызвать метод [RegisterAdContainer](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.registeradcontainer.aspx) объекта **NativeAd** для регистрации элемента пользовательского интерфейса, который действует как контейнер для собственных рекламных объявлений, и при необходимости любые отдельные элементы управления, которые вы хотите зарегистрировать в качестве реагирующих на нажатия элементов при показе рекламы. Это требуется для правильного подсчета показов рекламных объявлений и нажатий по ним.

Существует две перегрузки метода **RegisterAdContainer**, которые можно использовать.

* Если вы хотите, чтобы весь контейнер для всех отдельных элементов собственной рекламы реагировал на нажатия, вызовите [RegisterAdContainer(FrameworkElement)](https://msdn.microsoft.com/library/windows/apps/mt809188.aspx) и передайте элемент управления контейнера в этот метод. Например, если вы показываете все элементы управления собственной рекламой в виде отдельных элементов управления, размещенных на панели **StackPanel**, и хотите, чтобы вся панель **StackPanel** реагировала на нажатия, передайте **StackPanel** этому методу.

* Если вы хотите, чтобы на нажатия реагировали только определенные элементы управления собственной рекламы, вызовите метод [RegisterAdContainer (FrameworkElement, IVector(FrameworkElement))](https://msdn.microsoft.com/library/windows/apps/mt809189.aspx). Только те элементы управления, которые вы передаете второму параметру, будут реагировать на нажатия.

### <a name="required-native-ad-elements"></a>Обязательные элементы собственной рекламы

В ваших собственных рекламных конструкциях, как минимум, пользователю всегда должны отображаться следующие элементы собственных рекламных объявлений. Если вы не включите эти элементы, вероятно, производительность рекламы и доходы от вашей группы объявлений будут низкими.

1. Всегда отображайте заголовок собственной рекламы (доступен в свойстве [Title](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.title.aspx) объекта **NativeAd**). Предоставляйте достаточно места для отображения как минимум 25 символов. Если заголовок длиннее, замените не помещающийся на экран текст многоточием.
2. Всегда отображайте как минимум один из следующих элементов, чтобы помочь отличить собственную рекламу от остальных частей приложения и ясно указать, что определенное содержимое предоставляется рекламодателем.
  * Заметный значок *реклама* (доступен в свойстве [AdIcon](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.adicon.aspx) объекта **NativeAd**). Этот значок предоставляется корпорацией Майкрософт.
  * Надпись *спонсируется* (доступен в свойстве [SponsoredBy](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.sponsoredby.aspx) объекта **NativeAd**). Этот текст предоставляется рекламодателем.
  * В качестве альтернативы для надписи *спонсируется* можно выбрать для отображения какой-либо другой текст, который помогает отличить собственную рекламу от остальных частей приложения, например «Оплаченное содержимое», «Рекламное содержимое», «Рекомендуемое содержимое» и т. п.

### <a name="user-experience"></a>Взаимодействие с пользователем

Ваша собственная реклама должна быть четко отделена от остальных частей приложения и вокруг нее должно быть свободное пространство, чтобы предотвратить случайные нажатия. Используйте границы, другой фон и некоторые другие элементы пользовательского интерфейса для отделения рекламного содержимого от остального приложения. Следует помнить, что в долгосрочной перспективе случайные нажатия не увеличат вашу прибыль от рекламы и не улучшат впечатление пользователей от приложения.

### <a name="description"></a>Описание

Если вы решили показывать описание для рекламы (доступно в свойстве [Description](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.description.aspx) объекта **NativeAd**), выделите достаточно места для отображения по крайней мере 75 символов. Рекомендуется использовать анимацию для отображения всего содержимого описания рекламы.

### <a name="call-to-action"></a>Призыв к действию

Текст *призыва к действию* (доступен в свойстве [CallToAction](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.nativead.calltoaction.aspx) объекта **NativeAd**) является важнейшим компонентом рекламы. Если вы решили показывать этот текст, выполняйте следующие рекомендации.

* Всегда отображайте текст *призыва к действию* пользователю на реагирующих на нажатия элементах управления, например кнопках и гиперссылках.
* Всегда отображайте текст *призыва к действию* в полном объеме.
* Убедитесь, что текст *призыва к действию* отделен от другого рекламного текста рекламодателя.

### <a name="learn-and-optimize"></a>Учитесь и оптимизируйте

Мы рекомендуем создавать и использовать различные группы объявлений для каждого размещения собственной рекламы в приложении. Это позволяет получить раздельные данные отчетности для каждого размещения собственной рекламы, и эти данные можно использовать для внесения изменений и оптимизации производительности каждого размещения собственной рекламы.

## <a name="related-topics"></a>Еще по теме:

* [Монетизация с помощью рекламы](../publish/monetize-with-ads.md)
* [Настройка групп объявлений для приложения](../monetize/set-up-ad-units-in-your-app.md)
