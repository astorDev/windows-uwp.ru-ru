---
author: mcleanbyron
ms.assetid: 7CC11888-8DC6-4FEE-ACED-9FA476B2125E
description: "Используйте API отправки Магазина Windows, чтобы программным образом создавать и администрировать отправки для приложений, которые зарегистрированы в вашей учетной записи Центра разработки для Windows."
title: "Создание отправок и управление ими с помощью служб Магазина Windows"
translationtype: Human Translation
ms.sourcegitcommit: 03942eb9015487cfd5690e4b1933e4febd705971
ms.openlocfilehash: 40855465fa2f9b1c32602b1b636761b608d88fc0

---

# Создание отправок и управление ими с помощью служб Магазина Windows


Используйте *API отправки Магазина Windows*, чтобы программировать запросы и создавать отправки для приложений, надстроек (также называемых внутренними продуктами приложения или IAP) и тестовых пакетов для вашей учетной записи Центра разработки для Windows или учетной записи Центра разработки для Windows вашей организации. Этот API-интерфейс удобно использовать, если под вашей учетной записью выполняется управление большим количеством приложений или надстроек и вам необходимо оптимизировать процесс отправки для этих ресурсов. Для проверки подлинности вызовов из приложения или службы в этом интерфейсе используется служба Azure Active Directory (Azure AD).

Ниже приведен список всех действий, которые необходимо выполнить, чтобы начать работу с API отправки Магазина Windows.

1.  Убедитесь, что вы выполнили все [необходимые условия](#prerequisites).
3.  Перед вызовом метода в API отправки Магазина Windows [получите маркер доступа Azure AD](#obtain-an-azure-ad-access-token). После получения маркера доступа у вас будет 60минут, чтобы использовать его в вызовах к API отправки Магазина Windows до окончания срока действия маркера. После истечения срока действия маркера можно сформировать новый маркер.
4.  [Вызовите API отправки Магазина Windows](#call-the-windows-store-submission-api).



<span id="not_supported" />
>**Важно!**

> * Этот API можно использовать только для учетных записей Центра разработки для Windows, у которых есть разрешение на использование этого API. Это разрешение предоставляется учетным записям разработчиков поэтапно. В настоящий момент это разрешение предоставлено не всем учетным записям. Чтобы запросить ранний доступ, войдите в панель мониторинга Центра разработки, щелкните **Обратная связь** в нижней части панели, выберите пункт **API отправки** в разделе обратной связи и отправьте запрос. Когда для вашей учетной записи будет предоставлено разрешение, вы получите уведомление по электронной почте.
<br/><br/>
> * Этот API нельзя применять для работы с приложениями или надстройками, в которых используются функции, добавленные в панель мониторинга Центра разработки в августе 2016года, включая (но не ограничиваясь ими) обязательные обновления приложений и надстройки потребляемого типа, управляемые Магазином. Если вы используете API отправки Магазина Windows с приложением или надстройкой, в которой есть одна из этих функций, API вернет код ошибки 409. В этом случае для управления отправками для приложения или надстройки необходимо будет использовать информационную панель.
<br/><br/>
> * В ближайшем будущем корпорация Майкрософт изменит модель ценообразования для отправок приложений в Центре разработки для Windows. После вступления в силу этого изменения ресурсы **Pricing** для отправок приложений и надстроек больше не будут поддерживаться, и вы временно не сможете получить пробные данные по периоду, цене и продажам для этих отправок с помощью API отправки Магазина Windows. Мы будем обновлять API в будущем для создания нового способа программного доступа к информации о ценах для отправок приложений и надстроек. Дополнительные сведения см. в разделе [Ресурс Pricing для отправок приложений](manage-app-submissions.md#pricing-object) и [Ресурс Pricing для отправок надстроек](manage-add-on-submissions.md#pricing-object).


<span id="prerequisites" />
## Шаг 1. Выполнение необходимых условий для использования API отправки магазина Windows

Перед тем как начать писать код для вызова API отправки Магазина Windows, убедитесь, что вы выполнили следующие необходимые условия.

* У вас (или у вашей организации) должен быть каталог Azure AD, а также разрешение [глобального администратора](http://go.microsoft.com/fwlink/?LinkId=746654) для этого каталога. Если вы уже используете Office 365 или другие бизнес-службы Майкрософт, то у вас уже есть Azure Active Directory. В противном случае можно [создать новый каталог Azure AD в Центре разработки](https://msdn.microsoft.com/windows/uwp/publish/manage-account-users) без дополнительной платы.

* Вы должны [привязать приложение Azure AD к своей учетной записи Центра разработки для Windows](#associate-an-azure-ad-application-with-your-windows-dev-center-account) и получить идентификатор владельца, идентификатор клиента и ключ. Эти данные вам понадобятся для получения маркера доступа Azure AD, который будет использоваться в вызовах к API отправки Магазина Windows.

* Подготовка приложения для использования с API отправки Магазина Windows.

  * Если ваше приложение еще отсутствует в Центре разработки, [создайте приложение на напели мониторинга Центра разработки](https://msdn.microsoft.com/windows/uwp/publish/create-your-app-by-reserving-a-name). API отправки Магазина Windows нельзя использовать для создания приложения в Центре разработки; необходимо создать приложение с помощью панели мониторинга, а затем использовать API для доступа к приложению и программного создания отправки для него. Однако API можно использовать для программного создания надстроек и тестовых пакетов, прежде чем вы начнете создавать для них отправки.

  * Перед тем как можно будет создать отправку для конкретного приложения с помощью этого API, сначала необходимо [создать одну отправку для приложения на панели мониторинга Центра разработки](https://msdn.microsoft.com/windows/uwp/publish/app-submissions) и указать сведения для [возрастной категории](https://msdn.microsoft.com/windows/uwp/publish/age-ratings). После этого можно будет программным образом создавать новые отправки для этого приложения с помощью API. Необходимость в создании отправки надстройки или отправки тестового пакета перед началом использования API для этих типов отправок отсутствует.

  * Если при создании или обновлении отправки приложения требуется добавить пакет приложения, [подготовьте пакет приложения](https://msdn.microsoft.com/windows/uwp/publish/app-package-requirements).

  * Если при создании или обновлении отправки приложения требуется добавить снимки экрана или изображения для описания в Магазине, [подготовьте снимки экрана и изображения приложения](https://msdn.microsoft.com/windows/uwp/publish/app-screenshots-and-images).

  * Если при создании или обновлении отправки надстройки требуется добавить значок, [подготовьте значок](https://msdn.microsoft.com/windows/uwp/publish/create-iap-descriptions#icon).

<span id="associate-an-azure-ad-application-with-your-windows-dev-center-account" />
### Привязка приложения Azure AD к учетной записи в Центре разработки для Windows

Прежде чем можно будет использовать API отправки Магазина Windows, необходимо привязать приложение Azure AD к учетной записи Центра разработки, получить идентификатор владельца и идентификатор клиента для приложения, а также сформировать ключ. Приложение Azure AD представляет собой приложение или службу, из которой отправляются вызовы к API отправки Магазина Windows. Чтобы получить маркер доступа Azure AD, который вы передадите в API, необходимо иметь в наличии идентификатор владельца, идентификатор клиента и ключ.

>**Примечание.**&nbsp;&nbsp;Эту операцию необходимо выполнить только один раз. После того как вы получите идентификатор владельца, идентификатор клиента и ключ, их можно будет использовать повторно в любое время для создания нового маркера доступа Azure AD.

1.  В Центре разработки перейдите в раздел **Параметры учетной записи**, щелкните **Управление пользователями** и привяжите учетную запись своей организации в Центре разработки к каталогу Azure AD вашей организации. Подробные инструкции см. в разделе [Управление учетными записями пользователей](https://msdn.microsoft.com/windows/uwp/publish/manage-account-users).

2.  На странице **Управление пользователями** нажмите кнопку **Добавить приложения Azure AD**, добавьте приложение Azure AD, представляющее собой приложение или службу, которые вы будете использовать для доступа к отправкам вашей учетной записи Центра разработки, и назначьте ему роль **Менеджер**. Если приложение уже есть в каталоге Azure AD, вы можете выбрать его на странице **Добавление приложений Azure AD**, чтобы добавить его к учетной записи Центра разработки. Также можно создать приложение Azure AD на странице **Добавление приложений Azure AD**. Дополнительные сведения см. в разделе [Добавление приложений Azure Active Directory и управление ими](https://msdn.microsoft.com/windows/uwp/publish/manage-account-users#add-and-manage-azure-ad-applications).

3.  Вернитесь на страницу **Управление пользователями**, щелкните имя приложения Azure AD, чтобы перейти к параметрам приложения и скопируйте **идентификатора владельца** и **идентификатор клиента**.

4. Нажмите кнопку **Добавить новый ключ**. На следующем экране скопируйте **ключ**. Вы не сможете получить доступ к этой информации после закрытия страницы. Дополнительные сведения об управлении ключами см. в разделе [Добавление приложений Azure Active Directory и управление ими](https://msdn.microsoft.com/windows/uwp/publish/manage-account-users#add-and-manage-azure-ad-applications).

<span id="obtain-an-azure-ad-access-token" />
## Шаг 2. Получение маркера доступа Azure AD

Перед тем как можно будет вызвать любой из методов в API отправки Магазина Windows, сначала необходимо получить маркер доступа Azure AD и передать его в заголовок **Авторизация** каждого метода в API. После получения маркера доступа у вас будет 60 минут, чтобы использовать его до окончания срока действия маркера. После истечения срока действия маркера вы можете обновить его, чтобы дальше использовать в последующих вызовах к API.

Для получения маркера доступа следуйте инструкциям в разделе [Вызовы между службами с помощью учетных данных клиентов](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-service-to-service/), чтобы отправить HTTP-запрос POST в конечную точку ```https://login.microsoftonline.com/<tenant_id>/oauth2/token```. Ниже приведен пример запроса.

```
POST https://login.microsoftonline.com/<your_tenant_id>/oauth2/token HTTP/1.1
Host: login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded; charset=utf-8

grant_type=client_credentials
&client_id=<your_client_id>
&client_secret=<your_client_secret>
&resource=https://manage.devcenter.microsoft.com
```

Для параметров *tenant\_id*, *client\_id* и *client\_secret* укажите идентификатор владельца, идентификатор клиента и ключ вашего приложения, которые вы получили из Центра разработки после выполнения инструкций в предыдущем разделе. Для параметра *resource* укажите следующий универсальный код ресурса (URI): ```https://manage.devcenter.microsoft.com```.

После истечения срока действия маркера доступа вы можете обновить его, следуя инструкциям, приведенным [здесь](https://azure.microsoft.com/documentation/articles/active-directory-protocols-oauth-code/#refreshing-the-access-tokens).

<span id="call-the-windows-store-submission-api">
## Шаг 3. Использование API отправки Магазина Windows

После получения маркера доступа Azure AD можно будет вызывать методы в API отправки Магазина Windows. В состав API входит большое количество методов, которые сгруппированы в сценарии для приложения, надстроек и тестовых пакетов. Чтобы создать или обновить отправки, как правило, необходимо вызвать несколько методов в API отправки Магазина Windows API в определенном порядке. Сведения о каждом сценарии и синтаксисе каждого метода см. в статьях, приведенных в следующей таблице.

>**Примечание.**&nbsp;&nbsp;После получения маркера доступа у вас будет 60минут, чтобы использовать его в вызовах к API отправки Магазина Windows до окончания срока действия маркера.

| Сценарий       | Описание                                                                 |
|---------------|----------------------------------------------------------------------|
| Приложения |  Получите данные для всех приложений, которые зарегистрированы в вашей учетной записи Центра разработки для Windows, и создавайте отправки для приложений. Дополнительные сведения об этих методах см. в следующих статьях. <ul><li>[Получение данных приложения](get-app-data.md)</li><li>[Управление отправками приложений](manage-app-submissions.md)</li></ul> |
| Надстройки | Получайте, создавайте или удаляйте надстройки для ваших приложений, а затем получайте, создавайте или удаляйте отправки для надстроек. Дополнительные сведения об этих методах см. в следующих статьях. <ul><li>[Управление надстройками](manage-add-ons.md)</li><li>[Управление отправками надстроек](manage-add-on-submissions.md)</li></ul> |
| Тестовые пакеты | Получайте, создавайте или удаляйте тестовые пакеты для ваших приложений, а затем получайте, создавайте или удаляйте отправки для тестовых пакетов. Дополнительные сведения об этих методах см. в следующих статьях. <ul><li>[Управление тестовыми пакетами](manage-flights.md)</li><li>[Управление отправками тестового пакета](manage-flight-submissions.md)</li></ul> |

<span />

## Примеры кода

Следующие статьи содержат подробные примеры кода на нескольких разных языках программирования, демонстрирующие способы использования API отправки Магазина Windows.

* [Примеры кода на C#](csharp-code-examples-for-the-windows-store-submission-api.md)
* [Примеры кода на Java](java-code-examples-for-the-windows-store-submission-api.md)
* [Примеры кода на Python](python-code-examples-for-the-windows-store-submission-api.md)

## Диагностика

| Проблема      | Решение                                          |
|---------------|---------------------------------------------|
| После вызова API отправки Магазина Windows из PowerShell данные ответа для API повреждаются при их преобразовании из формата JSON в объект PowerShell с помощью командлета [ConvertFrom-Json](https://technet.microsoft.com/en-us/library/hh849898.aspx) и обратно в формат JSON с помощью командлета [ConvertTo-Json](https://technet.microsoft.com/en-us/library/hh849922.aspx). |  По умолчанию параметру *-Depth* для командлета [ConvertTo-Json](https://technet.microsoft.com/en-us/library/hh849922.aspx) задано значение 2 уровней объектов, которое является слишком плоским для большинства объектов JSON, возвращаемых API отправки Магазина Windows. При вызове командлета [ConvertTo Json](https://technet.microsoft.com/en-us/library/hh849922.aspx) задайте параметру *-Depth* более высокое значение (например, 20). |

## Дополнительная справка

Если у вас есть вопросы по работе с API отправки Магазина Windows или вам нужна помощь в управлении отправками с помощью этого API, используйте следующие веб-ресурсы.

* Задайте вопрос на наших [форумах](https://social.msdn.microsoft.com/Forums/windowsapps/en-us/home?forum=wpsubmit).
* Посетите нашу [страницу поддержки](https://developer.microsoft.com/windows/support) и запросите один из вариантов технической поддержки для панели мониторинга Центра разработки. Если вам будет предложено выбрать тип проблемы и категорию, выберите **Отправка и сертификация приложения** и **Отправка приложения** соответственно.  

## Связанные разделы

* [Получение данных приложения](get-app-data.md)
* [Управление отправками приложений](manage-app-submissions.md)
* [Управление надстройками](manage-add-ons.md)
* [Управление отправками надстроек](manage-add-on-submissions.md)
* [Управление тестовыми пакетами](manage-flights.md)
* [Управление отправками тестового пакета](manage-flight-submissions.md)
 



<!--HONumber=Nov16_HO1-->


