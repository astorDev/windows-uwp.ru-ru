---
description: Этот метод можно используйте в API анализа Microsoft Store для получения надстройки статистические данные о приобретении в формате JSON для приложений универсальной платформы Windows и Xbox One игры, которые были, полученные через портал разработчиков Xbox (XDP) и доступна на панели мониторинга центра партнеров XDP Analytics.
title: Получение данных приобретения надстройки для игр и приложений
ms.date: 03/06/2019
ms.topic: article
keywords: windows 10, uwp, рекламная сеть, метаданные приложения
ms.localizationpriority: medium
ms.openlocfilehash: 518648d52c613a3dd5f1bca0d34a7f533b59733f
ms.sourcegitcommit: df8e4143e81a1c5fe1aa5f14407b8dd5f155a12e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2019
ms.locfileid: "57829910"
---
# <a name="get-add-on-acquisitions-data-for-your-games-and-apps"></a>Получение данных приобретения надстройки для игр и приложений 
Этот метод можно используйте в API анализа Microsoft Store для получения надстройки статистические данные о приобретении в формате JSON для приложений универсальной платформы Windows и Xbox One игры, которые были, полученные через портал разработчиков Xbox (XDP) и доступна на панели мониторинга центра партнеров XDP Analytics. 

## <a name="prerequisites"></a>предварительные требования
Для использования этого метода сначала необходимо сделать следующее: 

* Если вы еще не сделали этого, выполните все [необходимые условия](access-analytics-data-using-windows-store-services.md) для API аналитики для Microsoft Store. 
* [Получите маркер доступа Azure AD](access-analytics-data-using-windows-store-services.md), который будет использоваться в заголовке запроса этого метода. После получения токена доступа у вас будет 60 минут, чтобы использовать его до окончания его срока действия. После истечения срока действия токена можно получить новый токен. 

> [!NOTE]
> Этот API не поддерживает ежедневные сводные данные до 1 октября 2016 г. 

## <a name="request"></a>Запрос

### <a name="request-syntax"></a>Синтаксис запроса
| Метод | Универсальный код ресурса (URI) запроса |
| --- | --- | 
| GET | `https://manage.devcenter.microsoft.com/v1.0/my/analytics/addonacquisitions` |

### <a name="request-header"></a>Заголовок запроса 
| Header | Тип | Описание | 
| --- | --- | --- |
| Authorization | строка | Обязательный. Маркер доступа Azure AD в форме **носителя** `<token>`. |

### <a name="request-parameters"></a>Параметры запроса
*ApplicationId* или *addonProductId* параметр является обязательным. Для извлечения данных о покупках всех надстроек, зарегистрированных в приложении, укажите параметр *applicationId*. Чтобы получить данные о приобретении одной надстройки, укажите *addonProductId* параметра. Если указаны оба параметра, параметр *applicationId* игнорируется. 

| Параметр | Тип | Описание | Обязательно | 
| --- | --- | --- | --- |
| applicationId | строка | *ProductId* игры Xbox One, для которого извлекаются данные о приобретении. Чтобы получить *productId* своей игры, перейдите в игру в программе Analytics XDP и получить *productId* из URL-адрес. Кроме того, если данные приобретения загрузить отчет по аналитике центра партнеров *productId* включается в TSV-файл. | Да |
| addonProductId | строка | *ProductId* надстройки, для которого требуется извлечь данные о приобретении. | Да |
| startDate | date | Начальная дата диапазона дат, для которого требуется получить данные о покупках надстройки. По умолчанию используется текущая дата. | Нет |
| endDate | date | Конечная дата диапазона дат, для которого требуется получить данные о покупках надстройки. По умолчанию используется текущая дата. | Нет |
| top | ssNoversion | Количество строк данных, возвращаемых в запросе. Максимальное значение и значение по умолчанию (если параметр не указан) — 10 000. Если в запросе содержится больше строк, то тело ответа будет содержать ссылку "Далее", которую можно использовать для запроса следующей страницы данных | Нет |
| skip | ssNoversion | Количество строк, пропускаемых в запросе. Используйте этот параметр для постраничного перемещения по большим наборам данных. Например, при top=10000 и skip=0 извлекаются первые 10 000 строк данных; при top=10000 и skip=10000 извлекаются следующие 10 000 строк данных и т. д. | Нет |
| filter | строка | Один или несколько операторов для фильтрации строк в ответе. Каждая инструкция содержит имя поля из текста ответа и значения, которые связаны с операторами eq или ne и инструкции могут быть объединены с помощью и или или. Строковые значения должны заключаться в одинарные кавычки в параметр filter. Например, фильтр = eq рынка меня eq «US» и пол ". <br/> Вы можете указать следующие поля из тела ответа: <ul><li>**acquisitionType**</li><li>**Срок действия**</li><li>**клиентам магазинов**</li><li>**Пол**</li><li>**на рынке**</li><li>**версия ОС**</li><li>**типа устройства**</li><li>**sandboxId**</li></ul> | Нет |
| aggregationLevel | строка | Определяет диапазон времени, для которого требуется получить сводные данные. Можно использовать следующие строки: **day**, **week** или **month**. Если параметр не задан, значение по умолчанию — **day**. | Нет |
| orderby | строка | Оператор, который определяет порядок полученных значений данных для каждой покупки надстройки. Синтаксис *orderby = поле [order], [order],...* Параметр *field* может быть одной из следующих строк: <ul><li>**date**</li><li>**acquisitionType**</li><li>**Срок действия**</li><li>**клиентам магазинов**</li><li>**Пол**</li><li>**на рынке**</li><li>**версия ОС**</li><li>**типа устройства**</li><li>**orderName**</li></ul> Порядок параметров является необязательным и может быть **asc** или **desc** для указания по возрастанию или убыванию для каждого поля. Значение по умолчанию — **asc**. <br/> Пример: строка *orderby*: *orderby=date,market* | Нет |
| groupby | строка | Оператор, который применяет агрегирование данных только к указанным полям. Можно указать следующие поля: <ul><li>**date**</li><li>**ApplicationName**</li><li>**addonProductName**</li> <li>**acquisitionType**</li><li>**Срок действия**</li> <li>**клиентам магазинов**</li><li>**Пол**</li> <li>**на рынке**</li> <li>**версия ОС**</li><li>**типа устройства**</li><li>**paymentInstrumentType**</li><li>**sandboxId**</li><li>**xboxTitleIdHex**</li></ul> Возвращенные строки данных будут содержать поля, указанные в параметре *groupby*, а также: <ul><li>**date**</li><li>**Идентификатор приложения**</li><li>**addonProductId**</li><li>**Количество приобретений**</li></ul> Можно использовать параметр groupby с *aggregationLevel* параметра. Например: *& groupby = age "," маркетинг "и" aggregationLevel = неделя* | Нет |

### <a name="request-example"></a>Пример запроса
В следующих примерах демонстрируются несколько запросов на получение информации о покупках надстройки. Замените *addonProductId* и *applicationId* значений с помощью соответствующий идентификатор Store для надстройки или приложения. 

```syntax
GET https://manage.devcenter.microsoft.com/v1.0/my/analytics/addonacquisitions?applicationId=9WZDNCRFJ314&startDate=1/1/2015&endDate=2/1/2015&skip=0 HTTP/1.1 

Authorization: Bearer <your access token> 

 

GET https://manage.devcenter.microsoft.com/v1.0/my/analytics/addonacquisitions?applicationId=9WZDNCRFJ314&startDate=1/1/2015&endDate=2/1/2015&skip=0&filter=market eq 'GB' and gender eq 'm' HTTP/1.1 

Authorization: Bearer <your access token>
```

## <a name="response"></a>Ответ

### <a name="response-body"></a>Тело ответа

| Значение | Тип | Описание |
| --- | --- | --- |
| Значение | Массив | Массив объектов, содержащий сводную информацию о покупках надстройки. Дополнительные сведения о данных в каждом объекте см. далее в разделе [Значения информации о покупках надстройки](#add-on-acquisition-values). |
| @nextLink | строка | При наличии дополнительных страниц данных эта строка содержит универсальный код ресурса (URI), который можно использовать для запроса следующей страницы данных. Например, это значение возвращается в том случае, если параметр **top** запроса имеет значение 10 000, но для данного запроса имеется больше 10 000 строк с информацией о покупках надстроек. |
| TotalCount | ssNoversion | Общее количество строк в результирующих данных для запроса. |

### <a name="add-on-acquisition-values"></a>Значения информации о покупке надстройки
Элементы в массиве значений содержат следующие значения.

| Значение | Тип | Описание | 
| --- | --- | --- |
| date | строка | Первая дата в диапазоне дат, для которого требуется получить данные о покупках. Если в запросе указан один день, это значение равно соответствующей дате. Если запрос указывает неделю, месяц или другой диапазон дат, это значение равно первой дате в этом диапазоне дат |
| addonProductId | строка | *ProductId* надстройки, для которого извлекаются данные о приобретении. |
| addonProductName | строка | Отображаемое имя надстройки. Это значение отображается, только в данные ответа Если *aggregationLevel* параметр имеет значение **день**, если не указано **addonProductName** в *groupby* параметра. |
| applicationId | строка | *ProductId* приложения, для которого требуется извлечь данные о приобретении надстроек. |
| applicationName | строка | Отображаемое имя игры. |
| deviceType | строка | Одна из следующих строк, указывающая тип устройства, на котором было выполнено приобретение: <ul><li>«PC»</li><li>«Телефон»</li><li>«Консоль»</li><li>«Интернета вещей»</li><li>«Server»</li><li>«Планшета»</li><li>«Holographic»</li><li>«Неизвестно»</li></ul> |
| storeClient | строка | Одна из следующих строк, указывающая версию Store, где совершено приобретение: <ul><li>«Windows Phone Store (клиент)»</li><li>«Microsoft Store (клиент)» (или «Windows Store (клиент)» при запросе данных до 23 марта 2018 г.)</li><li>«Microsoft Store (веб)» (или «Windows Store (веб)» при запросе данных до 23 марта 2018 г.)</li><li>«Volume purchase организациями»</li><li>«Other»</li></ul> |
| osVersion | строка | Версия ОС, в которой произведена покупка. Для этого метода это значение всегда равно «Windows 10». |
| market | строка | Код страны по стандарту ISO 3166 для рынка, на котором произошла покупка |
| gender | строка | Одна из следующих строк, указывающая пол пользователя, совершившего приобретение: <ul><li>«m»</li><li>«f»</li><li>«Неизвестно»</li></ul> |
| age | строка | Одна из следующих строк, указывающая возрастную группу пользователя, совершившего приобретение: <ul><li>«меньше, чем 13»</li><li>"13-17"</li><li>"18-24"</li><li>"25-34"</li><li>"35-44"</li><li>"44-55"</li><li>«больше, чем 55»</li><li>«Неизвестно»</li></ul> |
| acquisitionType | строка | Одна из следующих строк, указывающих тип приобретения: <ul><li>«Бесплатный» </li><li>«Пробная версия» </li><li>«Оплачиваемое»</li><li>«Код» </li><li>«Iap»</li><li>«Подписка Iap»</li><li>«Audience Private»</li><li>«Pre Order»</li><li>«Xbox Game Pass» (или «Game Pass» при запросе данных до 23 марта 2018 г.)</li><li>«Диск»</li><li>«Предоплаченные код»</li><li>«Плата Pre Order»</li><li>«Отменена Pre Order»</li><li>«Failed Pre Order»</li></ul> |
| acquisitionQuantity | целое число | Количество покупок |
| inAppProductId | строка | Идентификатор продукта продукта, где используется эта надстройка.  |
| inAppProductName | строка | Название продукта, в которых используется эта надстройка.  |
| paymentInstrumentType | строка | Тип платежного средства для приобретения.  |
| sandboxId | строка | ИД "песочницы", созданные для игры. Это может быть значение **розничной ТОРГОВЛИ** или идентификатор закрытый "песочницы".  |
| xboxTitleId | строка | Идентификатор Xbox название продукта из XDP, если это применимо.  |
| localCurrencyCode | строка | Локальный код валюты, в зависимости от страны, учетной записи центра партнеров.  |
| xboxProductId | строка | Идентификатор продукта Xbox продукта из XDP, если это применимо.  |
| availabilityId | строка | Идентификатор доступности продукта из XDP, если это применимо.  |
| skuId | строка | Идентификатор SKU продукта из XDP, если это применимо.  |
| skuDisplayName | строка | Отображаемое имя SKU продукта из XDP, если это применимо.  |
| xboxParentProductId | строка | Идентификатор продукта Xbox родительского продукта из XDP, если это применимо.  |
| parentProductName | строка | Имя продукта родительского продукта из XDP, если это применимо.  |
| productTypeName | строка | Имя типа продукта продукта из XDP, если это применимо.  |
| purchaseTaxType | строка | Тип налогового покупки продукта из XDP, если это применимо.  |
| purchasePriceUSDAmount | number | Выплаченная клиентом для надстройки, преобразовать долл. США.  |
| purchasePriceLocalAmount | number | Сумма налогов, применяется в надстройку.  |
| purchaseTaxUSDAmount | number | Сумма налогов, применяется в надстройку преобразовать долл. США.  |
| purchaseTaxLocalAmount | number | Локальный сумма налога покупки продукта из XDP, если это применимо.  |

### <a name="response-example"></a>Пример ответа
В следующем примере демонстрируется пример тела ответа JSON на данный запрос. 

```JSON
{ 
  "Value": [ 
    { 
            "inAppProductId": "9NBLGGH1864K", 
            "inAppProductName": "866879", 
            "addonProductId": "9NBLGGH1864K", 
            "addonProductName": "866879", 
            "date": "2017-11-05", 
            "applicationId": "9WZDNCRFJ314", 
            "applicationName": "Tetris Blitz", 
            "acquisitionType": "Iap", 
            "age": "35-49", 
            "deviceType": "Phone", 
            "gender": "m", 
            "market": "US", 
            "osVersion": "Windows Phone 8.1", 
            "paymentInstrumentType": "Credit Card", 
            "sandboxId": "RETAIL", 
            "storeClient": "Windows Phone Store (client)", 
            "xboxTitleId": "", 
            "localCurrencyCode": "USD", 
            "xboxProductId": "00000000-0000-0000-0000-000000000000", 
            "availabilityId": "", 
            "skuId": "", 
            "skuDisplayName": "Full", 
            "xboxParentProductId": "", 
            "parentProductName": "Tetris Blitz", 
            "productTypeName": "Add-On", 
            "purchaseTaxType": "", 
            "acquisitionQuantity": 1, 
            "purchasePriceUSDAmount": 1.08, 
            "purchasePriceLocalAmount": 0.09, 
            "purchaseTaxUSDAmount": 1.08, 
            "purchaseTaxLocalAmount": 0.09 
        } 
    ], 

    "@nextLink": null, 
    
    "TotalCount": 7601 
} 
```