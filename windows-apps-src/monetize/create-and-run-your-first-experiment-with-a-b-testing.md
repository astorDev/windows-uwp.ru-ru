---
author: mcleanbyron
Description: "В этом пошаговом руководстве вы сможете создать и запустить свой первый эксперимент с использованием A/B-тестирования."
title: "Создание и запуск первого эксперимента с использованием A/B-тестирования"
ms.assetid: 16A2B129-14E1-4C68-86E8-52F1BE58F256
translationtype: Human Translation
ms.sourcegitcommit: 6530fa257ea3735453a97eb5d916524e750e62fc
ms.openlocfilehash: 0f889c22b8999408341f4c12387602b344f49439

---

# Создание и запуск первого эксперимента с использованием A/B-тестирования

В этом пошаговом руководстве вы сделаете следующее:
* создадите эксперимент на панели мониторинга в Центре разработки для Windows, чтобы выяснить, увеличится ли количество нажатий на кнопку приложения после изменения ее фонового цвета;
* создадите приложение, которое получает параметры вариантов из Центра разработки, использует эти данные для изменения фонового цвета кнопки и ведет журнал событий просмотра и конверсии в Центре разработки;
* запустите приложение для сбора данных эксперимента;
* проверите результаты эксперимента на панели мониторинга в Центре разработки, выберите вариант для всех пользователей приложения и завершите эксперимент.

Общие сведения об A/B-тестировании с помощью Центра разработки можно найти в разделе [Проведение экспериментов в приложениях с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md).

## Необходимые условия

Чтобы пройти это пошаговое руководство, вам потребуется учетная запись в Центре разработки для Windows, а также необходимо настроить компьютер, на котором ведется разработка, согласно инструкциям в разделе [Проведение экспериментов в приложениях с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md).

## Создание эксперимента в Центре разработки для Windows

1. Выполните вход на [панель мониторинга в Центре разработки](https://dev.windows.com/overview).
2. Если у вас уже есть приложение в Центре разработки и вы хотите использовать его для создания эксперимента, выберите это приложение в разделе **Ваши приложения**. Если у вас пока еще нет приложений на панели мониторинга, [создайте новое приложение, зарезервировав имя](../publish/create-your-app-by-reserving-a-name.md), а затем выберите это приложение на панели мониторинга.
3. В области навигации нажмите **Службы**, а затем — **Эксперименты**.
4. В разделе **Ключи API** выберите **Новый ключ API**, чтобы создать новый ключ API, и введите имя **Мой первый эксперимент** для ключа API. Этот ключ API потребуется вам в следующем разделе данного пошагового руководства.
5. В разделе **Эксперименты** нажмите **Новый эксперимент**. В поле **Имя эксперимента** введите имя **Оптимизация нажатий на кнопку**.
6. В поле **Имя события просмотра** введите имя **userViewedButton**. Далее в этом пошаговом руководстве вы добавите код, заносящий это событие просмотра в журнал, когда главная страница вашего приложения инициализируется, а кнопка видна пользователю.
7. В разделе **Цели и события конверсии** введите следующие значения:
  * В поле **Имя цели** введите **Увеличить количество нажатий на кнопку**.
  * В поле **Имя события конверсии** введите имя **userClickedButton**. Далее в этом пошаговом руководстве вы добавите код, заносящий это событие конверсии в журнал в обработчике событий нажатия для кнопки.
  * В поле **Цель** выберите **Максимизировать**.
8. В разделе **Варианты и параметры** трижды нажмите **Добавить параметр**. Теперь у вас должно быть четыре строки пустых параметров.
  * В первой строке введите **buttonText** в поле имени параметра, **Grey Button** в столбце **Variation A** и **Blue Button** в столбце **Variation B**.
  * Во второй строке введите **r** в поле имени параметра, **128** в столбце **Variation A** и **1** в столбце **Variation B**.
  * В третьей строке введите **g** в качестве имени параметра, **128** в столбце **Variation A** и **1** в столбце **Variation B**.
  * В четвертой строке введите **b** в качестве имени параметра, **128** в столбце **Variation A** и **255** в столбце **Variation B**.  
9. Убедитесь, что флажок **Распределить равномерно** установлен, чтобы варианты равномерно распределились в вашем приложении.
10. Нажмите **Сохранить**, а затем — **Активировать**.

> **Важно!**  После активации эксперимента изменить его параметры будет невозможно, если только это не тестовый эксперимент (при создании эксперимента вы установили флажок **Тестовый эксперимент**). Обычно мы рекомендуем создать код эксперимента в приложении, прежде чем активировать эксперимент. Для простоты в рамках этого пошагового руководства вы можете активировать эксперимент сейчас.

## Написание кода для эксперимента в приложении

1. В Visual Studio 2015 создайте новый проект универсальной платформы Windows с помощью Visual C#. Назовите проект **SampleExperiment**.
2. В обозревателе решений разверните узел проекта, щелкните правой кнопкой мыши **Ссылки**, а затем — **Добавить ссылку**.
3. В диалоговом окне **Диспетчер ссылок** разверните список **Универсальная платформа Windows** и выберите **Расширения**.
4. В списке пакетов SDK выберите флажок рядом с пунктом **Microsoft Store Engagement SDK** и нажмите кнопку **ОК**.
5. В **обозревателе решений** дважды щелкните MainPage.xaml, чтобы открыть конструктор для главной страницы приложения.
6. Перетащите **кнопку** из **панели элементов** на страницу.
7. Дважды щелкните кнопку в конструкторе, чтобы открыть файл с кодом и добавить обработчик для события **Click**.  
8. Замените все содержимое файла с кодом следующим кодом.

  ```CSharp
  using System;
  using Windows.UI.Xaml;
  using Windows.UI.Xaml.Controls;
  using Windows.UI.Xaml.Media;
  using System.Threading.Tasks;
  using Windows.UI;
  using Windows.UI.Core;

  // Namespace for A/B testing.
  using Microsoft.Services.Store.Engagement;

  namespace SampleExperiment
  {  
    public sealed partial class MainPage : Page
    {
        private readonly ExperimentClient experiment;
        private ExperimentVariation variation;

        // Assign this variable to your API key from Dev Center. The API key
        // shown below is for example purposes only.
        private string apiKey = "F48AC670-4472-4387-AB7D-D65B095153FB";    

        public MainPage()
        {
            this.InitializeComponent();

            // Initialize the ExperimentClient for A/B testing.
            experiment = new ExperimentClient(apiKey);

            // Because this call is not awaited, execution of the current method
            // continues before the call is completed.
            #pragma warning disable CS4014
            Initialize();
            #pragma warning restore CS4014
        }

        private async Task Initialize()
        {
            // Get the current cached variation assignment for the experiment.
            ExperimentVariationResult result = await experiment.GetVariationAsync();
            variation = result.Variation;

            // Check whether the cached variation assignment needs to be refreshed.
            // If so, then refresh it.
            if (result.ErrorCode != EngagementErrorCode.Success || result.Variation.NeedsRefresh)
            {
                result = await experiment.RefreshVariationAsync();

                // If the call succeeds, use the new result. Otherwise, use the cached value.
                if (result.ErrorCode == EngagementErrorCode.Success)
                {
                    variation = result.Variation;
                }
            }

            // Get settings named "buttonText", "r", "g", and "b" from the variation
            // assignment. If no variation assignment is available, the settings default
            // to "Grey button" for the button text and grey RGB value for the button color.
            var buttonText = variation.GetString("buttonText", "Grey Button");
            var r = (byte)variation.GetInteger("r", 128);
            var g = (byte)variation.GetInteger("g", 128);
            var b = (byte)variation.GetInteger("b", 128);

            // Assign button text and color.
            await button.Dispatcher.RunAsync(
                CoreDispatcherPriority.Normal,
                () =>
                {
                    button.Background = new SolidColorBrush(Color.FromArgb(255, r, g, b));
                    button.Content = buttonText;
                    button.Visibility = Visibility.Visible;
                });

            // Log the view event named "userViewedButton" to Dev Center.
            StoreServicesCustomEvents.Log("userViewedButton", variation);
        }

        private void button_Click(object sender, RoutedEventArgs e)
        {
            // Log the conversion event named "userClickedButton" to Dev Center.
            StoreServicesCustomEvents.Log("userClickedButton", variation);
        }
     }
  }
  ```
9. В следующей строке кода назначьте переменную *apiKey* ключу API, который вы получили на панели мониторинга в Центре разработки в предыдущем разделе. Указанный ниже ключ API используется только в качестве примера.
```CSharp
private string apiKey = "F48AC670-4472-4387-AB7D-D65B095153FB";
```
10. Сохраните файл с кодом и создайте проект.

## Запуск приложения для сбора данных эксперимента

1. Запустите приложение **SampleExperiment**, созданное в предыдущем разделе.
2. Убедитесь, что видите серую или синюю кнопку. Нажмите на кнопку и закройте приложение.
3. Повторите указанные выше действия несколько раз на одном и том же компьютере, чтобы убедиться, что в вашем приложении отображается кнопка одного и того же цвета.

## Проверка результатов и завершение эксперимента

Подождите хотя бы несколько часов после завершения предыдущего раздела, а затем выполните следующие действия, чтобы проверить результаты эксперимента и завершить его.

> **Примечание** После активации эксперимента Центр разработки сразу же начинает собирать данные из всех приложений, которые ведут журнал для эксперимента. Однако может пройти несколько часов, прежде чем данные эксперимента появятся на панели мониторинга.

1. В Центре разработки вернитесь на страницу **Эксперименты** вашего приложения.
2. В разделе **Эксперименты** нажмите фильтр **Активные**, а затем — эксперимент **Оптимизировать нажатия на кнопку**, чтобы перейти на страницу этого эксперимента.
3. Убедитесь, что результаты в разделах **Сводка по результатам** и **Подробные сведения о результатах** соответствуют вашим ожиданиям. Дополнительные сведения об этих разделах можно найти в разделе [Управление экспериментом на панели мониторинга в Центре разработки](manage-your-experiment.md#review-the-results-of-your-experiment).

  >**Примечание.** Центр разработки регистрирует только первое событие конверсии для каждого пользовательского просмотра в течение 24 часов. Если благодаря действиям пользователя срабатывает несколько событий конверсии в вашем приложении в течение 24 часов, регистрируется только первое событие. Это позволяет предотвратить искажение результатов эксперимента для выборки пользователей из-за пользователя со множеством событий конверсии.

4. Теперь вы можете завершить эксперимент. В разделе **Сводка по результатам** в столбце **Variation B** нажмите **Переключить**. Так вы переключите всех пользователей своего приложения на синюю кнопку.
5. Нажмите кнопку **ОК**, чтобы подтвердить завершение эксперимента.
6. Запустите приложение **SampleExperiment**, созданное в предыдущем разделе.
7. Убедитесь, что видите синюю кнопку. Обратите внимание, что может пройти до двух минут, прежде чем ваше приложение получит обновленное назначение варианта.

## Связанные разделы

  * [Определение эксперимента на панели мониторинга в Центре разработки](define-your-experiment-in-the-dev-center-dashboard.md)
  * [Создание кода для проведения эксперимента в приложении](code-your-experiment-in-your-app.md)
  * [Управление экспериментом на панели мониторинга в Центре разработки](manage-your-experiment.md)
  * [Проведение экспериментов в приложении с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md)



<!--HONumber=Jun16_HO4-->


