---
author: mcleanbyron
Description: "В этом пошаговом руководстве вы сможете создать, запустить и администрировать свой первый эксперимент с использованием A/B-тестирования."
title: "Создание и запуск первого эксперимента с использованием A/B-тестирования"
ms.assetid: 16A2B129-14E1-4C68-86E8-52F1BE58F256
translationtype: Human Translation
ms.sourcegitcommit: bfe4862c441ca095a40df4f594fdf9b3e213d142
ms.openlocfilehash: ab15741531b829c496811cdfca35059cd113f91d

---

# Создание и запуск первого эксперимента с использованием A/B-тестирования

В этом пошаговом руководстве вы сделаете следующее.
* Создадите [проект](run-app-experiments-with-a-b-testing.md#terms) эксперимента на панели мониторинга Центра разработки, в котором будет определено несколько удаленных переменных, отвечающих за текст и цвет кнопки приложения.
* Создадите приложение с кодом, который будет получать значения удаленных переменных, использовать эти данные для изменения фонового цвета кнопки и вести журнал событий просмотра и конверсии в Центре разработки.
* Создадите эксперимент в проекте, чтобы выяснить, увеличится ли количество нажатий кнопки приложения после изменения ее фонового цвета.
* Запустите приложение для сбора данных эксперимента.
* Проверите результаты эксперимента на панели мониторинга Центра разработки, выберите вариант для всех пользователей приложения и завершите эксперимент.

Общие сведения об A/B-тестировании с помощью Центра разработки можно найти в разделе [Проведение экспериментов в приложениях с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md).

## Необходимые условия

Чтобы пройти это пошаговое руководство, вам потребуется учетная запись в Центре разработки для Windows. Также будет необходимо настроить компьютер, на котором ведется разработка, согласно инструкциям в разделе [Проведение экспериментов в приложениях с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md).

## Создание проекта с удаленными переменными в Центре разработки для Windows

1. Выполните вход в [панель мониторинга Центра разработки](https://dev.windows.com/overview).
2. Если у вас уже есть приложение в Центре разработки и вы хотите использовать его для создания эксперимента, выберите это приложение на панели мониторинга. Если у вас пока еще нет приложений на панели мониторинга, [создайте новое приложение, зарезервировав имя](../publish/create-your-app-by-reserving-a-name.md), а затем выберите это приложение на панели мониторинга.
3. В области навигации нажмите **Службы**, а затем **Эксперименты**.
4. В разделе **Проекты** на следующей странице нажмите кнопку **Создать проект**.
5. На странице **Новый проект** введите имя **Button Click Experiments (эксперименты нажатия кнопки)** для проекта.
6. Разверните раздел **Удаленные переменные** и нажмите кнопку **Добавить переменную** четыре раза. Теперь у вас должно быть четыре строки пустых переменных.
  * В первой строке введите **buttonText (текст кнопки)** в качестве имени переменной, а затем введите **Grey Button (серая кнопка)** в столбце **Значение по умолчанию**.
  * Во второй строке введите **r** в качестве имени переменной, а затем введите **128** в столбце **Значение по умолчанию**.
  * Во третье строке введите **g** в качестве имени переменной, а затем введите **128** в столбце **Значение по умолчанию**.
  * В четвертой строке введите **b** в качестве имени переменной, а затем введите **128** в столбце **Значение по умолчанию**.
7. Нажмите кнопку **Сохранить** и запомните [идентификатор проекта](run-app-experiments-with-a-b-testing.md#terms), который отобразится в разделе **Интеграция SDK**. В следующем разделе описано, как обновить код приложения и установить ссылку на это значение в вашем коде.

## Написание кода для эксперимента в приложении

1. В Visual Studio 2015 создайте новый проект универсальной платформы Windows с помощью Visual C#. Назовите проект **SampleExperiment**.
2. В обозревателе решений разверните узел проекта, щелкните правой кнопкой мыши **Ссылки**, а затем— **Добавить ссылку**.
3. В диалоговом окне **Диспетчер ссылок** разверните список **Универсальная платформа Windows** и выберите **Расширения**.
4. В списке пакетов SDK установите флажок рядом с пунктом **Microsoft Engagement Framework** и нажмите кнопку **ОК**.
5. В **Обозревателе решений** дважды щелкните файл MainPage.xaml, чтобы открыть конструктор для главной страницы приложения.
6. Перетащите **кнопку** из **панели элементов** на страницу.
7. Дважды щелкните кнопку в конструкторе, чтобы открыть файл с кодом и добавить обработчик для события **Click**.  
8. Замените все содержимое файла с кодом следующим кодом. Назначьте переменную ```projectId``` значению [идентификатора проекта](run-app-experiments-with-a-b-testing.md#terms), которое вы получили на панели мониторинга Центра разработки в ходе выполнения действий в предыдущем разделе.

  ```CSharp
  using System;
  using Windows.UI.Xaml;
  using Windows.UI.Xaml.Controls;
  using Windows.UI.Xaml.Media;
  using System.Threading.Tasks;
  using Windows.UI;
  using Windows.UI.Core;

  // Namespace for A/B testing.
  using Microsoft.Services.Store.Engagement;

  namespace SampleExperiment
  {  
     public sealed partial class MainPage : Page
     {
        private StoreServicesExperimentVariation variation;
        private StoreServicesCustomEventLogger logger;

        // Assign this variable to the project ID for your experiment from Dev Center.
        private string projectId = "";

        public MainPage()
        {
            this.InitializeComponent();

            // Because this call is not awaited, execution of the current method
            // continues before the call is completed.
#pragma warning disable CS4014
            InitializeExperiment();
#pragma warning restore CS4014
        }

        private async Task InitializeExperiment()
        {
            // Get the current cached variation assignment for the experiment.
            var result = await StoreServicesExperimentVariation.GetCachedVariationAsync(projectId);
            variation = result.ExperimentVariation;

            // Check whether the cached variation assignment needs to be refreshed.
            // If so, then refresh it.
            if (result.ErrorCode != StoreServicesEngagementErrorCode.None || result.ExperimentVariation.IsStale)
            {
                result = await StoreServicesExperimentVariation.GetRefreshedVariationAsync(projectId);

                // If the call succeeds, use the new result. Otherwise, use the cached value.
                if (result.ErrorCode == StoreServicesEngagementErrorCode.None)
                {
                    variation = result.ExperimentVariation;
                }
            }

            // Get remote variables named "buttonText", "r", "g", and "b" from the variation
            // assignment. If no variation assignment is available, the variables default
            // to "Grey button" for the button text and grey RGB value for the button color.
            var buttonText = variation.GetString("buttonText", "Grey Button");
            var r = (byte)variation.GetInt32("r", 128);
            var g = (byte)variation.GetInt32("g", 128);
            var b = (byte)variation.GetInt32("b", 128);

            // Assign button text and color.
            await button.Dispatcher.RunAsync(
                CoreDispatcherPriority.Normal,
                () =>
                {
                    button.Background = new SolidColorBrush(Color.FromArgb(255, r, g, b));
                    button.Content = buttonText;
                    button.Visibility = Visibility.Visible;
                });

            // Log the view event named "userViewedButton" to Dev Center.
            if (logger == null)
            {
                logger = StoreServicesCustomEventLogger.GetDefault();
            }

            logger.LogForVariation(variation, "userViewedButton");
        }

        private void button_Click(object sender, RoutedEventArgs e)
        {
            // Log the conversion event named "userClickedButton" to Dev Center.
            if (logger == null)
            {
                logger = StoreServicesCustomEventLogger.GetDefault();
            }

            logger.LogForVariation(variation, "userClickedButton");
        }
     }
  }
  ```
10. Сохраните файл с кодом и создайте проект.

## Создание эксперимента в Центре разработки для Windows

1. Вернитесь на страницу проекта **Button Click Experiments (эксперименты нажатия кнопки)** на панели мониторинга Центра разработки для Windows.
2. В разделе **Эксперименты** нажмите кнопку **Создать эксперимент**.
5. В разделе **Сведения об эксперименте** введите имя **Optimize Button Clicks (оптимизация нажатий кнопки)** в поле **Имя эксперимента**.
6. В разделе **Событие просмотра** введите **userViewedButton** в поле **Имя события просмотра**. Обратите внимание, что это имя совпадает со строкой события просмотра, которую вы включили в код, добавленный в предыдущем разделе.
7. В разделе **Цели и события конверсии** введите следующие значения:
  * В поле **Имя цели** введите **Увеличить количество нажатий на кнопку**.
  * В поле **Имя события конверсии** введите имя **userClickedButton**. Обратите внимание, что это имя совпадает со строкой события конверсии, которую вы включили в код, добавленный в предыдущем разделе.
  * В поле **Цель** выберите **Максимизировать**.
8. В разделе **Удаленные переменные и варианты** установите флажок **Распределять равномерно**, чтобы в вашем приложении варианты распределялись равномерно.
9. Добавьте переменные в ваш эксперимент:
  9. Щелкните раскрывающийся элемент управления, выберите **buttonText** и нажмите **Добавить переменную**. Строка **Grey Button (серая кнопка)** автоматически отобразится в столбце **Вариант А** (это значение извлекается из параметров проекта). В столбце **Вариант Б** введите **Blue Button (синяя кнопка)**.
  9. Щелкните раскрывающийся элемент управления еще раз, выберите **r** и нажмите **Добавить переменную**. Строка **128** автоматически отобразится в столбце **Вариант А**. В столбце **Вариант Б** введите **1**.
  9. Щелкните раскрывающийся элемент управления еще раз, выберите **g** и нажмите **Добавить переменную**. Строка **128** автоматически отобразится в столбце **Вариант А**. В столбце **Вариант Б** введите **1**.  
  9. Щелкните раскрывающийся элемент управления еще раз, выберите **b** и нажмите **Добавить переменную**. Строка **128** автоматически отобразится в столбце **Вариант А**. В столбце **Вариант Б** введите **255**.  
10. Нажмите **Сохранить**, а затем **Активировать**.

> **Важно!**&nbsp;&nbsp;После активации эксперимента изменить его параметры будет невозможно, если только это не редактируемый эксперимент (при создании эксперимента вы установили флажок **Редактируемый эксперимент**). Обычно рекомендуется создать код эксперимента в приложении, прежде чем активировать эксперимент.

## Запуск приложения для сбора данных эксперимента

1. Запустите приложение **SampleExperiment**, которое вы создали ранее.
2. Убедитесь, что видите серую или синюю кнопку. Нажмите кнопку и закройте приложение.
3. Повторите указанные выше действия несколько раз на одном и том же компьютере, чтобы убедиться, что в вашем приложении отображается кнопка одного и того же цвета.

## Проверка результатов и завершение эксперимента

Подождите хотя бы несколько часов после завершения предыдущего раздела, а затем выполните следующие действия, чтобы проверить результаты эксперимента и завершить его.

> **Примечание.**&nbsp;&nbsp;После активации эксперимента Центр разработки сразу же начинает собирать данные из всех приложений, которые ведут журнал для эксперимента. Однако может пройти несколько часов, прежде чем данные эксперимента появятся на панели мониторинга.

1. В Центре разработки вернитесь на страницу **Эксперименты** вашего приложения.
2. В разделе **Активные эксперименты** нажмите **Optimize Button Clicks (оптимизация нажатий кнопки)**, чтобы перейти на страницу этого эксперимента.
3. Убедитесь, что результаты в разделах **Сводка по результатам** и **Подробные сведения о результатах** соответствуют вашим ожиданиям. Дополнительные сведения об этих разделах можно найти в разделе [Управление экспериментом на панели мониторинга в Центре разработки](manage-your-experiment.md#review-the-results-of-your-experiment).

  >**Примечание.**&nbsp;&nbsp;Центр разработки регистрирует только первое событие конверсии для каждого пользовательского просмотра в течение 24 часов. Если благодаря действиям пользователя срабатывает несколько событий конверсии в вашем приложении в течение 24 часов, регистрируется только первое событие. Это позволяет предотвратить искажение результатов эксперимента для выборки пользователей из-за пользователя со множеством событий конверсии.
4. Теперь вы можете завершить эксперимент. В разделе **Сводка по результатам** в столбце **Variation B** нажмите **Переключить**. Так вы переключите всех пользователей своего приложения на синюю кнопку.
5. Нажмите кнопку **ОК**, чтобы подтвердить завершение эксперимента.
6. Запустите приложение **SampleExperiment**, созданное в предыдущем разделе.
7. Убедитесь, что видите синюю кнопку. Обратите внимание, что может пройти до двух минут, прежде чем ваше приложение получит обновленное назначение варианта.

## Связанные разделы

* [Создание проекта и определение удаленных переменных на панели мониторинга Центра разработки](create-a-project-and-define-remote-variables-in-the-dev-center-dashboard.md)
* [Кодирование приложения для экспериментов](code-your-experiment-in-your-app.md)
* [Определение эксперимента на панели мониторинга Центра разработки](define-your-experiment-in-the-dev-center-dashboard.md)
* [Управление экспериментом на панели мониторинга Центра разработки](manage-your-experiment.md)
* [Выполнение экспериментов в приложении с использованием A/B-тестирования](run-app-experiments-with-a-b-testing.md)



<!--HONumber=Sep16_HO1-->


