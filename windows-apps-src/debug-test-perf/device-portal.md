---
ms.assetid: 60fc48dd-91a9-4dd6-a116-9292a7c1f3be
title: Обзор портала устройств Windows
description: Узнайте, как портал устройств Windows позволяет настраивать устройство и управлять им удаленно через сеть или USB-подключение.
ms.date: 04/09/2019
ms.topic: article
keywords: Windows 10, UWP, портал устройств
ms.localizationpriority: medium
ms.openlocfilehash: 2292d97166d34905bb895aa3f53f864510a21f46
ms.sourcegitcommit: b52ddecccb9e68dbb71695af3078005a2eb78af1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74254764"
---
# <a name="windows-device-portal-overview"></a>Обзор портала устройств Windows

Портал Windows Device Portal позволяет настроить устройство и управлять им удаленно по сети или подключению USB. Он также предоставляет дополнительные средства диагностики, которые позволяют устранять неисправности и просматривать данные о производительности устройства с Windows в режиме реального времени.

Портал устройств Windows — это веб-сервер на устройстве, к которому можно подключаться из веб-браузера на ПК. Если устройство оснащено веб-браузером, можно также подключаться локально из браузера на устройстве.

Портал устройств Windows доступен для каждого семейства устройств, однако функциональные возможности и настройки зависят от требований определенного устройства. В этой статье дается общее описание портала устройства, а также приведены ссылки на статьи, содержащие более подробные сведения по каждому семейству устройств.

Функциональность портала устройств Windows реализована на [API-интерфейсах REST](device-portal-api-core.md), которые можно использовать для прямого доступа к данным и программного управления устройством.

## <a name="setup"></a>Установка

Каждое устройство имеет свои инструкции для подключения к порталу устройства, однако к каждому из них применимы следующие общие действия:

1. Включите режим разработчика и портал устройств на своем устройстве (настраивается в приложении "Параметры").

2. Подключите устройство к ПК по локальной сети или через USB.

3. Перейдите на страницу портала устройства в своем браузере. В этой таблице показаны порты и протоколы, используемые каждым семейством устройств.

Семейство устройств | Включено по умолчанию? | HTTP | HTTPS | USB
--------------|----------------|------|-------|----
HoloLens | Да, в режиме разработки | 80 (по умолчанию) | 443 (по умолчанию) | http://127.0.0.1:10080
Интернет вещей | Да, в режиме разработки | 8080 | Включается через раздел реестра | Н/Д
Xbox | Включается в режиме разработки | Отключен | 11443 | Н/Д
Рабочий стол| Включается в режиме разработки | 50080\* | 50043\* | Н/Д
Телефон | Включается в режиме разработки | 80| 443 | http://127.0.0.1:10080

\* Это не всегда так, поскольку портал устройств на настольном компьютере использует порты в диапазоне временных портов (>50 000), чтобы предотвратить конфликты с существующими запросами на использование портов на устройстве. Подробнее см. в разделе [Параметры портов](device-portal-desktop.md#registry-based-configuration-for-device-portal) для настольных компьютеров.  

Конкретные инструкции по настройке устройства см. в разделах:

- [Портал устройств для HoloLens](https://docs.microsoft.com/windows/uwp/debug-test-perf/device-portal-hololens)
- [Портал устройств для Интернета вещей](https://docs.microsoft.com/windows/iot-core/manage-your-device/DevicePortal)
- [Портал устройств для мобильных устройств](device-portal-mobile.md)
- [Портал устройств для Xbox](../xbox-apps/device-portal-xbox.md)
- [Портал устройств для компьютера](device-portal-desktop.md#set-up-device-portal-on-windows-desktop)

## <a name="features"></a>Возможности

### <a name="toolbar-and-navigation"></a>Панель инструментов и навигация

Панель инструментов в верхней части страницы предоставляет доступ к часто используемым функциям.

- **Power** (Питание): доступ к параметрам электропитания.
  - **Shutdown** (Завершение работы): отключает устройство.
  - **Restart** (Перезапуск): выключает и включает питание на устройстве.
- **Help** (Справка): открывает страницу справки.

Используйте ссылки на панели навигации вдоль левой стороны страницы для перехода к доступным для вашего устройства средствам управления и мониторинга.

Здесь описываются средства, которые являются общими для разных семейств устройств. В зависимости от устройства могут быть доступны другие параметры. Дополнительные сведения см. на странице, посвященной вашему типу устройств.

### <a name="apps-manager"></a>Диспетчер приложений

Диспетчер приложений предоставляет функциональные возможности для установки, удаления и администрирования пакетов и наборов приложений на базовом устройстве.

![Страница диспетчера приложений на портале устройств](images/device-portal/WDP_AppsManager2.png)

* **Deploy apps** (Развертывание приложений): развертывание упакованных приложений из локальных, сетевых или веб-узлов и регистрация свободных файлов из общих сетевых ресурсов.
* **Installed apps** (Установленные приложения): раскрывающееся меню используется для удаления или запуска приложений, установленных на устройстве.
* **Running apps** (Запущенные приложения): получение сведений о выполняющихся в данный момент приложениях и их закрытие при необходимости.

#### <a name="install-sideload-an-app"></a>Установка (загрузка) неопубликованных приложений

Вы можете загружать неопубликованные приложения в процессе разработки с портала устройств Windows.

1. После создания пакета приложения вы можете удаленно установить его на устройстве. После его сборки в Visual Studio создается выходная папка.

    ![Установка приложения](images/device-portal/iot-installapp0.png)

2. На портале устройств Windows перейдите на страницу **Apps manager** (Диспетчер приложений).

3. В разделе **Deploy apps** (Развертывание приложений) выберите **Local Storage** (Локальное хранилище).

4. В разделе **Select the application package** (Выбор пакета приложения) щелкните **Choose File** (Выбрать файл) и найдите пакет неопубликованного приложения, который вы намерены загрузить.

5. В разделе **Select certificate file (.cer) used to sign app package** (Выбрать CER-файл сертификата, использовавшийся для подписывания пакета приложения) щелкните **Choose File** (Выбрать файл) и перейдите к сертификату, который связан с этим пакетом приложения.

6. Установите соответствующие флажки, если вы хотите установить необязательные пакеты или пакеты платформы вместе с приложением, и щелкните **Next** (Далее), чтобы выбрать их.

7. Нажмите **Install** (Установить), чтобы запустить установку.

8. Если устройство работает под управлением Windows 10 в режиме S и вы впервые установили сертификат на этом устройстве, перезапустите устройство.

#### <a name="install-a-certificate"></a>Установка сертификата

Вы также можете установить сертификат через портал устройств Windows, а приложение — с помощью других средств.

1. На портале устройств Windows перейдите на страницу **Apps manager** (Диспетчер приложений).

2. В разделе **Deploy apps** (Развертывание приложений) выберите **Install Certificate** (Установить сертификат).

3. В разделе **Select certificate file (.cer) used to sign app package** (Выбрать CER-файл сертификата, использовавшийся для подписывания пакета приложения) щелкните **Choose File** (Выбрать файл) и перейдите к сертификату, который связан с загружаемым пакетом приложения.

4. Нажмите **Install** (Установить), чтобы запустить установку.

5. Если устройство работает под управлением Windows 10 в режиме S и вы впервые установили сертификат на этом устройстве, перезапустите устройство.

#### <a name="uninstall-an-app"></a>Удаление приложения

1. Убедитесь, что приложение не работает.
2. В противном случае перейдите в раздел **Running apps** (Запущенные приложения) и закройте его. Если вы попытаетесь удалить работающее приложение, это приведет к возникновению проблем при попытке переустановить приложение.
3. Выберите приложение из раскрывающегося списка и щелкните **Remove** (Удалить).

### <a name="running-processes"></a>Выполняющиеся процессы

На этой странице отображаются сведения о выполняемых в настоящее время на хост-устройстве процессах. Сюда входят приложения и системные процессы. На некоторых платформах (настольные ПК, Интернет вещей и HoloLens) здесь можно прерывать процессы.

![Портал устройств, на котором открыта страница процессов](images/device-portal/mob-device-portal-processes.png)

### <a name="file-explorer"></a>Проводник

Эта страница позволяет просматривать файлы, сохраненные неопубликованными приложениями, и управлять ими. Дополнительные сведения о проводнике и способах его использования см. в [этой статье](https://blogs.windows.com/buildingapps/2016/06/08/using-the-app-file-explorer-to-see-your-app-data/).

![Портал устройств, страница проводника](images/device-portal/mob-device-portal-AppFileExplorer.png)

### <a name="performance"></a>Производительность

На странице Performance (Производительность) в реальном времени отображаются графики системной диагностической информации, например энергопотребления, частоты кадров и загрузки ЦП.

Ниже приведены доступные метрики:

- **CPU** (ЦП): использование ЦП в процентах от общей доступной производительности.
- **Memory** (Память): всего, используется, доступно, выделено, выгружаемая, невыгружаемая.
- **I/O** (Ввод-вывод): объемы чтения и записи данных.
- **Сеть**: получение и отправка данных.
- **GPU**: использование модуля GPU в процентах от общей доступной производительности.

![Портал устройств, страница сведений о производительности](images/device-portal/mob-device-portal-perf.png)

### <a name="event-tracing-for-windows-etw-logging"></a>Журналы трассировки событий Windows (ETW)

Страница журналов ETW позволяет управлять на устройстве трассировкой событий Windows (ETW) в режиме реального времени.

![Портал устройств, страница ведения журнала трассировки событий Windows](images/device-portal/mob-device-portal-etw.png)

Установите только флажок **Скрыть поставщиков** для отображения только списка «События».

- **Registered providers** (Зарегистрированные поставщики): выберите поставщик событий и уровень трассировки. Уровень трассировки принимает одно из следующих значений:
  1. ненормальный выход или прекращение;
  2. серьезные ошибки;
  3. Предупреждения
  4. предупреждения, не связанные с ошибками.
  5. Подробная трассировка

  Щелкните или нажмите **Включить** для запуска трассировки. Поставщик добавляется в раскрывающийся список **Включенные поставщики**.
- **Custom providers** (Настраиваемые поставщики): выберите пользовательский поставщик ETW и уровень трассировки. Определите поставщика по его GUID. Не включайте скобки в GUID.
- **Enabled providers** (Включенные поставщики): выводит список включенных поставщиков. Выберите поставщика в раскрывающемся списке и щелкните или нажмите **Отключить**, чтобы остановить трассировки. Щелкните или нажмите **Стоп**, чтобы приостановить всю трассировку.
- **Providers history** (Журнал поставщиков): отображение поставщиков ETW, которые были включены во время текущего сеанса. Щелкните или нажмите **Включить**, чтобы активировать поставщика, который ранее был отключен. Щелкните или нажмите **Очистить**, чтобы очистить журнал.
- **Filters / Events** (Фильтры и события): Раздел **Events** (События) содержит список событий трассировки событий Windows для выбранных поставщиков в формате таблицы. Эта таблица обновляется в режиме реального времени. Используйте меню **Filters** (Фильтры), чтобы настроить пользовательские фильтры для отображения событий. Нажмите кнопку **Clear** (Очистить), чтобы удалить из таблицы все события трассировки событий Windows. Это не приводит к отключению каких-либо поставщиков. Вы можете выбрать вариант **Save to file** (Сохранить в файл), чтобы экспортировать собранные события трассировки событий Windows в локальный CSV-файл.

Дополнительные сведения о ведении журналов трассировки событий Windows см. в [этой записи блога](https://blogs.windows.com/buildingapps/2016/06/10/using-device-portal-to-view-debug-logs-for-uwp/).

### <a name="performance-tracing"></a>Трассировка производительности

На странице Performance tracing (Трассировка производительности) можно просмотреть трассировки [Windows Performance Recorder (WPR)](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-8.1-and-8/hh448205(v=win.10)), полученные с хост-устройства.

![Портал устройств, страница трассировки производительности](images/device-portal/mob-device-portal-perf-tracing.png)

- **Available profiles** (Доступные профили): выберите профиль WPR в раскрывающемся списке, затем щелкните или нажмите **Start** (Запуск) для запуска трассировки.
- **Custom profiles** (Пользовательские профили): нажмите кнопку **Browse** (Обзор) для выбора профиля WPR на своем компьютере. Щелкните или нажмите **Передать и пуск** для запуска трассировки.

Чтобы остановите трассировку, нажмите **Остановить**. Оставайтесь на этой странице до тех пор, пока файл трассировки (ETL) не будет полностью загружен.

Захваченные ETL-файлы можно открыть для анализа в [Windows Performance Analyzer](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-8.1-and-8/hh448170(v=win.10)).

### <a name="device-manager"></a>Диспетчер устройств

На странице Device manager (Диспетчер устройств) показаны все периферийные устройства, подключенные к устройству. Вы можете щелкнуть значки параметров, чтобы просмотреть свойства каждого из них.

![Портал устройств, страница диспетчера устройств](images/device-portal/mob-device-portal-devices.png)

### <a name="networking"></a>сеть;

На странице Networking (Сеть) можно управлять сетевыми подключениями на устройстве. Если вы не подключены к порталу устройств через USB, изменение этих параметров, скорее всего, приведет к отключению от портала устройств.

- **Available networks** (Доступные сети): Здесь показаны сети Wi-Fi, доступные для устройства. Щелкните или нажмите сеть, чтобы подключиться к ней, при необходимости предоставьте ключ доступа. Портал устройств пока не поддерживает корпоративную проверку подлинности. Можно также использовать раскрывающийся список **Profiles** (Профили), чтобы попытаться подключиться к любому из известных устройству профилей Wi-Fi.
- **IP configuration** (Конфигурация IP): Отображает сведения об адресах для каждого из сетевых портов хост-устройства.

![Портал устройств, страница Networking (Сеть)](images/device-portal/mob-device-portal-network.png)

## <a name="service-features-and-notes"></a>Возможности служб и примечания

### <a name="dns-sd"></a>DNS-SD

Портал устройств сообщает о своем присутствии в локальной сети с помощью DNS-SD. Все экземпляры Портала устройств, независимо от типа устройства, объявляют себя с помощью "WDP._wdp._tcp.local". Записи TXT для экземпляра службы предоставляют следующие сведения:

Клавиши | Type | Описание
----|------|-------------
S | int | Защищенный порт Портала устройств. Если значение равно нулю (0), Портал устройств не выполняет прослушивание на предмет подключений HTTPS.
D | строка | Тип устройства. Значение имеет формат "Windows.*", например Windows.Xbox или Windows.Desktop
A | строка | Архитектура устройства. Архитектурой будет ARM, x86 или AMD64.  
T | разбитый список строк нуль-символа | Пользовательские теги для устройства. Инструкции по использованию см. в разделе "Теги, REST API". Список заканчивается двойным символом NULL.  

Так как не все устройства прослушивают порт HTTP, объявляемый записью DNS-SD, подключение рекомендуется устанавливать к порту HTTPS.

### <a name="csrf-protection-and-scripting"></a>Защита от атак CSRF и сценарии

Чтобы обеспечить защиту от [атак CSRF](https://en.wikipedia.org/wiki/Cross-site_request_forgery), все запросы, отличные от GET, должны иметь уникальный маркер. Этот маркер, заголовок запроса X-CSRF, извлекается из файла cookie сеанса — CSRF-Token. В веб-интерфейсе пользователя Портала устройств при каждом запросе файл cookie CSRF-Token копируется в заголовок X-CSRF-Token.

> [!IMPORTANT]
> Эта защита ограничивает возможность использования API-интерфейсов REST автономным клиентом (например, служебными программами командной строки). Эту проблему можно решить тремя способами:
> - Используйте префикс "auto-" в имени пользователя. Клиенты, которые буду добавлять "auto-" в начало своего имени пользователя смогут обходить защиту от атак CSRF. Важно не использовать это имя пользователя для входа на Портал устройств с помощью браузера, так как при этом служба будет становиться открытой для атак CSRF. Пример: Если входа на портал устройств выполняется с именем пользователя "admin", для обхода защиты от атак CSRF необходимо использовать ```curl -u auto-admin:password <args>```.
> - Реализуйте в клиенте схему передачи значений параметров файла cookie серверу с каждым запросом в качестве части заголовка HTTP. Для этого требуется, чтобы запрос GET определял файл cookie сеанса, а также выполнение дальнейшего добавления заголовка и файла cookie во все последующие запросы.
> - Отключите проверку подлинности и используйте HTTP. Защита от атак CSRF применяется только к конечным точкам HTTPS, поэтому подключениям к конечным точкам HTTP не придется выполнять никакие из описанных выше действий.

#### <a name="cross-site-websocket-hijacking-cswsh-protection"></a>Защита от межсайтового перехвата с использованием WebSocket (CSWSH)

Для защиты против [CSWSH-атак](https://www.christian-schneider.net/CrossSiteWebSocketHijacking.html) все клиенты, открывающие WebSocket-соединение с порталом устройств должны также предоставлять заголовок источника, совпадающий с заголовком узла. Это демонстрирует порталу устройств, что запрос отправляется либо пользовательским интерфейсом портала устройств, либо действительным клиентским приложением. Без заголовка источника запрос будет отклонен.
