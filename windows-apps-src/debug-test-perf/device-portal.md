---
ms.assetid: 60fc48dd-91a9-4dd6-a116-9292a7c1f3be
title: Обзор портала устройств Windows
description: Узнайте, как портал устройств Windows позволяет настраивать устройство и управлять им удаленно через сеть или USB-подключение.
ms.date: 04/09/2019
ms.topic: article
keywords: Windows 10, UWP, портал устройств
ms.localizationpriority: medium
ms.openlocfilehash: 2292d97166d34905bb895aa3f53f864510a21f46
ms.sourcegitcommit: b52ddecccb9e68dbb71695af3078005a2eb78af1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74254764"
---
# <a name="windows-device-portal-overview"></a>Обзор портала устройств Windows

Портал Windows Device Portal позволяет настроить устройство и управлять им удаленно по сети или подключению USB. Он также предоставляет дополнительные средства диагностики, помогающие в диагностике и просмотре производительности устройства Windows в режиме реального времени.

Портал устройств Windows — это веб-сервер на устройстве, к которому можно подключиться из веб-браузера на компьютере. Если на устройстве есть веб-браузер, вы также можете подключиться к нему локально с помощью браузера на этом устройстве.

Портал устройств Windows доступен в каждом семействе устройств, но функции и настройка зависят от требований каждого устройства. В этой статье дается общее описание портала устройства, а также приведены ссылки на статьи, содержащие более подробные сведения по каждому семейству устройств.

Функциональные возможности портала устройств Windows реализованы с помощью [интерфейсов API](device-portal-api-core.md) , которые можно использовать непосредственно для доступа к данным и управления устройством программным способом.

## <a name="setup"></a>Установка

Каждое устройство имеет свои инструкции для подключения к порталу устройства, однако к каждому из них применимы следующие общие действия:

1. Включите режим разработчика и портал устройств на устройстве (настроенном в приложении "Параметры").

2. Подключите устройство и компьютер через локальную сеть или USB.

3. Перейдите на страницу портала устройства в своем браузере. В этой таблице показаны порты и протоколы, используемые каждым семейством устройств.

Семейство устройств | Включено по умолчанию? | HTTP | HTTPS | USB
--------------|----------------|------|-------|----
HoloLens | Да, в режиме разработки | 80 (по умолчанию) | 443 (по умолчанию) | http://127.0.0.1:10080
Интернет вещей | Да, в режиме разработки | 8080 | Включается через раздел реестра | Нет данных
Xbox | Включается в режиме разработки | Отключено | 11443 | Нет данных
Настольный компьютер| Включается в режиме разработки | 50080\* | 50043\* | Нет данных
Phone | Включается в режиме разработки | 80| 443 | http://127.0.0.1:10080

\* это не всегда так, как на портале устройств на настольных компьютерах порты в эфемерном диапазоне (> 50000), чтобы предотвратить конфликты с существующими утверждениями портов на устройстве. Подробнее см. в разделе [Параметры портов](device-portal-desktop.md#registry-based-configuration-for-device-portal) для настольных компьютеров.  

Конкретные инструкции по настройке устройства см. в разделах:

- [Портал устройств для HoloLens](https://docs.microsoft.com/windows/uwp/debug-test-perf/device-portal-hololens)
- [Портал устройств для Интернета вещей](https://docs.microsoft.com/windows/iot-core/manage-your-device/DevicePortal)
- [Портал устройств для мобильных устройств](device-portal-mobile.md)
- [Портал устройств для Xbox](../xbox-apps/device-portal-xbox.md)
- [Портал устройств для компьютера](device-portal-desktop.md#set-up-device-portal-on-windows-desktop)

## <a name="features"></a>Возможности

### <a name="toolbar-and-navigation"></a>Панель инструментов и навигация

Панель инструментов в верхней части страницы предоставляет доступ к часто используемым функциям.

- **Power**: доступ к параметрам электропитания.
  - **Завершение работы**: отключает устройство.
  - **Перезапуск**: выключает и включает питание на устройстве.
- **Справка**: открывает страницу справки.

Используйте ссылки на панели навигации вдоль левой стороны страницы для перехода к доступным для вашего устройства средствам управления и мониторинга.

Здесь описаны средства, общие для разных семейств устройств. В зависимости от устройства могут быть доступны другие параметры. Дополнительные сведения см. на конкретной странице типа устройства.

### <a name="apps-manager"></a>Диспетчер приложений

Диспетчер приложений предоставляет функции установки, удаления и управления для пакетов приложений и наборов на устройстве узла.

![Страница диспетчера приложений портала устройств](images/device-portal/WDP_AppsManager2.png)

* **Развертывание приложений**: развертывание упакованных приложений из локальных, сетевых и веб-узлов, а также регистрация свободных файлов в общих сетевых ресурсах.
* **Установленные приложения**: используйте раскрывающееся меню для удаления или запуска приложений, установленных на устройстве.
* **Работающие приложения**: получение сведений о выполняющихся в данный момент приложениях и их закрытие при необходимости.

#### <a name="install-sideload-an-app"></a>Установка (загружать неопубликованные) приложения

Вы можете загружать неопубликованные приложения во время разработки с помощью портала устройств Windows:

1. После создания пакета приложения его можно удаленно установить на устройстве. После его сборки в Visual Studio создается выходная папка.

    ![Установка приложения](images/device-portal/iot-installapp0.png)

2. На портале устройств Windows перейдите на страницу **Диспетчер приложений** .

3. В разделе **развертывание приложений** выберите **Локальное хранилище**.

4. В разделе **выберите пакет приложения**выберите **выбрать файл** и перейдите к пакету приложения, который требуется загружать неопубликованные.

5. В разделе **Выбор файла сертификата (CER), используемого для подписывания пакета приложения**, выберите **выбрать файл** и перейдите к сертификату, связанному с этим пакетом приложения.

6. Проверьте соответствующие поля, если вы хотите установить необязательные или пакеты платформы вместе с установкой приложения, и нажмите кнопку **Далее** , чтобы выбрать их.

7. Нажмите кнопку **установить** , чтобы начать установку.

8. Если устройство работает под Windows 10 в режиме S и в первый раз данный сертификат установлен на устройстве, перезапустите устройство.

#### <a name="install-a-certificate"></a>Установка сертификата

Можно также установить сертификат с помощью портала устройств Windows и установить приложение с помощью других средств.

1. На портале устройств Windows перейдите на страницу **Диспетчер приложений** .

2. В разделе **развертывание приложений** выберите **установить сертификат**.

3. В разделе **Выбор файла сертификата (CER), используемого для подписи пакета приложения**, выберите **выбрать файл** и перейдите к сертификату, связанному с пакетом приложения, который вы хотите загружать неопубликованные.

4. Нажмите кнопку **установить** , чтобы начать установку.

5. Если устройство работает под Windows 10 в режиме S и в первый раз данный сертификат установлен на устройстве, перезапустите устройство.

#### <a name="uninstall-an-app"></a>Удаление приложения

1. Убедитесь, что приложение не работает.
2. Если это так, перейдите в раздел " **работающие приложения** " и закройте его. Если вы попытаетесь удалить приложение во время работы приложения, это вызовет проблемы при попытке переустановить приложение.
3. Выберите приложение в раскрывающемся списке и нажмите кнопку **Удалить**.

### <a name="running-processes"></a>Выполняющиеся процессы

На этой странице отображаются сведения о процессах, выполняющихся на основном устройстве. Сюда входят приложения и системные процессы. На некоторых платформах (настольных, IoT и HoloLens) можно прерывать процессы.

![Страница "запущенные процессы" портала устройств](images/device-portal/mob-device-portal-processes.png)

### <a name="file-explorer"></a>Проводник

Эта страница позволяет просматривать файлы, хранящиеся в любых загруженные неопубликованные приложениях, и управлять ими. Дополнительные сведения об обозревателе файлов и способах его использования см. в записи блога [проводника по файлам приложений](https://blogs.windows.com/buildingapps/2016/06/08/using-the-app-file-explorer-to-see-your-app-data/) .

![Страница обозревателя файлов на портале устройств](images/device-portal/mob-device-portal-AppFileExplorer.png)

### <a name="performance"></a>Производительность

На странице "производительность" отображаются графики диагностической информации о системе в реальном времени, такие как энергопотребление, частота кадров и загрузка ЦП.

Ниже приведены доступные метрики:

- **ЦП**: процент общей доступной загрузки ЦП
- **Память**: общее, используемое, доступное, зафиксированное, страничное и нестраничное.
- **Ввод-вывод**: чтение и запись количества данных
- **Сеть**: полученные и отправленные данные
- **GPU**: процент общего доступного использования ПОДсистемы GPU

![Страница "производительность" портала устройств](images/device-portal/mob-device-portal-perf.png)

### <a name="event-tracing-for-windows-etw-logging"></a>Ведение журнала трассировки событий Windows (ETW)

Страница Ведение журнала ETW управляет трассировкой событий в реальном времени для Windows (ETW) на устройстве.

![Страница ведения журнала трассировки событий Windows на портале устройств](images/device-portal/mob-device-portal-etw.png)

Установите только флажок **Скрыть поставщиков** для отображения только списка «События».

- **Зарегистрированные поставщики**: выберите поставщика событий и уровень трассировки. Уровень трассировки — одно из следующих значений:
  1. ненормальный выход или прекращение;
  2. серьезные ошибки;
  3. Предупреждения
  4. предупреждения, не связанные с ошибками.
  5. Подробная трассировка

  Щелкните или нажмите **Включить** для запуска трассировки. Поставщик добавляется в раскрывающийся список **Включенные поставщики**.
- **Пользовательские поставщики**: выбор пользовательского поставщика трассировки событий Windows и уровень трассировки. Определите поставщика по его GUID. Не включайте в GUID скобки.
- **Включенные поставщики**: выводит список включенных поставщиков. Выберите поставщика в раскрывающемся списке и щелкните или нажмите **Отключить**, чтобы остановить трассировки. Щелкните или нажмите **Стоп**, чтобы приостановить всю трассировку.
- **Журнал поставщиков**: показывает поставщики ETW, которые были включены во время текущего сеанса. Щелкните или нажмите **Включить**, чтобы активировать поставщика, который ранее был отключен. Щелкните или нажмите **Очистить**, чтобы очистить журнал.
- **Фильтры и события**. в разделе **событий** перечисляются события ETW от выбранных поставщиков в табличном формате. Таблица обновляется в режиме реального времени. Используйте меню **фильтры** для настройки настраиваемых фильтров, для которых будут отображаться события. Нажмите кнопку **clear (очистить** ), чтобы удалить все события ETW из таблицы. Это не приводит к отключению каких-либо поставщиков. Вы можете нажать кнопку **сохранить в файл** , чтобы экспортировать собранные события ETW в локальный CSV-файл.

Дополнительные сведения об использовании ведения журнала ETW см. в записи блога [Использование портала устройств для просмотра журналов отладки](https://blogs.windows.com/buildingapps/2016/06/10/using-device-portal-to-view-debug-logs-for-uwp/) .

### <a name="performance-tracing"></a>Трассировка производительности

На странице Трассировка производительности можно просмотреть трассировки [средства записи производительности Windows (ЗВЧ)](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-8.1-and-8/hh448205(v=win.10)) с устройства узла.

![Страница трассировки производительности портала устройств](images/device-portal/mob-device-portal-perf-tracing.png)

- **Доступные профили**: выберите профиль WPR в раскрывающемся списке, затем щелкните или нажмите **Пуск** для запуска трассировки.
- **Пользовательские профили**: щелкните или нажмите **Обзор** для выбора профиля WPR на своем компьютере. Щелкните или нажмите **Передать и пуск** для запуска трассировки.

Чтобы остановите трассировку, нажмите **Остановить**. Оставайтесь на этой странице, пока файл трассировки (. Загрузка ETL) завершена.

Записываются. ETL-файлы можно открыть для анализа в [анализаторе производительности Windows](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-8.1-and-8/hh448170(v=win.10)).

### <a name="device-manager"></a>Диспетчер устройств

На странице Диспетчер устройств перечисляются все периферийные устройства, подключенные к устройству. Можно щелкнуть значки параметров, чтобы просмотреть свойства каждого из них.

![Страница "Диспетчер устройств" портала устройств](images/device-portal/mob-device-portal-devices.png)

### <a name="networking"></a>Сеть

Страница «сеть» управляет сетевыми подключениями на устройстве. Если вы не подключены к порталу устройств через USB, изменение этих параметров, скорее всего, приведет к отключению от портала устройств.

- **Доступные сети**: показывает сети Wi-Fi, доступные для устройства. Щелкните или нажмите сеть, чтобы подключиться к ней, при необходимости предоставьте ключ доступа. Портал устройств пока не поддерживает проверку подлинности предприятия. Можно также использовать раскрывающийся список **Профили** , чтобы попытаться подключиться к любому из профилей Wi-Fi, известных устройству.
- **IP-конфигурация**: отображает сведения об адресах каждого из сетевых портов устройства узла.

![Страница "Сетевые подключения" портала устройств](images/device-portal/mob-device-portal-network.png)

## <a name="service-features-and-notes"></a>Функции и примечания службы

### <a name="dns-sd"></a>DNS-SD

Портал устройств сообщает о своем присутствии в локальной сети с помощью DNS-SD. Все экземпляры Портала устройств, независимо от типа устройства, объявляют себя с помощью "WDP._wdp._tcp.local". Записи TXT для экземпляра службы предоставляют следующие сведения:

Раздел | Тип | Описание
----|------|-------------
S | int | Защищенный порт Портала устройств. Если значение равно нулю (0), Портал устройств не выполняет прослушивание на предмет подключений HTTPS.
D | Строка | Тип устройства. Это будет иметь формат "Windows. *", например Windows. Xbox или Windows. Desktop
A | Строка | Архитектура устройства. Архитектурой будет ARM, x86 или AMD64.  
T | разбитый список строк нуль-символа | Пользовательские теги для устройства. Инструкции по использованию см. в разделе "Теги, REST API". Список заканчивается двойным символом NULL.  

Так как не все устройства прослушивают порт HTTP, объявляемый записью DNS-SD, подключение рекомендуется устанавливать к порту HTTPS.

### <a name="csrf-protection-and-scripting"></a>Защита от атак CSRF и сценарии

Чтобы обеспечить защиту от [атак CSRF](https://en.wikipedia.org/wiki/Cross-site_request_forgery), все запросы, отличные от GET, должны иметь уникальный маркер. Этот маркер, заголовок запроса X-CSRF, извлекается из файла cookie сеанса — CSRF-Token. В веб-интерфейсе пользователя Портала устройств при каждом запросе файл cookie CSRF-Token копируется в заголовок X-CSRF-Token.

> [!IMPORTANT]
> Эта защита предотвращает использование интерфейсов API-интерфейса RESTFUL от автономного клиента (например, служебных программ командной строки). Эту проблему можно решить тремя способами:
> - Используйте "Автоматическое имя пользователя". Клиенты, которые буду добавлять "auto-" в начало своего имени пользователя смогут обходить защиту от атак CSRF. Важно не использовать это имя пользователя для входа на Портал устройств с помощью браузера, так как при этом служба будет становиться открытой для атак CSRF. Пример. Если именем пользователя для входа на Портал устройств является "admin", для обхода защиты от атак CSRF необходимо использовать имя ```curl -u auto-admin:password <args>```.
> - Реализуйте в клиенте схему передачи значений параметров файла cookie серверу с каждым запросом в качестве части заголовка HTTP. Для этого требуется, чтобы запрос GET определял файл cookie сеанса, а также выполнение дальнейшего добавления заголовка и файла cookie во все последующие запросы.
> - Отключите проверку подлинности и используйте HTTP. Защита от атак CSRF применяется только к конечным точкам HTTPS, поэтому подключениям к конечным точкам HTTP не придется выполнять никакие из описанных выше действий.

#### <a name="cross-site-websocket-hijacking-cswsh-protection"></a>Защита от межсайтового перехвата с использованием WebSocket (CSWSH)

Для защиты против [CSWSH-атак](https://www.christian-schneider.net/CrossSiteWebSocketHijacking.html) все клиенты, открывающие WebSocket-соединение с порталом устройств должны также предоставлять заголовок источника, совпадающий с заголовком узла. Это демонстрирует порталу устройств, что запрос отправляется либо пользовательским интерфейсом портала устройств, либо действительным клиентским приложением. Без заголовка источника запрос будет отклонен.
