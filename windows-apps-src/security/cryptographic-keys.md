---
title: Криптографические ключи
description: В этой статье описано, как использовать стандартные функции формирования производных ключей и шифровать содержимое с помощью симметричных и асимметричных ключей.
ms.assetid: F35BEBDF-28C5-4F91-A94E-F7D862B6ED59
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, uwp, безопасность
ms.localizationpriority: medium
ms.openlocfilehash: 2b74eccd5f6138e5a9d670aa3a0a93239813cf4d
ms.sourcegitcommit: d7613c791107f74b6a3dc12a372d9de916c0454b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2018
ms.locfileid: "8756883"
---
# <a name="cryptographic-keys"></a>Криптографические ключи




В этой статье описано, как использовать стандартные функции формирования производных ключей и шифровать содержимое с помощью симметричных и асимметричных ключей. 

## <a name="symmetric-keys"></a>Симметричные ключи


При шифровании с симметричным ключом (известном также как симметричное шифрование) ключ, используемый для шифрования, должен также применяться для расшифровки. Вы можете использовать класс [**SymmetricKeyAlgorithmProvider**](https://msdn.microsoft.com/library/windows/apps/br241537) для указания алгоритма симметричного шифрования и для создания или импорта ключа. Для шифрования и расшифровки данных с помощью алгоритма и ключа можно использовать статические методы класса [**CryptographicEngine**](https://msdn.microsoft.com/library/windows/apps/br241490).

При шифровании с симметричным ключом обычно используются блочные шифры и режимы блочного шифра. Блочный шифр — это функция симметричного шифрования, работающая с блоками фиксированного размера. Если длина сообщения, которое вы хотите зашифровать, превышает длину блока, следует использовать режим блочного шифра. Режим блочного шифра — это функция симметричного шифрования, основанная на использовании блочного шифра. Она шифрует открытый текст в виде последовательности блоков фиксированного размера. Приложения поддерживают следующие режимы:

-   Режим ECB (электронного кодового словаря) шифрует каждый блок сообщения по отдельности. В нем не предусмотрен режим надежного шифрования.
-   Режим CBC (сцепление блоков шифра) использует предыдущий блок зашифрованных данных для кодирования текущего блока. Вам нужно указать, какое значение использовать для первого блока. Это значение называется вектором инициализации (IV).
-   Режим CCM (счетчика с CBC-MAC) объединяет режим блочных шифров CBC с кодом проверки подлинности сообщения (MAC).
-   Режим	GCM (счетчика Галуа) объединяет режим шифрования счетчика с режимом проверки подлинности Галуа.

Для некоторых режимов, например CBC, вам нужно использовать вектор инициализации (IV) для первого блока зашифрованных данных. Далее приведены распространенные векторы инициализации. Вектор инициализации задается при вызове метода [**CryptographicEngine.Encrypt**](https://msdn.microsoft.com/library/windows/apps/br241494). В большинстве случаев важно, чтобы вектор инициализации никогда не использовался повторно с одним ключом.

-   Фиксированный — предполагает использование одного вектора инициализации для всех шифруемых сообщений. Этот метод не рекомендуется использовать, так как он может привести к утечке информации.
-   Счетчик — увеличивает вектор инициализации для каждого блока.
-   Случайный — создает псевдослучайный вектор инициализации. Для создания вектора инициализации можно использовать метод [**CryptographicBuffer.GenerateRandom**](https://msdn.microsoft.com/library/windows/apps/br241392).
-   Специально создаваемый — использует уникальное число для каждого шифруемого сообщения. Как правило, специальное значение — это измененный идентификатор сообщения или транзакции. Оно не предназначено для хранения шифра, но не должно повторно использоваться с одним ключом.

Для большинства режимов необходимо, чтобы длина открытого текста была кратной размеру блока. Для этого обычно требуется подгонять открытый текст до требуемой длины.

Если блочные шифры предназначены для шифрования блоков данных фиксированного размера, то потоковые шифры — это функция симметричного шифрования, группирующая биты открытого текста с псевдослучайным потоком битов (потоком ключей) для создания зашифрованных данных. Некоторые режимы блочных шифров, такие как режим вывода обратной связи (OTF) и режим счетчика (CTR), эффективно преобразуют блочные шифры в потоковые. Но обычно реальные потоковые шифры, например RC4, работают на более высоких скоростях по сравнению с режимами блочных шифров.

В следующем примере показано, как использовать класс [**SymmetricKeyAlgorithmProvider**](https://msdn.microsoft.com/library/windows/apps/br241537), чтобы создать симметричный ключ и применить его для шифрования и расшифровки данных.

## <a name="asymmetric-keys"></a>Асимметричные ключи


При асимметричном шифровании, известном также как шифрование с открытым ключом, для шифрования и расшифровки используются открытый и закрытый ключи. Эти ключи различны, но связаны математически. Как правило, закрытый ключ хранится в тайне и используется для расшифровки данных, в то время как открытый ключ распространяется заинтересованным сторонам и применяется для шифрования. Асимметричное шифрование также используется для подписывания данных.

Асимметричные алгоритмы шифрования гораздо медленнее симметричных алгоритмов, поэтому они редко используются непосредственно для шифрования больших объемов данных. Вместо этого они используются для шифрования ключей следующим образом.

-   Алисе нужно, чтобы Боб отправлял ей только зашифрованные сообщения.
-   Алиса создает пару "открытый/закрытый ключ", сохраняет секрет своего закрытого ключа и публикует открытый ключ.
-   У Боба есть сообщение, которое он хочет отправить Алисе.
-   Боб создает симметричный ключ.
-   Боб использует свой новый симметричный ключ для того, чтобы зашифровать сообщение для Алисы.
-   Боб использует открытый ключ Алисы для того, чтобы зашифровать свой симметричный ключ.
-   Боб отправляет зашифрованное сообщение и симметричный ключ шифрования Алисе (в конверте передачи сообщения).
-   Алиса использует свой закрытый ключ (из пары закрытый-открытый ключ) для того, чтобы расшифровать симметричный ключ Боба.
-   Алиса использует симметричный ключ Боба для расшифровки сообщения.

С помощью объекта [**AsymmetricKeyAlgorithmProvider**](https://msdn.microsoft.com/library/windows/apps/br241478) можно указать асимметричный алгоритм или алгоритм подписи, создать или импортировать временную пару ключей или импортировать открытый ключ пары.

## <a name="deriving-keys"></a>Формирование производных ключей


Часто возникает потребность в формировании дополнительных производных ключей из общего секрета. Для формирования производных ключей можно использовать класс [**KeyDerivationAlgorithmProvider**](https://msdn.microsoft.com/library/windows/apps/br241518) и один из следующих специализированных методов класса [**KeyDerivationParameters**](https://msdn.microsoft.com/library/windows/apps/br241524).

| Объект                                                                            | Описание                                                                                                                                |
|-----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| [**BuildForPbkdf2**](https://msdn.microsoft.com/library/windows/apps/br241525)    | Создает объект KeyDerivationParameters, который используется функцией формирования ключа при помощи пароля2 (PBKDF2).                                 |
| [**BuildForSP800108**](https://msdn.microsoft.com/library/windows/apps/br241526)  | Создает объект KeyDerivationParameters для использования в режиме счетчика функцией формирования ключа при помощи хэш-кода проверки подлинности сообщения (HMAC). |
| [**BuildForSP80056a**](https://msdn.microsoft.com/library/windows/apps/br241527)  | Создает объект KeyDerivationParameters, который используется функцией формирования ключа при помощи SP800-56A.                                                 |

 
