---
title: Доступ к данным трассировки — .NET Трацепроцессинг
description: В этом руководстве описано, как получить доступ к данным трассировки с помощью Трацепроцессор.
author: maiak
ms.author: maiak
ms.date: 02/23/2020
ms.topic: tutorial
ms.openlocfilehash: 170a8c3084e180714a319d67dca2b6a5756ea474
ms.sourcegitcommit: 4fdab7be28aca18cb3879fc205eb49edc4f9a96b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/26/2020
ms.locfileid: "77629115"
---
# <a name="access-trace-data"></a>Доступ к данным трассировки

.NET Трацепроцессинг доступен в [NuGet](https://www.nuget.org/packages/Microsoft.Windows.EventTracing.Processing.All) с помощью следующего идентификатора пакета:

Microsoft. Windows. ЕвенттраЦинг. обработка. ALL

Этот пакет позволяет получить доступ к данным в файле трассировки. Если у вас еще нет файла трассировки, его можно создать с помощью [средства записи производительности Windows](https://docs.microsoft.com/windows-hardware/test/wpt/start-a-recording) .

В следующем примере консольного приложения показано, как получить доступ к командным строкам всех процессов, содержащихся в трассировке:

```csharp
using Microsoft.Windows.EventTracing;
using Microsoft.Windows.EventTracing.Processes;
using System;

class Program
{
    static void Main(string[] args)
    {
        if (args.Length != 1)
        {
            Console.Error.WriteLine("Usage: <trace.etl>");
            return;
        }

        using (ITraceProcessor trace = TraceProcessor.Create(args[0]))
        {
            IPendingResult<IProcessDataSource> pendingProcessData = trace.UseProcesses();

            trace.Process();

            IProcessDataSource processData = pendingProcessData.Result;

            foreach (IProcess process in processData.Processes)
            {
                Console.WriteLine(process.CommandLine);
            }
        }
    }
}
```

## <a name="using-traceprocessor"></a>Использование Трацепроцессор

Чтобы обработать трассировку, вызовите метод [трацепроцессор. Create](https://docs.microsoft.com/dotnet/api/microsoft.windows.eventtracing.traceprocessor.create). Основным интерфейсом является [итрацепроцессор](https://docs.microsoft.com/dotnet/api/microsoft.windows.eventtracing.itraceprocessor), а использование этого интерфейса включает следующий шаблон:

1. Во-первых, сообщите процессору, какие данные вы хотите использовать из трассировки.
2. Во вторых, обработайте трассировку. перетаскивани
3. Наконец, получите доступ к результатам.

Сообщить процессору, какие типы данных должны быть в начале работы, — не нужно тратить время на обработку больших объемов данных трассировки. Вместо этого [трацепроцессор](https://docs.microsoft.com/dotnet/api/microsoft.windows.eventtracing.traceprocessor) просто выполняет работу, необходимую для предоставления конкретных типов данных, которые вы запрашиваете.

## <a name="recommended-project-settings"></a>Рекомендуемые параметры проекта

Существует несколько параметров проекта, которые мы рекомендуем использовать с Трацепроцессор:

1. Рекомендуется запускать файлы exe как 64-bit.

    Visual Studio по умолчанию для нового C# консольного приложения .NET Framework — это любой ЦП с установленным флажком 32-bit. Возможно, параметр по умолчанию для .NET Core уже имеет рекомендуемое значение.

    Обработка трассировки может занимать много памяти, особенно с большими трассировками, и мы рекомендуем изменить целевую платформу на x64 (или снять флажок "предпочитать 32-разр.)" в исполняемых папках, использующих Трацепроцессор. Чтобы изменить эти параметры, см. вкладку сборка в разделе Свойства проекта. Чтобы изменить эти параметры для всех конфигураций, убедитесь, что в раскрывающемся списке Конфигурация задано значение все конфигурации, а не значение по умолчанию для текущей конфигурации.

2. Мы рекомендуем использовать NuGet с новым PackageReference режимом, а не старым режимом Packages. config.

    Чтобы изменить значение по умолчанию для новых проектов, см. раздел средства, диспетчер пакетов NuGet, параметры диспетчера пакетов, Управление пакетами, формат управления пакетами по умолчанию.

## <a name="built-in-data-sources"></a>Встроенные источники данных

ETL-файл может записывать в трассировку много типов данных. Обратите внимание, что данные в ETL-файле зависят от того, какие поставщики были включены при записи трассировки. В следующем списке показаны типы данных трассировки, доступные в Трацепроцессор.

| Код                                      | Описание                                                                                                                | Связанные элементы WPA                                                    |
|-------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
| трассировки. Усеклассицевентс ()                  | Предоставляет классические события ETW из трассировки, которые не включают сведения о схеме.                                         | Таблица универсальных событий (если тип события — классический или WPP)             |
| трассировки. Усеконнектедстандбидата ()           | Предоставляет данные из трассировки системы, которая вводит и завершает подключение в режиме ожидания.                                        | Сводная таблица CS                                                     |
| трассировки. Усекпуидлестатес ()                  | Предоставляет данные из трассировки по времени ЦП C-состояниями.                                                                             | Таблица состояний простоя ЦП (если тип является фактическим)                          |
| трассировки. Усекпусамплингдата ()                | Предоставляет данные из трассировки по использованию ЦП на основе периодической выборки указателя инструкций.                          | Таблица загрузки ЦП (выборка)                                            |
| трассировки. Усекпусчедулингдата ()              | Предоставляет данные из трассировки по планированию потоков ЦП, включая переключение контекста и готовые события потока.                | Таблица "использование ЦП (Точная)"                                            |
| трассировки. Уседевицеповердата ()                | Предоставляет данные из трассировки устройства D-состояния.                                                                          | Таблица DStateов устройств                                                  |
| трассировки. Уседиректксдата ()                    | Предоставляет данные из трассировки действия DirectX.                                                                         | Таблица использования GPU                                                |
| Трацеуседискиодата ()                      | Предоставляет данные из трассировки активности дискового ввода-вывода.                                                                        | Таблица использования диска                                                     |
| трассировки. Усинергестиматиондата ()           | Предоставляет данные из трассировки для оценки потребления энергии каждым процессом от подсистемы оценки энергии.                         | Таблица сводки по модулю оценки энергии (по процессам)                  |
| трассировки. Усинергиметердата ()                | Предоставляет данные из трассировки измеряемого потребления энергии по интерфейсу измерения энергии.                                  | Таблица с подсистемой оценки энергии (по электромагнитной излучению)                              |
| трассировки. Усефилеиодата ()                     | Предоставляет данные из трассировки на активность файлового ввода-вывода.                                                                        | Таблица файлового ввода-вывода                                                       |
| трассировки. Усеженерицевентс ()                  | Предоставляет события с манифестами и Трацелоггинг из трассировки.                                                                  | Таблица универсальных событий (если тип события — manifest или Трацелоггинг) |
| трассировки. Усехандлес ()                        | Предоставляет частичные данные из трассировки активных дескрипторов ядра.                                                            | Обрабатывает таблицу                                                        |
| трассировки. Усехардфаултс ()                     | Предоставляет данные из трассировки ошибок страниц на жестком диске.                                                                         | Таблица с жесткими сбоями                                                    |
| трассировки. Усехеапснапшотс ()                  | Предоставляет данные из трассировки об использовании кучи процесса.                                                                       | Таблица моментальных снимков кучи                                                  |
| трассировки. Усехиперкаллс ()                     | Предоставляет данные о вызовах Hyper-V, которые произошли во время трассировки.                                                        |                                                                      |
| трассировки. Усеимажесектионс ()                  | Предоставляет данные из трассировки разделов изображения.                                                                 | Столбец "имя раздела" в таблице "использование ЦП (выборка)"                 |
| трассировки. Усеинтеррупсандлингдата ()          | Предоставляет данные из трассировки для действия процедуры обработки прерываний (ISR) и отложенного вызова процедур (DPC).               | Таблица DPC/ISR                                                        |
| трассировки. Усемаркс ()                          | Предоставляет метки (метки времени) из трассировки.                                                                      | Таблица пометок                                                          |
| трассировки. Усемеморютилизатиондата ()          | Предоставляет данные из трассировки общего использования системной памяти.                                                          | Таблица использования памяти                                             |
| трассировки. Усеметадата ()                       | Предоставляет доступ к метаданным трассировки без дальнейшей обработки.                                                              | Конфигурация системы, трассировки и общие сведения                             |
| трассировки. Усеплатформидлестатес ()             | Предоставляет данные из трассировки целевого и фактического состояний простоя платформы системы.                                   | Таблица состояний простоя платформы                                            |
| трассировки. Усепулаллокатионс ()                | Предоставляет данные из трассировки использования памяти пулом ядра.                                                                 | Сводная таблица пула                                                   |
| трассировки. Усеповерконфигуратиондата ()         | Предоставляет данные из трассировки о конфигурации питания системы.                                                               | Конфигурация системы, параметры электропитания                                 |
| трассировки. Усеповердепенденцикурдинатордата () | Предоставляет данные из трассировки на этапах активного координатора зависимостей электропитания.                                               | Сводная таблица этапа уведомления                                     |
| трассировки. Усепроцессес ()                      | Предоставляет данные о процессах, активных в ходе трассировки, а также их изображениях и PDB.                                      | Обрабатывает таблицу; Таблица Images; Центр символов                           |
| трассировки. Усепроцессоркаунтерс ()              | Предоставляет данные из трассировки по значениям счетчика производительности процессора из монитора счетчиков процессора (PCM).                |                                                                      |
| трассировки. Усепроцессорфрекуенцидата ()         | Предоставляет данные из трассировки по частоте запуска процессоров.                                                    | Таблица частоты процессора (если тип является фактическим)                      |
| трассировки. Усепроцессорпрофиледата ()           | Предоставляет данные из трассировки активного профиля питания процессора.                                                       | Таблица профилей процессоров                                             |
| трассировки. Усепроцессорпаркингдата ()           | Предоставляет данные из трассировки, сведения о том, какие процессоры были приостановлены или не были приостановлены.                                                 | Таблица состояния приостановки процессора                                        |
| трассировки. Усепроцессорпаркинглимитс ()         | Предоставляет данные из трассировки по максимальному допустимому количеству неприпаркованных процессоров.                                        | Таблица состояний стоянки ядер                                         |
| трассировки. Усепроцессоркуалитйофсервицедата ()  | Предоставляет данные из трассировки по уровню качества обслуживания для каждого процессора.                                          | Таблица классов качества обслуживания процессора                                            |
| трассировки. Усепроцессорсроттлингдата ()        | Предоставляет данные из трассировки по регулированию максимальной частоты процессора.                                                   | Таблица "ограничения процессора"                                          |
| трассировки. Усереадибутдата ()                  | Предоставляет данные из трассировки о действиях по начальной загрузке с готовой загрузки.                                                | Таблица событий готовой загрузки                                              |
| трассировки. Усереференцесетдата ()               | Предоставляет данные из трассировки по страницам виртуальной памяти, используемой каждым процессом.                                             | Таблица набора ссылок                                                  |
| трассировки. Усерегионсофинтерест ()              | Предоставляет именованные области, представляющие собой процентные интервалы, из трассировки, как указано в XML-файле конфигурации.                       | Регионы таблицы интересов                                            |
| трассировки. Усерегистридата ()                   | Предоставляет данные о действиях в реестре во время трассировки.                                                                      | Таблица реестра                                                       |
| трассировки. Усересидентсетдата ()                | Предоставляет данные из трассировки по страницам виртуальной памяти для каждого процесса, находящихся в физической памяти.       | Таблица резидентных наборов                                                   |
| трассировки. Усерундовндата ()                    | Предоставляет данные из трассировки по интервалам, в течение которых произошел сбор данных очистки трассировки.                            | Затененные области на временной шкале графа                                 |
| трассировки. Усесчедуледтаскс ()                 | Предоставляет данные о запланированных задачах, которые выполнялись во время трассировки.                                                               | Таблица запланированных задач                                                |
| трассировки. Усесервицес ()                       | Предоставляет данные о службах, которые были активны или имели состояние, записанное во время трассировки.                                  | Таблица служб; Конфигурация системы, службы                       |
| трассировки. Усестаккс ()                         | Предоставляет данные о стеках, записанных во время трассировки.                                                                        |                                                                      |
| трассировки. Усестаккевентс ()                    | Предоставляет данные о событиях, связанных с стеками, записанными во время трассировки.                                                 | Таблица стеков                                                         |
| трассировки. Усестакктагс ()                      | Предоставляет средство сопоставления, которое группирует стеки из трассировки в теги стека, как указано в XML-файле конфигурации.               | Столбцы, такие как тег стека и стек (Теги Frame)                     |
| трассировки. Усесимболс ()                        | Предоставляет возможность загрузки символов для трассировки.                                                                          | Настройка путей к символам; Загрузить символы                                 |
| трассировки. Усесискаллс ()                       | Предоставляет данные о syscall, произошедших во время трассировки.                                                                 | Таблица syscall                                                       |
| трассировки. Усесистемметадата ()                 | Предоставляет общие системные метаданные из трассировки.                                                                       | Конфигурация системы                                                 |
| трассировки. Усесистемповерсаурцедата ()          | Предоставляет данные из трассировки активного источника питания системы (AC/DC).                                                | Таблица источника питания системы                                            |
| трассировки. Усесистемслипдата ()                | Предоставляет данные из трассировки общего состояния энергопотребления системы.                                                               | Таблица Power Transition                                               |
| трассировки. Усетаржеткпуидлестатес ()            | Предоставляет данные из трассировки по целевому ЦП C-состояниями.                                                                      | Таблица состояний простоя ЦП (если тип является целевым)                          |
| трассировки. Усетаржетпроцессорфрекуенцидата ()   | Предоставляет данные из трассировки целевых процессорных частот.                                                             | Таблица частоты процессора (если тип является целевым)                      |
| трассировки. Усесреадс ()                        | Предоставляет данные о потоках, активных во время трассировки.                                                                         | Время существования потока, таблица                                               |
| трассировки. Усетрацестатистикс ()                | Предоставляет статистику о событиях в трассировке.                                                                           | Конфигурация системы, статистика трассировки                               |
| трассировки. Усеуткдата ()                        | Предоставляет данные из трассировки действия телеметрии Майкрософт с помощью универсального клиента телеметрии (UTC).                      | Таблица в формате UTC                                                            |
| трассировки. Усевиндовинфокус ()                  | Предоставляет данные из трассировки об изменениях активного окна пользовательского интерфейса в фокусе.                                                 | Окно в таблице фокуса                                                |
| трассировки. Усевиндовстрацепрепроцессоревентс () | Предоставляет события препроцессора трассировки программного обеспечения Windows (WPP) из трассировки.                                                    | Таблица трассировки WPP; Таблица универсальных событий (если тип события — WPP)       |
| трассировки. Усевининетдата ()                    | Предоставляет данные из трассировки Интернет-активности через Windows Internet (WinINet).                                         | Таблица сведений о скачивании                                               |
| трассировки. Усеворкингсетдата ()                 | Предоставляет данные из трассировки для страниц виртуальной памяти, которые были в рабочем наборе для каждого процесса или категории ядра. | Таблица моментальных снимков виртуальной памяти                                       |

См. также методы расширения в [итрацесаурце](https://docs.microsoft.com/dotnet/api/microsoft.windows.eventtracing.itracesource) для всех доступных данных трассировки или изучите метод, доступный в "трассировке". отображается технологией IntelliSense.

## <a name="next-steps"></a>Следующие шаги

В этом обзоре вы узнали, как получить доступ к данным трассировки с помощью Трацепроцессор и встроенных источников данных, к которым он может получить доступ.

Следующий шаг — Узнайте, как [расширить](extensibility.md) трацепроцессор для доступа к пользовательским данным трассировки.
