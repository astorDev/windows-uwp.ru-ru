---
Description: Добавляйте современные пользовательские интерфейсы XAML, создавайте MSIX-пакеты и включайте другие актуальные компоненты в свои классические приложения.
title: Модернизация классических приложений для Windows
ms.topic: article
ms.date: 04/17/2019
ms.author: mcleans
author: mcleanbyron
ms.localizationpriority: medium
ms.openlocfilehash: 31d7805e7ae936e5c7427b54f2eb9b0ad4b4c3e9
ms.sourcegitcommit: 37e4af3ba203295c7e88448414cf7ea537ab5402
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2020
ms.locfileid: "84257385"
---
# <a name="modernize-your-desktop-apps"></a>Модернизация классических приложений

В Windows 10 и универсальной платформе Windows (UWP) предлагается много функций для реализации современных функций в классических приложениях. Большинство этих функций доступны в виде модульных компонентов, которые вы можете использовать в классических приложениях по своему усмотрению, не переписывая код приложения для другой платформы. Вы можете выбрать, какие компоненты Windows 10 и UWP нужно внедрить для улучшения существующих классических приложений.

В этой статье описаны функции Windows 10 и UWP, которые можно использовать в классических приложениях уже сегодня. Инструкции по модернизации существующего приложения для использования многих из функций, описанных в этой статье, приведены в руководстве по [модернизации приложения WPF](modernize-wpf-tutorial.md).

> [!NOTE]
> Нужна помощь в миграции классических приложений в Windows 10? [Служба Assure для классических приложений](https://docs.microsoft.com/FastTrack/win-10-desktop-app-assure) предоставляет прямую бесплатную поддержку для разработчиков при миграции приложений в Windows 10. Эта программа доступна для всех независимых поставщиков программного обеспечения и соответствующих предприятий. Дополнительные сведения о соответствии критериям, а также о самой программе см. здесь: [https://docs.microsoft.com/fasttrack/win-10-app-assure-assistance-offered](https://docs.microsoft.com/fasttrack/win-10-app-assure-assistance-offered). Чтобы начать работу прямо сейчас, [отправьте запрос](https://fasttrack.microsoft.com/dl/daa).

## <a name="windows-ui-library"></a>Библиотека пользовательского интерфейса Windows

Библиотека пользовательского интерфейса Windows — это набор пакетов NuGet, предоставляющих элементы управления и прочие элементы пользовательского интерфейса для приложений для Windows 10. Решение WinUI разрабатывалось как набор средств. Он предоставлял новые и обновленные версии элементов управления UWP для приложений UWP, предназначенных для более ранних версий Windows 10. Теперь область действия WinUI увеличилась и решение является современной нативной платформой пользовательского интерфейса для приложений Windows 10 в UWP, .NET и Win32.

WinUI можно использовать в классических приложениях следующим образом:

* Вы можете обновить существующие приложения WPF, Windows Forms и C++/Win32 для использования [XAML Islands](xaml-islands.md), чтобы размещать элементы управления WinUI 2.x в приложениях.
* Начиная с [предварительной версии 1 WinUi 3.0](../../winui/winui3/index.md), можно создавать [приложения .NET и C++/Win32, использующие пользовательский интерфейс, который полностью основан на WinUI](../../winui/winui3/get-started-winui3-for-desktop.md).

См. статью о [библиотеке пользовательского интерфейса Windows (WinUI)](../../winui/index.md).

## <a name="msix-packages"></a>Пакеты MSIX

MSIX — это современный универсальный формат пакетов для упаковки любых приложений для Windows, включая приложения UWP, WPF, Windows Forms и Win32. Этот современный надежный процесс упаковки сочетает в себе преимущества технологий установки MSI, APPX, App-V и ClickOnce.

Упаковав классические приложения для Windows в MSIX-пакеты, вы получаете доступ к надежным возможностям установки и обновления, управляемой модели безопасности с гибкой системой возможностей, поддержке Microsoft Store, возможностям управления предприятием и многим пользовательским моделям распространения.

Дополнительные сведения см. в статье об [упаковке классических приложений](/windows/msix/desktop/desktop-to-uwp-root) в документации по MSIX.

## <a name="net-core-3"></a>.NET Core 3

.NET Core 3 — это последний основной выпуск .NET Core. Основным преимуществом этого выпуска является поддержка классических приложений для Windows, включая приложения Windows Forms и WPF. Используя .NET Core 3, вы можете запускать новые и существующие классические приложения для Windows и пользоваться всеми преимуществами этой платформы. В приложениях для Windows Forms и WPF, предназначенных для .NET Core 3, вы сможете использовать элементы управления UWP, доступные в [XAML Islands](xaml-islands.md).

Дополнительные сведения см. в статье [Новые возможности .NET Core 3.0](https://docs.microsoft.com/dotnet/core/whats-new/dotnet-core-3-0).

## <a name="windows-runtime-apis"></a>APII-интерфейсы среды выполнения Windows

Для интеграции современных возможностей, которые могут заинтересовать пользователей Windows 10, большинство API-интерфейсов среды выполнения Windows можно вызывать напрямую из классических приложений WPF, Windows Forms или C++ Win32. Например, вы можете вызывать API-интерфейсы среды выполнения Windows, чтобы добавлять всплывающие уведомления в приложение.

Дополнительные сведения см. в статье об [использовании API-интерфейсов среды выполнения Windows для классических приложений](desktop-to-uwp-enhance.md).

## <a name="host-uwp-controls-xaml-islands"></a>Добавление элементов управления UWP (XAML Islands)

Начиная с Windows 10 версии 1903, можно добавить [элемент управления XAML платформы UWP](/windows/uwp/design/controls-and-patterns/controls-by-function) в любой элемент пользовательского интерфейса приложения WPF, Windows Forms или C++ Win32, который связан с дескриптором окна (HWND). Это означает, что новые функции UWP, например [рукописный ввод Windows](/windows/uwp/design/input/pen-and-stylus-interactions), можно объединить с элементами управления, поддерживающими [систему Fluent Design](/windows/uwp/design/fluent-design-system/index), в окнах и других средствах для отображения в классических приложениях. Такой сценарий разработки иногда называют *XAML Islands*.

Дополнительные сведения см. в статье [Host UWP XAML controls in desktop apps (XAML Islands)](xaml-islands.md) (Добавление элементов управления XAML платформы UWP в классические приложения (XAML Islands)).

## <a name="use-the-visual-layer-in-desktop-apps"></a>Использование визуального уровня в классических приложениях

Теперь API-интерфейсы среды выполнения Windows можно использовать и в классических приложениях, созданных не на платформе UWP, чтобы улучшить внешний вид и функции этих приложений (WPF, Windows Forms и C++ Win32), а также воспользоваться последними функциями пользовательского интерфейса Windows 10, которые доступны только через UWP. Это удобно, когда нужно создать пользовательские функции, которые невозможно реализовать с помощью встроенных элементов управления UWP, добавляемых с помощью XAML Islands.

Дополнительные сведения см. в статье [Using the Visual layer in desktop apps](visual-layer-in-desktop-apps.md) (Использование визуального уровня в классических приложениях).

## <a name="additional-features-available-to-apps-with-package-identity"></a>Дополнительные функции, доступные приложениям с идентификатором пакета

Некоторые современные возможности Windows 10 доступны только в классических приложениях с [идентификатором пакета](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-identity). Эти функции включают в себя определенные интерфейсы API среды выполнения Windows, расширения пакетов и компоненты UWP. Дополнительные сведения см. в статье [Features that require package identity](modernize-packaged-apps.md) (Функции, которым требуется идентификатор пакета).

Существует несколько способов предоставить идентификатор классическому приложению.

* Упакуйте его в [пакет MSIX](/windows/msix/desktop/desktop-to-uwp-root). MSIX — это современный универсальный формат пакетов для упаковки любых приложений для Windows, WPF, Windows Forms и Win32. Он обеспечивает надежные возможности установки и обновления, управляемую модель безопасности с гибкой системой возможностей, поддержку Microsoft Store, возможности управления предприятием и множество пользовательских моделей распространения. Дополнительные сведения см. в статье об [упаковке классических приложений](https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-root) в документации по MSIX.
* Если вам не удается внедрить упаковку MSIX для развертывания своего классического приложения, в Windows 10 версии 2004 и выше вы сможете предоставить идентификатор пакета, создав *разреженный пакет MSIX*, который содержит только манифест пакета. Дополнительные сведения см. в разделе [Предоставление идентификаторов для неупакованных классических приложений](grant-identity-to-nonpackaged-apps.md).

<a id="desktop-uwp-controls"></a>

## <a name="uwp-controls-optimized-for-desktop-apps"></a>Элементы управления UWP, оптимизированные для классических приложений

Приведенные ниже новые и обновленные элементы управления UWP предоставляют средства рабочего стола как часть [системы Fluent Design](/windows/uwp/design/fluent-design-system/index). Эти возможности можно применять, независимо от того, создаете ли вы приложение UWP, предназначенное только для компьютеров, или хотите использовать элементы управления UWP в классическом приложении WPF, Windows Forms или C++ Win32. Эти элементы управления появились в Windows 10 версии 1809, (обновление за октябрь 2018 г. или версия 10.0.17763).

| Элемент |  Описание |
|------ |--------------|
| [MenuBar](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/menus#create-a-menu-bar) | Обеспечивает простой и быстрый способ выводить набор команд в приложениях, которым могут понадобиться дополнительные функции упорядочения или группирования, недоступные в **CommandBar**. |
| [DropDownButton](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/buttons#create-a-drop-down-button) | Отображение шеврона в качестве визуального индикатора, который свидетельствует о наличии вложенного всплывающего меню с дополнительными параметрами.  |
| [SplitButton](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/buttons#create-a-split-button) | Кнопка, состоящая из двух частей, которые можно использовать по-отдельности. Одна часть представляет собой стандартную кнопку, которая вызывает немедленное действие. Другая часть позволяет вызывать всплывающий элемент с дополнительными параметрами, которые пользователь может выбрать.|
| [ToggleSplitButton](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/buttons#create-a-toggle-split-button) | Кнопка, состоящая из двух частей, которые можно использовать по-отдельности. Одна часть выполняет функцию переключателя. Другая часть позволяет вызывать всплывающий элемент с дополнительными параметрами, которые пользователь может выбрать. |
| [CommandBarFlyout](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/command-bar-flyout) |  Позволяет отобразить стандартные задачи пользователя в контексте элемента на холсте пользовательского интерфейса. |
| [ComboBox](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/combo-box#make-a-combo-box-editable) | Теперь поле со списком можно сделать редактируемым, чтобы пользователь мог ввести значения, которые не указаны в элементе управления.  |
| [TreeView](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/tree-view) | Теперь можно настроить представление в виде дерева для реализации привязки данных, шаблонов элементов и перетаскивания элементов.  |
| [DataGridView](https://docs.microsoft.com/windows/communitytoolkit/controls/datagrid) |   Позволяет гибко отображать коллекцию данных в строках и столбцах. Этот элемент управления доступен в [наборе средств сообщества Windows](https://docs.microsoft.com/windows/uwpcommunitytoolkit/).  |

## <a name="other-technologies-for-modern-desktop-apps"></a>Другие технологии для современных классических приложений

### <a name="microsoft-graph"></a>Microsoft Graph

Microsoft Graph — это коллекция API, которые можно использовать для создания приложений для организаций и клиентов, взаимодействующих с данными миллионов пользователей. Microsoft Graph предоставляет REST API и клиентские библиотеки для доступа к данным в следующих службах:
* Azure Active Directory
* службы Office 365: SharePoint, OneDrive, Outlook или Exchange, Microsoft Teams, OneNote, Планировщик и Excel;
* службы Enterprise Mobility + Security: Identity Manager, Intune, Advanced Threat Analytics и Advanced Threat Protection;
* службы Windows 10: действия и устройства.

Дополнительные сведения см. в документации по [Microsoft Graph](https://developer.microsoft.com/graph/docs/concepts/overview).

### <a name="adaptive-cards"></a>Адаптивные карточки

Адаптивные карточки — это открытая платформа для кроссплатформенных приложений, которая позволяет привычным и согласованным способом обмениваться между устройствами и платформами содержимым пользовательского интерфейса на основе карточек.

Дополнительные сведения см. в документации по [адаптивным карточкам](https://docs.microsoft.com/adaptive-cards/).
