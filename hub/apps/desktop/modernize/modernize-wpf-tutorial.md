---
description: В этом руководстве показано, как добавлять пользовательские интерфейсы XAML UWP, создавать пакеты MSIX и внедрять в приложение WPF другие современные компоненты.
title: Учебник. модернизировать приложения WPF
ms.topic: article
ms.date: 06/27/2019
ms.author: mcleans
author: mcleanbyron
keywords: Windows 10, UWP, Windows Forms, WPF, объекты XAML Island
ms.localizationpriority: medium
ms.custom: RS5, 19H1
ms.openlocfilehash: 397c301564c0d4799c6b41db209da9659725103d
ms.sourcegitcommit: 3e7a4f7605dfb4e87bac2d10b6d64f8b35229546
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "77089310"
---
# <a name="tutorial-modernize-a-wpf-app"></a>Учебник. модернизировать приложения WPF 

Существует множество способов [модернизировать](index.md) существующих настольных приложений путем интеграции последних компонентов Windows в существующий исходный код вместо перезаписи приложений с нуля. В этом учебнике мы рассмотрим несколько способов модернизировать существующего бизнес-приложения WPF с помощью следующих функций:

* .NET Core 3
* Элементы управления XAML UWP с островами XAML
* Адаптивные карты и уведомления Windows 10
* Развертывание MSIX

Для работы с этим руководством требуются следующие навыки разработки:

* Опыт разработки классических приложений Windows с WPF.
* Базовые знания C# и XAML.
* Базовые знания UWP.

## <a name="overview"></a>Обзор

В этом руководстве представлен код для простого бизнес-приложения WPF с именем Contoso расходы. В вымышленном сценарии в рамках учебника Contoso расходы — это внутреннее приложение, используемое менеджерами компании Contoso, чтобы отследить расходы, отправленные отчетами. Теперь руководители оснащены устройствами с поддержкой сенсорного ввода и хотели бы использовать приложение "расходы Contoso" без мыши или клавиатуры. К сожалению, текущая версия приложения не поддерживает сенсорный ввод.

Contoso хочет модернизировать это приложение с новыми функциями Windows, чтобы позволить сотрудникам более эффективно создавать отчеты о расходах. Многие функции можно легко реализовать, создав новое приложение UWP. Однако существующее приложение является сложным и является результатом многих лет разработки различных команд. Таким образом, переписывание его с нуля с помощью новой технологии не является вариантом. Команда ищет лучший подход к добавлению новых функций в существующую базу кода.

В начале этого руководства компания Contoso расходы нацелена на .NET Framework 4.7.2 и использует следующие сторонние библиотеки:

* MVVM Light — Базовая реализация шаблона MVVM.
* Unity — контейнер внедрения зависимостей.
* Литедб — встроенное решение NoSQL для хранения данных.
* Фиктивный инструмент для создания фиктивных данных.

В этом руководстве вы улучшите расходы contoso с помощью новых функций Windows:

* Перенос существующего приложения WPF в .NET Core 3,0. В будущем будут открыты новые и важные сценарии.
* Используйте XAML-острова для размещения элементов управления **InkCanvas** и **MapControl** , предоставляемых набором средств сообщества Windows.
* Используйте XAML-острова для размещения любого стандартного элемента управления XAML UWP (в данном случае — **календардвиев**).
* Интегрируйте адаптивные карты и уведомления Windows 10 в приложение.
* Упакуйте приложение с помощью MSIX и настройте конвейер CI/CD в Azure DevOps, чтобы можно было автоматически предоставлять новые версии приложения тестерам и пользователям, как только это станет доступно.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого учебника на компьютере разработчика должны быть установлены следующие компоненты:

* Windows 10, версия 1903 (сборка 18362) или более поздняя версия.
* [Visual Studio 2019](https://www.visualstudio.com).
* [Пакет SDK для .NET Core 3](https://dotnet.microsoft.com/download/dotnet-core/3.0) (установите последнюю версию).

Убедитесь, что в Visual Studio 2019 установлены следующие рабочие нагрузки и дополнительные компоненты:

* Разработка классических приложений .NET
* "Разработка приложений для универсальной платформы Windows".
* Пакет SDK для Windows 10 (10.0.18362.0 или более поздней версии)

## <a name="get-the-contoso-expenses-sample-app"></a>Получение примера приложения Contoso "расходы"

Перед началом работы с руководством Скачайте исходный код приложения "расходы Contoso" и убедитесь, что вы можете создать код в Visual Studio.

1. Скачайте исходный код приложения со вкладки " **выпуски** " [репозитория аппконсулт винаппсмодернизатион Workshop](https://github.com/Microsoft/AppConsult-WinAppsModernizationWorkshop). Прямая ссылка [https://aka.ms/wamwc](https://aka.ms/wamwc).
2. Откройте ZIP-файл и извлеките все содержимое в корневую папку диска **C:\\** . Будет создана папка с именем **к:\винаппсмодернизатионворкшоп**.
3. Откройте Visual Studio 2019 и дважды щелкните файл **C:\WinAppsModernizationWorkshop\Lab\Exercise1\01-Start\ContosoExpenses\ContosoExpenses.sln** , чтобы открыть решение.
4. Убедитесь, что вы можете выполнять сборку, запуск и отладку проекта WPF по расходам Contoso, нажав кнопку **Пуск** или клавиши CTRL + F5.

## <a name="get-started"></a>Начало работы

Получив исходный код для примера приложения "расходы Contoso" и убедившись, что его можно построить в Visual Studio, можно приступить к работе с учебником:

* [Часть 1. Перенос приложения "расходы Contoso" на .NET Core 3](modernize-wpf-tutorial-1.md)
* [Часть 2. Добавление элемента управления UWP InkCanvas с помощью XAML-островов](modernize-wpf-tutorial-2.md)
* [Часть 3. Добавление элемента управления UWP Календарвиев с помощью XAML-островов](modernize-wpf-tutorial-3.md)
* [Часть 4. Добавление действий и уведомлений пользователей Windows 10](modernize-wpf-tutorial-4.md)
* [Часть 5. Упаковка и развертывание с помощью MSIX](modernize-wpf-tutorial-5.md)

## <a name="important-concepts"></a>Важные понятия

Следующие разделы содержат общие сведения о некоторых ключевых концепциях, обсуждаемых в этом руководстве. Если вы уже знакомы с этими концепциями, вы можете пропустить этот раздел.

### <a name="universal-windows-platform-uwp"></a>Универсальная платформа Windows (UWP)

В Windows 8 корпорация Майкрософт представила новую платформу, именуемую среда выполнения Windows (WinRT). В отличие от .NET Framework WinRT — это собственный уровень интерфейсов API, которые предоставляются непосредственно приложениям. В WinRT также появились проектные проекты, которые добавляются поверх среды выполнения, чтобы разработчики могли взаимодействовать с ним с помощью таких языков, C# как и JavaScript, в C++дополнение к. Проекции позволяют разработчикам создавать приложения поверх WinRT, которые используют те же C# знания XAML, которые они получили при создании приложений с .NET Framework. 

В Windows 10 Корпорация Майкрософт представила [универсальная платформа Windows (UWP)](/windows/uwp/get-started/universal-application-platform-guide), которая построена на основе WinRT. Самой важной функцией UWP является то, что она предлагает общий набор API-интерфейсов на всех платформах устройств: независимо от того, работает ли приложение на рабочем столе, на Xbox One или на HoloLens, вы можете использовать те же интерфейсы API.

В дальнейшем большинство новых функций Windows 10 предоставляются через API-интерфейсы WinRT, включая такие функции, как временная шкала, проект Рим и Windows Hello.

### <a name="msix-packaging"></a>Упаковка MSIX

[MSIX](/windows/msix/) — это современная модель упаковки для приложений Windows. MSIX поддерживает приложения UWP, а также настольные приложения, использующие такие технологии, как Win32, WPF, Windows Forms, Java, электронными и др. При упаковке классического приложения в пакет MSIX можно опубликовать приложение на Microsoft Store. При установке классическое приложение также получает удостоверение пакета, что позволяет классическому приложению использовать более широкий набор API-интерфейсов WinRT.

Дополнительные сведения см. в следующих статьях:

* [Упаковка классических приложений](/windows/uwp/porting/desktop-to-uwp-root)
* [За сценой упакованного классического приложения](/windows/uwp/porting/desktop-to-uwp-behind-the-scenes)

### <a name="xaml-islands"></a>Острова XAML

Начиная с Windows 10 версии 1903, можно размещать элементы управления UWP в приложениях, не являющихся универсальными для UWP, с помощью функции, именуемой " *острова XAML*". Эта функция позволяет улучшить внешний вид и функциональные возможности существующих настольных приложений с помощью новейших функций пользовательского интерфейса Windows 10, которые доступны только через элементы управления UWP. Это означает, что вы можете использовать такие функции UWP, как рукописный ввод и элементы управления Windows, поддерживающие систему разработки Fluent в существующих приложениях C++ WPF, Windows Forms и Win32.

Дополнительные сведения см. [в разделе элементы управления UWP в классических приложениях (острова XAML)](/windows/uwp/xaml-platform/xaml-host-controls). В этом учебнике описывается процесс использования двух различных типов элементов управления "Остров" XAML:

* [InkCanvas](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/inkcanvas) и [MapControl](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/mapcontrol) в наборе средств сообщества Windows. Эти элементы управления WPF заключают интерфейс и функциональные возможности соответствующих элементов управления UWP и могут использоваться как любой другой элемент управления WPF в конструкторе Visual Studio.

* Элемент управления [представления календаря](/windows/uwp/design/controls-and-patterns/calendar-view) UWP. Это стандартный элемент управления UWP, который будет размещаться с помощью элемента управления [виндовсксамлхост](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) в наборе средств сообщества Windows.

### <a name="net-core-3"></a>.NET Core 3

[.NET Core](https://docs.microsoft.com/dotnet/core/) — это платформа с открытым исходным кодом, которая реализует кросс-платформенную, простую расширяемую версию полной .NET Framework. По сравнению с полным .NET Framework время запуска .NET Core намного быстрее, и многие из интерфейсов API были оптимизированы.

В первых нескольких выпусках основное внимание было уделено .NET Core для поддержки веб-приложений и серверной части. С помощью .NET Core можно легко создавать масштабируемые веб-приложения или API, которые могут размещаться в Windows, Linux или в архитектурах микрослужб, таких как контейнеры DOCKER.

.NET Core 3 — это последний выпуск .NET Core. Основным преимуществом этого выпуска является поддержка классических приложений для Windows, включая приложения Windows Forms и WPF. Используя .NET Core 3, вы можете запускать новые и существующие классические приложения для Windows и пользоваться всеми преимуществами этой платформы. В приложениях для Windows Forms и WPF, предназначенных для .NET Core 3, вы сможете использовать элементы управления UWP, доступные в [XAML Islands](xaml-islands.md).

> [!NOTE]
> WPF и Windows Forms не являются кросс-платформенными, и вы не можете запускать WPF или Windows Forms в Linux и MacOS. Компоненты пользовательского интерфейса WPF и Windows Forms по-прежнему имеют зависимость от системы визуализации Windows.

Дополнительные сведения см. в статье [Новые возможности .NET Core 3.0](https://docs.microsoft.com/dotnet/core/whats-new/dotnet-core-3-0).