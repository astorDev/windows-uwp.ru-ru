---
description: Это руководство поможет вам создавать пользовательские интерфейсы UWP на основе принципов проектирования Fluent Design непосредственно в приложениях WPF и Windows Forms.
title: Элементы управления UWP в классических приложениях
ms.date: 08/20/2019
ms.topic: article
keywords: Windows 10, UWP, Windows Forms, WPF, о-ва XAML
ms.author: mcleans
author: mcleanbyron
ms.localizationpriority: high
ms.custom: 19H1
ms.openlocfilehash: 52287576dbc395af60e15b5f4b4a403db7e92900
ms.sourcegitcommit: 13faf9dab9946295986f8edd79b5fae0db4ed0f6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72313453"
---
# <a name="host-uwp-xaml-controls-in-desktop-apps-xaml-islands"></a>Размещение элементов управления XAML UWP в классических приложениях (острова XAML)

Начиная с Windows 10 версии 1903, можно размещать элементы управления UWP в настольных приложениях, не являющихся UWP, с помощью функции, именуемой " *острова XAML*". Эта функция позволяет улучшить внешний вид, поведение и функциональные возможности существующих приложений WPF, Windows Forms и C++ Win32 с последними ФУНКЦИЯМИ пользовательского интерфейса Windows 10, которые доступны только через элементы управления UWP. Это означает, что вы можете использовать такие функции UWP, как [Рукописный ввод](/windows/uwp/design/input/pen-and-stylus-interactions) и элементы управления Windows, поддерживающие [систему разработки Fluent](/windows/uwp/design/fluent-design-system/index) в существующих приложениях C++ WPF, Windows Forms и Win32.

Можно разместить любой элемент управления UWP, производный от [Windows. UI. XAML. UIElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), включая:

* Любой первый элемент управления UWP, предоставляемый библиотекой Windows SDK или Винуи.
* Любой пользовательский элемент управления UWP (например, Пользовательский элемент управления, состоящий из нескольких элементов управления UWP, которые работают вместе). Необходимо иметь исходный код для пользовательского элемента управления, чтобы его можно было скомпилировать в приложении.

По сути, острова XAML создаются с помощью *API размещения UWP XAML*. Этот API состоит из нескольких среда выполнения Windows классов и COM-интерфейсов, которые появились в пакете SDK для Windows 10 версии 1903. Мы также предоставляем набор элементов управления .NET на языке XAML в [наборе средств Windows Community Toolkit](https://docs.microsoft.com/windows/uwpcommunitytoolkit/) , которые используют API размещения универсального кода класса (XAML) UWP и предоставляют более удобный интерфейс для разработки приложений WPF и Windows Forms.

Способ использования XAML зависит от типа приложения и типов элементов управления UWP, которые требуется разместить.

> [!NOTE]
> Если у вас есть отзывы о островах XAML, создайте новую ошибку в [репозитории Microsoft. Toolkit. Win32](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/issues) и оставьте свои комментарии. Если вы предпочитаете отправить отзыв в частном порядке, его можно отправить на XamlIslandsFeedback@microsoft.com. Ваши ценные сведения и сценарии критически важны для нас.

## <a name="wpf-and-windows-forms-applications"></a>Приложения WPF и Windows Forms

Рекомендуется, чтобы WPF и Windows Forms приложения использовали элементы управления .NET на языке XAML, доступные в наборе средств сообщества Windows. Эти элементы управления предоставляют объектную модель, которая имитирует (или предоставляет доступ к) свойствам, методам и событиям соответствующих элементов управления UWP. Они также выполняют такие действия, как Навигация с помощью клавиатуры и изменение макета.

Существует два набора элементов управления островами XAML для WPF и Windows Forms приложений: *Упакованные элементы управления* и *элементы управления ведущего приложения*. Начиная с Windows 10 версия 1903, эти элементы управления [доступны в качестве предварительной версии для разработчиков](#feature-roadmap).

### <a name="wrapped-controls"></a>Обтекаемые элементы управления

Приложения WPF и Windows Forms могут использовать набор элементов управления XAML, которые заключают интерфейс и функциональные возможности определенного элемента управления UWP. Эти элементы управления можно добавить непосредственно в область конструктора проекта WPF или Windows Forms, а затем использовать их как любой другой элемент управления WPF или Windows Forms в конструкторе.

Следующие Упакованные элементы управления UWP в настоящее время доступны в наборе средств сообщества Windows. 

| Элемент управления | Минимальная поддерживаемая ОС | Описание |
|-----------------|-------------------------------|-------------|
| [InkCanvas](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/inkcanvas)<br>[InkToolbar](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/inktoolbar) | Windows 10, версия 1903 | Укажите поверхность и связанные панели инструментов для взаимодействия пользователя с Windows на основе рукописного ввода в Windows Forms или в классическом приложении WPF. |
| [медиаплайерелемент](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/mediaplayerelement) | Windows 10, версия 1903 | Внедряет представление, которое выполняет потоковую передачу и визуализацию мультимедийного содержимого, например видео в Windows Forms или в классических приложениях WPF. |
| [MapControl](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/mapcontrol) | Windows 10, версия 1903 | Позволяет отображать символьную или реалистичную карту в Windows Forms или в классическом приложении WPF. |

Пошаговое руководство, в котором демонстрируется использование упакованных элементов управления UWP, см. [в разделе Размещение стандартного элемента управления UWP в приложении WPF](host-standard-control-with-xaml-islands.md).

### <a name="host-controls"></a>Элементы управления ведущего приложения

Для сценариев, которые выходят за пределы доступных упакованных элементов управления, приложения WPF и Windows Forms могут также использовать элемент управления [виндовсксамлхост](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) , доступный в наборе средств сообщества Windows.

| Элемент управления | Минимальная поддерживаемая ОС | Описание |
|-----------------|-------------------------------|-------------|
| [виндовсксамлхост](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) | Windows 10, версия 1903 | Может размещать любой элемент управления UWP, производный от [Windows. UI. XAML. UIElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), включая любой первый элемент управления UWP, предоставляемый Windows SDK, а также пользовательские элементы управления. |

Пошаговые руководства, демонстрирующие использование элемента управления **виндовсксамлхост** , см. в разделе [Размещение стандартного элемента управления UWP в приложении WPF](host-standard-control-with-xaml-islands.md) и [Размещение пользовательского элемента управления UWP в приложении WPF с помощью XAML-островов](host-custom-control-with-xaml-islands.md).

> [!NOTE]
> Использование элемента управления **виндовсксамлхост** для размещения пользовательских элементов управления UWP поддерживается только в приложениях WPF и Windows Forms, предназначенных для .NET Core 3. Размещение первичных элементов управления UWP, предоставляемых Windows SDK, поддерживается в приложениях, предназначенных для .NET Framework или .NET Core 3.

<span id="requirements" />

### <a name="configure-your-project-to-use-the-xaml-island-net-controls"></a>Настройка проекта для использования элементов управления .NET, остров XAML

Для элементов управления .NET, остров XAML, требуется Windows 10, версия 1903 или более поздняя версия. Чтобы использовать эти элементы управления, установите один из перечисленных ниже пакетов NuGet. Эти пакеты предоставляют все необходимое для использования элементов управления, упакованных в код XAML и элементов управления ведущего приложения, и включают другие связанные пакеты NuGet, которые также необходимы.

| Тип элемента управления | Пакет NuGet  | Связанные статьи |
|-----------------|----------------|---------------------|
| [Обтекаемые элементы управления](#wrapped-controls) | Версия 6.0.0-preview7 или более поздней версии этих пакетов: <ul><li>WPF [Microsoft. Toolkit. WPF. UI. Controls](https://www.nuget.org/packages/Microsoft.Toolkit.Wpf.UI.Controls)</li><li>Windows Forms: [Microsoft. Toolkit. Forms. UI. Controls](https://www.nuget.org/packages/Microsoft.Toolkit.Forms.UI.Controls)</li></ul>  | [Размещение стандартного элемента управления UWP в приложении WPF](host-standard-control-with-xaml-islands.md)  |
| [Элемент управления ведущего приложения](#host-controls) | Версия 6.0.0-preview7 или более поздней версии этих пакетов: <ul><li>WPF [Microsoft. Toolkit. WPF. UI. Ксамлхост](https://www.nuget.org/packages/Microsoft.Toolkit.Wpf.UI.XamlHost)</li><li>Windows Forms: [Microsoft. Toolkit. Forms. UI. Ксамлхост](https://www.nuget.org/packages/Microsoft.Toolkit.Forms.UI.XamlHost)</li></ul>  | [Размещение стандартного элемента управления UWP в приложении WPF](host-standard-control-with-xaml-islands.md)<br/>[Размещение пользовательского элемента управления UWP в приложении WPF](host-custom-control-with-xaml-islands.md)  |

Учитывайте следующие сведения:

* Пакеты управления ведущего приложения также включаются в Упакованные пакеты управления. Если необходимо использовать оба набора элементов управления, можно установить пакеты элементов управления с оболочкой.

* Если вы размещаете пользовательский элемент управления UWP, проект WPF или Windows Forms должен быть предназначен для .NET Core 3. Размещение пользовательских элементов управления UWP не поддерживается в приложениях, предназначенных для .NET Framework. Вам также потребуется выполнить некоторые дополнительные действия для ссылки на пользовательский элемент управления. Дополнительные сведения см. [в разделе Размещение пользовательского элемента управления UWP в приложении WPF с помощью XAML-ва](host-custom-control-with-xaml-islands.md).

* В предыдущих версиях этих инструкций был добавлен элемент `maxversiontested` в манифест приложения в проекте WPF или Windows Forms. Пока вы используете последние предварительные версии пакетов NuGet, перечисленных выше, вам больше не нужно добавлять этот элемент в манифест.

### <a name="architecture-of-xaml-island-net-controls"></a>Архитектура элементов управления .NET острова XAML

Ниже приведен краткий обзор того, как различные типы элементов управления "Остров XAML" организованы по архитектуре на основе API размещения UWP XAML.

![Архитектура размещаемых элементов управления](images/xaml-islands/host-controls.png)

API-интерфейсы, представленные в нижней части этой схемы, входят в состав Windows SDK. Упакованные элементы управления и элементы управления ведущего приложения доступны через пакеты NuGet в наборе средств сообщества Windows.

### <a name="web-view-controls"></a>Элементы управления веб-представления

Набор средств сообщества Windows Community также предоставляет следующие элементы управления .NET для размещения веб-содержимого в WPF и Windows Forms приложениях. Эти элементы управления часто используются в похожих сценариях модернизации настольных приложений, как элементы управления острова XAML, и хранятся в одном репозитории [репозитория Microsoft. Toolkit. Win32](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32) как элементы управления островом XAML.

| Элемент управления | Минимальная поддерживаемая ОС | Описание |
|-----------------|-------------------------------|-------------|
| [WebView](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/webview) | Windows 10 версии 1803 | Использует механизм визуализации Microsoft ребра для отображения веб-содержимого. |
| [вебвиевкомпатибле](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/webviewcompatible) | Windows 7 | Предоставляет версию **WebView** , совместимую с дополнительными версиями ОС. Этот элемент управления использует механизм визуализации Microsoft ребра для отображения веб-содержимого в Windows 10 версии 1803 и более поздних версий, а также механизм подготовки отчетов Internet Explorer для отображения веб-содержимого в более ранних версиях Windows 10, Windows 8. x и Windows 7. |

Чтобы использовать эти элементы управления, установите один из следующих пакетов NuGet:

* WPF [Microsoft. Toolkit. WPF. UI. Controls. WebView](https://www.nuget.org/packages/Microsoft.Toolkit.Wpf.UI.Controls.WebView)
* Windows Forms: [Microsoft. Toolkit. Forms. UI. Controls. WebView](https://www.nuget.org/packages/Microsoft.Toolkit.Forms.UI.Controls.WebView)

## <a name="c-win32-applications"></a>C++Приложения Win32

Элементы управления .NET, остров XAML, не поддерживаются в C++ приложениях Win32. Вместо этого эти приложения должны использовать *API хостинга UWP XAML* , предоставляемый пакетом SDK для Windows 10 (версии 1903 и более поздних).

API размещения в платформе UWP XAML состоит из нескольких среда выполнения Windows классов и COM-интерфейсов, которые приложение C++ Win32 может использовать для размещения любого элемента управления UWP, производного от [Windows. UI. XAML. UIElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement). Элементы управления UWP можно размещать в любом элементе пользовательского интерфейса приложения, имеющего связанный дескриптор окна (HWND). Дополнительные сведения об этом API, включая предварительные требования, см. [в разделе Использование API размещения в C++ XAML UWP в приложении Win32](using-the-xaml-hosting-api.md).

> [!NOTE]
> Обтекаемые элементы управления и элементы управления ведущего приложения в наборе Windows Community Toolkit используют API размещения UWP XAML для внутреннего использования и реализуют все поведение, которое в противном случае необходимо для самостоятельной работы, если вы использовали API хостинга XAML UWP напрямую, включая навигацию с помощью клавиатуры. и изменения макета. Для приложений WPF и Windows Forms мы настоятельно рекомендуем использовать эти элементы управления вместо API размещения класса UWP XAML напрямую, так как они являются абстрактным множеством деталей реализации использования API.

## <a name="feature-roadmap"></a>Схема возможностей

Начиная с выпуска Windows 10 версии 1903, остров XAML элементы управления .NET в наборе средств Windows Community Toolkit остаются в предварительной версии для разработчиков до тех пор, пока не будет выпущена версия 1,0 элементов управления.

* Версии 1,0 элементов управления для .NET Framework 4.6.2 и более поздних версий планируется [выпустить в выпуске 6,0 набора средств](https://github.com/windows-toolkit/WindowsCommunityToolkit/milestones).
* Версия 1,0 элементов управления для .NET Core 3 планируется для более поздней версии набора средств.
* Если вы хотите ознакомиться с последним предварительным просмотром выпусков этих элементов управления версии 1,0 для .NET Framework и .NET Core 3, см. пакеты NuGet версии 6.0.0-preview7 (или более поздней версии) в коллекции [набора средств сообщества UWP](https://dotnet.myget.org/gallery/uwpcommunitytoolkit) .

Дополнительные сведения см. в разделе [этой записи блога](https://blogs.windows.com/windowsdeveloper/2019/06/13/xaml-islands-v1-updates-and-roadmap).

## <a name="additional-resources"></a>Дополнительные ресурсы

Дополнительные сведения и руководства по использованию островов XAML см. в следующих статьях и ресурсах:

* [Руководство по модернизировать в приложении WPF](modernize-wpf-tutorial.md): В этом руководстве содержатся пошаговые инструкции по использованию упакованных элементов управления и элементов управления ведущего приложения в наборе средств сообщества Windows для добавления элементов управления UWP в существующее бизнес-приложение WPF. Этот учебник содержит полный код для приложения WPF, а также подробные инструкции для каждого этапа процесса.
* [Острова XAML v1 — обновления и планы развития](https://blogs.windows.com/windowsdeveloper/2019/06/13/xaml-islands-v1-updates-and-roadmap): В этой записи блога обсуждаются многие распространенные вопросы о островах XAML, а также подробная схема разработки.
